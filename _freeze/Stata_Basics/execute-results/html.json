{
  "hash": "d1cc69ec3a804f0e411e2548d6adf6ae",
  "result": {
    "markdown": "---\ntitle: Stata-Basics\nformat: html\nexecute:\n  freeze: true\n  echo: false\n  error: true\n---\n\n# Get to know `Stata`\n\n![](images/paste-1.png)\n\n## Command Window\n\n-   You can use command window to type and excute commands directly into `Stata`.\n-   Great for interactive exploration and analysis...\n-   But highly recommended that Final analysis is \"always\" done in a \"do-file\"\n\n::: {#e249ee84 .cell execution_count=1}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n. display \"Hola\"\nHola\n\n. display \"2+2=\" 2+2\n2+2=4\n\n. display \"The probability that z >1.95 is \" %5.3f 1-normal(1.95)\nThe probability that z >1.95 is 0.026\n\n. \n```\n:::\n:::\n\n\n## Help\n\n-   99% of Stata commands come with Extensive help.\n-   If you do not know how to use a command, or about a test just \"ask for help\"\n\n``` stata\nhelp help\n```\n\n``` stata\n[R] help -- Display help in Stata\n-------------------------------------------------------------------------------\nStata's help system\n    There are several kinds of help available to the Stata user. For more\n    information, see Advice on getting help.  The information below is\n    technical details about Stata's help command.\n-------------------------------------------------------------------------------\nSyntax\n        help [command_or_topic_name] [, nonew name(viewername)\n              marker(markername)]\nMenu\n    Help > Stata command...\nDescription\n    The help command displays help information about the specified command or\n    topic.  help launches a new Viewer to display help for the specified\n    command or topic or displays help on the console in Stata for\n    Unix(console).  If help is not followed by a command or a topic name,\n    Stata displays advice for using the help system and documentation.\n```\n\nFor estimation commands, and specialized tests, `help` even provides links to the manuals.\n\nThe manuals have extensive detailed information on methods, formulas, references, and examples.\n\n![](images/paste-2.png)\n\n- Of course there is 1% that is \"documented/undocumented\" or truly undocumented. \n\n- Most Community-contributed commands also have helpfiles, but are not always fully documented.\n\n- You could also ask for helps on \"topics\": `help sample selection`\n  \n## Installing Programs\n\n- `Stata`, for all practical purposes, is self-contained. \n  - You do not need outside sources to analyze your data, estimate models, create tables, etc.\n- However, many users provide add-ons that may help to make your work \"easier\"\n  - Main Stata repository : Boston College Statistical Software Components (**SSC**) archive\n\n```stata\n** For using Wooldridge Book Datasets\nssc install frause, replace \n** For Easiy tables\nnet install estout, replace from(https://raw.githubusercontent.com/benjann/estout/master/)\n** My own installer for extra utilities\nnet install fra, replace from(https://friosavila.github.io/stpackages) \nfra install fra_tools, replace\n```\n\n- If at any point there is code that produces an error, and there is no `help`, let me know.\n\n## Loading Data\n\n- `Stata` Files have format **dta**. \n- Loading Stata-data into `Stata` is very easy. \n  - Double-click (opens a new `Stata`)\n  - Drag and Drop into your `Stata` instance\n  - Load it from menu File>open \n  - or using a do-file or command window\n\n- Other Formats required extra work.\n  - Use other software to \"translate\" it into Stata\n  - Menu: File>import> many choices\n  \n### Stata System-files\n\n::: {#357919ce .cell execution_count=2}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n. ** Most Stata example files\n. ** Syntax:   sysuse  [filename], [clear]\n. sysuse dir\n  abortion.dta    citytemp.dta    nlsw88.dta      titanic.dta\n  auto.dta        citytemp4.dta   nlswide1.dta    tsline1.dta\n  auto16.dta      educ99gdp.dta   oaxaca.dta      tsline2.dta\n  auto2.dta       gapminder.dta   pop2000.dta     uslifeexp.dta\n  autornd.dta     gnp96.dta       ri.dta          uslifeexp2.dta\n  avocado.dta     lifeexp.dta     sandstone.dta   voter.dta\n  bplong.dta      mortgages.dta   scorecard.dta   xtline1.dta\n  bpwide.dta      mroz.dta        snow.dta        yule.dta\n  cancer.dta      network1.dta    sp500.dta\n  castle.dta      network1a.dta   surface.dta\n  census.dta      nhefs.dta       texas.dta\n\n. \n```\n:::\n:::\n\n\n### Other\n\n```stata\n** Web data from Stata\nwebuse \"data-file-address\", clear\n** From other sites\nwebuse set [webaddress]\nwebuse data-file-address, clear \nwebuse set \n** from frause and Wooldrige\nfrause , dir\nfrause wage1, clear\n** from anyadress\nuse \"filename-adress\", clear\nuse \"https://friosavila.github.io/playingwithstata/data2/wage1.dta\", clear\n```\n\n## Basic Data description\n\n::: {.panel-tabset}\n\n## sysuse\n\n::: {#503510e2 .cell execution_count=3}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n. sysuse auto, clear\n(1978 automobile data)\n\n. des\n\nContains data from C:\\Program Files\\Stata17/ado\\base/a/auto.dta\n Observations:            74                  1978 automobile data\n    Variables:            12                  13 Apr 2020 17:45\n                                              (_dta has notes)\n-------------------------------------------------------------------------------\nVariable      Storage   Display    Value\n    name         type    format    label      Variable label\n-------------------------------------------------------------------------------\nmake            str18   %-18s                 Make and model\nprice           int     %8.0gc                Price\nmpg             int     %8.0g                 Mileage (mpg)\nrep78           int     %8.0g                 Repair record 1978\nheadroom        float   %6.1f                 Headroom (in.)\ntrunk           int     %8.0g                 Trunk space (cu. ft.)\nweight          int     %8.0gc                Weight (lbs.)\nlength          int     %8.0g                 Length (in.)\nturn            int     %8.0g                 Turn circle (ft.)\ndisplacement    int     %8.0g                 Displacement (cu. in.)\ngear_ratio      float   %6.2f                 Gear ratio\nforeign         byte    %8.0g      origin     Car origin\n-------------------------------------------------------------------------------\nSorted by: foreign\n\n. list in 1/3\n\n     +------------------------------------------------------------------------+\n  1. | make        | price | mpg | rep78 | headroom | trunk | weight | length |\n     | AMC Concord | 4,099 |  22 |     3 |      2.5 |    11 |  2,930 |    186 |\n     |------------------------------------------------------------------------|\n     |     turn     |     displa~t     |     gear_r~o     |      foreign      |\n     |       40     |          121     |         3.58     |     Domestic      |\n     +------------------------------------------------------------------------+\n\n     +------------------------------------------------------------------------+\n  2. | make        | price | mpg | rep78 | headroom | trunk | weight | length |\n     | AMC Pacer   | 4,749 |  17 |     3 |      3.0 |    11 |  3,350 |    173 |\n     |------------------------------------------------------------------------|\n     |     turn     |     displa~t     |     gear_r~o     |      foreign      |\n     |       40     |          258     |         2.53     |     Domestic      |\n     +------------------------------------------------------------------------+\n\n     +------------------------------------------------------------------------+\n  3. | make        | price | mpg | rep78 | headroom | trunk | weight | length |\n     | AMC Spirit  | 3,799 |  22 |     . |      3.0 |    12 |  2,640 |    168 |\n     |------------------------------------------------------------------------|\n     |     turn     |     displa~t     |     gear_r~o     |      foreign      |\n     |       35     |          121     |         3.08     |     Domestic      |\n     +------------------------------------------------------------------------+\n\n. \n```\n:::\n:::\n\n\n## webuse\n\n::: {#979e5061 .cell execution_count=4}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n. webuse smoking, clear\n(Smoking and mortality data)\n\n. des\n\nContains data from https://www.stata-press.com/data/r17/smoking.dta\n Observations:        17,260                  Smoking and mortality data\n    Variables:            16                  27 Dec 2020 15:21\n                                              (_dta has notes)\n-------------------------------------------------------------------------------\nVariable      Storage   Display    Value\n    name         type    format    label      Variable label\n-------------------------------------------------------------------------------\nserno           int     %10.0g                Serial number\ncigs            byte    %10.0g                Daily cigarette consumption\nsysbp           int     %10.0g                Systolic blood pressure (mm Hg)\ndiasbp          float   %10.0g                Diastolic blood pressure (mm Hg)\nmap             float   %9.0g                 Mean arterial pressure (mm Hg)\nage             byte    %10.0g                Age (years)\nht              double  %10.0g                Height (cm)\nwt              double  %10.0g                Weight (kg)\nchol            double  %10.0g                Cholesterol (mmol/l)\ngradd1          byte    %8.0g                 Job grade 1\ngradd2          byte    %8.0g                 Job grade 2\ngradd3          byte    %8.0g                 Job grade 3\nall10           byte    %8.0g                 Ten year mortality\npyar            double  %10.0g                Years of follow-up\nchd             byte    %10.0g                Censoring (0 = censored, 1 = died\n                                                of CHD)\njobgrade        byte    %10.0g                Job grade\n-------------------------------------------------------------------------------\nSorted by: \n\n. list cigs map age ht gradd1 in 1/3\n\n     +-----------------------------------------+\n     | cigs        map   age       ht   gradd1 |\n     |-----------------------------------------|\n  1. |    0         97    46   154.94        0 |\n  2. |    0   97.66666    55   179.07        1 |\n  3. |    0         82    43   173.99        1 |\n     +-----------------------------------------+\n\n. \n```\n:::\n:::\n\n\n## frause\n\n::: {#726af824 .cell execution_count=5}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n. frause smoking, clear\n(A.C.Cameron & P.K.Trivedi (2022): Microeconometrics Using Stata, 2e)\n\n. des\n\nContains data from https://friosavila.github.io/playingwithstata/data2/smoking.\n> dta\n Observations:         1,209                  A.C.Cameron & P.K.Trivedi\n                                                (2022): Microeconometrics Using\n                                                Stata, 2e\n    Variables:             7                  5 Oct 2022 13:08\n-------------------------------------------------------------------------------\nVariable      Storage   Display    Value\n    name         type    format    label      Variable label\n-------------------------------------------------------------------------------\nstate           byte    %14.0g     state      State no\nyear            int     %9.0g                 Year\ncigsale         float   %9.0g                 Cigarette sale per capita (in\n                                                packs)\nlnincome        float   %9.0g                 Log state per capita GDP\nbeer            float   %9.0g                 Beer consumption per capita\nage15to24       float   %9.0g                 Percent of state population aged\n                                                15–24 years\nretprice        float   %9.0g                 Retail price of cigarettes\n-------------------------------------------------------------------------------\nSorted by: year\n\n. list in 1/3\n\n     +-----------------------------------------------------------------------+\n     |        state   year   cigsale   lnincome   beer   age15~24   retprice |\n     |-----------------------------------------------------------------------|\n  1. | Rhode Island   1970     123.9          .      .   .1831579       39.3 |\n  2. |    Tennessee   1970      99.8          .      .   .1780438       39.9 |\n  3. |      Indiana   1970     134.6          .      .   .1765159       30.6 |\n     +-----------------------------------------------------------------------+\n\n. \n```\n:::\n:::\n\n\n:::\n\n## Summary Statistics\n\n- Summary Statistics are essential before starting basic analysis. `Stata` gives you many options. Although not all of them are easy to export.\n\n::: {#1ded4279 .cell execution_count=6}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n. frause oaxaca, clear\n(Excerpt from the Swiss Labor Market Survey 1998)\n\n. *summarize [varlist] [if] [in] [weight] [, options]\n. summarize if female==1, sep(0)\n\n    Variable |        Obs        Mean    Std. dev.       Min        Max\n-------------+---------------------------------------------------------\n      lnwage |        683    3.266761    .5700236    .507681   5.259097\n        educ |        888    11.06025     2.26024          5       17.5\n       exper |        683    12.13769     8.32663          0   41.91667\n      tenure |        683    6.605051    6.727475          0   40.08333\n        isco |        683    3.920937    1.762983          1          9\n      female |        888           1           0          1          1\n         lfp |        888    .7691441    .4216179          0          1\n         age |        888    39.88401    10.72665         18         62\n       agesq |        888    1705.666    879.4667        324       3844\n      single |        888    .3018018    .4592984          0          1\n     married |        888    .5236486    .4997219          0          1\n    divorced |        888    .1745495    .3797953          0          1\n       kids6 |        888     .286036    .6726639          0          4\n     kids714 |        888        .375    .7538888          0          4\n          wt |        888    .9883364    .4030975   .5302977   3.181786\n\n. \n```\n:::\n:::\n\n\n::: {#9cb70476 .cell execution_count=7}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n. *   tabstat varlist [if] [in] [weight] [, options]\n. tabstat educ exper tenure age married, by(female)\n\nSummary statistics: Mean\nGroup variable: female (sex of respondent (1=female))\n\n  female |      educ     exper    tenure       age   married\n---------+--------------------------------------------------\n       0 |   11.8004  14.07684  9.003107  38.51647  .5230567\n       1 |  11.06025  12.13769  6.605051  39.88401  .5236486\n---------+--------------------------------------------------\n   Total |  11.40134  13.15324  7.860937  39.25379  .5233758\n------------------------------------------------------------\n\n. tabstat educ exper tenure , by(female) stats(p10 p50 p90)\n\nSummary statistics: p10, p50, p90\nGroup variable: female (sex of respondent (1=female))\n\n  female |      educ     exper    tenure\n---------+------------------------------\n       0 |      10.5  1.416667  .4166667\n         |      10.5  11.08333      6.25\n         |      17.5  31.33333     23.25\n---------+------------------------------\n       1 |         9      2.25  .3333333\n         |      10.5     10.75      4.25\n         |      12.5    23.375     15.75\n---------+------------------------------\n   Total |         9  1.833333  .4166667\n         |      10.5  10.91667  5.291667\n         |        15  28.08333  19.41667\n----------------------------------------\n\n. \n```\n:::\n:::\n\n\n::: {#c04a7742 .cell execution_count=8}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n. ssc install table1\nchecking table1 consistency and verifying not already installed...\nall files already exist and are up to date.\n\n. * see help table1\n. table1, by(female) vars(lnwage contn %3.2f \\ age contn %2.1f \\ married bin)\n  +--------------------------------------------------------------------+\n  | Factor                         female = 0    female = 1    p-value |\n  |--------------------------------------------------------------------|\n  | N                              759           888                   |\n  |--------------------------------------------------------------------|\n  | log hourly wages, mean (SD)    3.44 (0.48)   3.27 (0.57)    <0.001 |\n  |--------------------------------------------------------------------|\n  | age of respondent, mean (SD)   38.5 (11.3)   39.9 (10.7)     0.012 |\n  |--------------------------------------------------------------------|\n  | married                        397 (52.3%)   465 (52.4%)      0.98 |\n  +--------------------------------------------------------------------+\n\n. qui:table1, by(female) vars(lnwage contn %3.2f \\ age contn %2.1f \\ married bi\n> n) saving(m1.xls)\nfile m1.xls already exists\nr(602);\n```\n:::\n:::\n\n\nYou can see the file [here](m1.xls)\n\n- There are other options from `Stata` as well. see `help dtable` and `help table`.\n\n- Or you could construct some yourself with the help of `estout` and `esttab`.\n\n- See [here](https://grodri.github.io/stata/tables) for a quick guide on tables.\n\n## Creating variables\n\n- Two main commands:\n  - `generate` (or `gen` for short): Creates new variables as a function of others in the data. One can apply system functions. Example:\n    -  `gen var1 = 1`\n    -  `gen var2 = _n`\n    -  `gen wage = exp(lnwage)`\n    -  `gen age_educ = age * educ`\n   -  `replace`: replaces values in an already existing variable. \n      -  `replace wage = 0 if wage==.`\n      -  `replace age_educ = . if female==1`\n  -  `egen`: Advanced variable generating function. It applies a single function to a variable or list of variables to create a third one.\n     -  `egen wage_mean=mean(exp(lnwage)), by(female)`\n     -  `egen wage_p10=pctile(lnwage), by(female) p(10)`\n-  To *delete* a variable, you can use `drop varname/varlist` or `drop2 varname/varlist`\n   -  `drop` is the official. Stops if the variable does not exist.\n   -  `drop2` an addon. Will still work even if a variable name does not exist.  \n       Requires using full variable name. \n\n::: {#c0bcb3bd .cell execution_count=9}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n. gen var1 = exp(lnwage)\n(213 missing values generated)\n\n. gen xar2 = exp(lnwage)+married\n(213 missing values generated)\n\n. drop x\n\n. des var1 xar2\nvariable xar2 not found\nr(111);\n```\n:::\n:::\n\n\n::: {#efeec6e7 .cell execution_count=10}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n. gen xar2 = exp(lnwage)+married\n(213 missing values generated)\n\n. drop2 x\nvariable x not found\n\n. \n```\n:::\n:::\n\n\n## Variables Management\n\n- `Stata` is case sensitive. \n  - You can create variables with names `one`, `One`, `OnE`, `ONE`, etc. \n  - \"file addresses\" and commands are also case sensitive\n- In `Stata`, variable names ***cannot*** can only start with a letter or \"_\". Otherwise, it will give you an error.\n- Once variables are created, you could \"label\" them  \n    `label var variable_name \"Description\" `\n- You can name other components of a dataset as well. See `help label`    \n\n## Plots in Stata\n\n- `Stata` can create figures and plots for data exploration\n\n### Scatter plot\n\n::: {#4961e0b7 .cell execution_count=11}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n. webuse dui, clear\n(Fictional data on monthly drunk driving citations)\n\n. scatter citations fines\n\n. \n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](Stata_Basics_files/figure-html/cell-12-output-2.png){}\n:::\n:::\n\n\n::: {#75815d0e .cell execution_count=12}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n. two (scatter citations fines if csize==1)  ///\n>     (scatter citations fines if csize==2), ///\n>     legend(order(1 \"Small\" 2 \"Medium\"))\n\n. \n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](Stata_Basics_files/figure-html/cell-13-output-2.png){}\n:::\n:::\n\n\n- The limitation. User written plotting commands do not interact well with Official plotting commands.\n\n## Saving your work\n\n- Command Window is effective to provide interactive analysis\n- At the end of your *session*, you can recover everything you did, clicking on the History Section, and save everythig, or just specific commands.\n- The best approach, however, is to  ***ALWAYS***   use a do-file.\n\n- **First of all**: Create a working directory. A folder in your computer that will hold your project, work, paper, homework, etc. (highly recommended)\n- **Create a dofile**: For simple projects a single file will suffice, but multiple may be needed for larger ones.\n- To start a dofile, simply type `doedit \"filename\"` in your command window.\n  - If file exists in your \"working directory\" (type `cd` to see where you \"are\"), it will open it.\n  - Otherwise, a new file will be created\n\n- `do-files` are the best approach to save your work, and keep track of your analysis.\n- General Suggestion: Allways add comments to it, to know what you are doing\n\n::: {#95ad2c4e .cell execution_count=13}\n``` {.stata .cell-code}\n*  You can always Start a command like this\n// Or like this\n/*\nBut you can always add a large comment using \"/*\" to start\nand \"*/\" to end it\n*/\n\n/* You could also add comments at the end of a command */\nsysuse auto, clear  // Loading Auto Dataset, after \"clearing\" the one currently in memory\n\n// Or as I did before, break a long command in various lines using \"///\"\n// Comments after \"///\" are possible\nregress price     /// Dep variable\n        mpg       /// indep variable \n        i.foreign, /// Foreign Dummy\n        robust     // Request Robust Standard errors.\n        \n** Last one has only two \"/\", because line ends there\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(1978 automobile data)\n\nLinear regression                               Number of obs     =         74\n                                                F(2, 71)          =      12.72\n                                                Prob > F          =     0.0000\n                                                R-squared         =     0.2838\n                                                Root MSE          =     2530.9\n\n------------------------------------------------------------------------------\n             |               Robust\n       price | Coefficient  std. err.      t    P>|t|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n         mpg |  -294.1955   60.33645    -4.88   0.000     -414.503   -173.8881\n             |\n     foreign |\n    Foreign  |   1767.292   607.7385     2.91   0.005     555.4961    2979.088\n       _cons |   11905.42   1362.547     8.74   0.000     9188.573    14622.26\n------------------------------------------------------------------------------\n```\n:::\n:::\n\n\n## Estimation Commands\n\n- Most commands in `Stata` have the following syntax:\n\n```\n[by varlist:/prefix] command [varlist]  [if exp] [in range] [weight] [using filename] [,options]\n```\n\n- everything in `[]` are optional. \n- `[by varlist:/prefix]`: `by` is used to execute the command by groups.  \n  `prefix` to request additional manipulation (advanced use)\n- `command`: The command itself that will process the data\n- `varlist`: For Estimation commands include the dependent (first) and independent variables (everything else)\n- `[if exp] [in range]`: To restrict  samples \n- `[weight]`: Request the use of weights ie: `[fw = wgt_var]` or `[pw = wgt_var]`\n- `[using filename]`: Some commands allow you to use this to work with not-yet loaded datasets or files.\n- `[options]`: Options requesting specific behaivior, statistics, etc\n\n## Adv options for saving work.\n\n- Use `github`, as an additional data-repository\n- Combine `Stata`, `python` and `nbstat` to create `Jupyter notebooks`.\n- You can also use Quarto to create full dynamic reports.\n\n# Thank you!\n\n",
    "supporting": [
      "Stata_Basics_files"
    ],
    "filters": [],
    "includes": {}
  }
}