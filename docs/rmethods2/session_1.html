<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Fernando Rios-Avila">

<title>Econometrics MSC Levy - Research Methods II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Econometrics MSC Levy</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../adv_class/index.html"> 
<span class="menu-text">Adv Methods and Causal Effects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../rmethods/index.html"> 
<span class="menu-text">Research Methods: Econometrics I</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../rmethods2/index.html"> 
<span class="menu-text">Research Methods II: Applied Methods</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-math-refresher" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Math Refresher</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-math-refresher">    
        <li>
    <a class="dropdown-item" href="../mathref/math_1.html">
 <span class="dropdown-text">Math Refresher: Basic Calculus</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../mathref/math_2.html">
 <span class="dropdown-text">Math Refresher: Basic Linear Algebra</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../mathref/math_3.html">
 <span class="dropdown-text">Math Refresher: Basic Statistics and Probability</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#why-are-we-here" id="toc-why-are-we-here" class="nav-link active" data-scroll-target="#why-are-we-here">Why are we here?</a></li>
  <li><a href="#surveys-what-are-they" id="toc-surveys-what-are-they" class="nav-link" data-scroll-target="#surveys-what-are-they">Surveys: What are they?</a>
  <ul class="collapse">
  <li><a href="#what-is-a-survey" id="toc-what-is-a-survey" class="nav-link" data-scroll-target="#what-is-a-survey">What is a Survey?</a></li>
  <li><a href="#example-of-surveys" id="toc-example-of-surveys" class="nav-link" data-scroll-target="#example-of-surveys">Example of Surveys</a></li>
  <li><a href="#what-makes-a-good-survey" id="toc-what-makes-a-good-survey" class="nav-link" data-scroll-target="#what-makes-a-good-survey">What makes a good survey?</a></li>
  <li><a href="#types-of-data-seletion" id="toc-types-of-data-seletion" class="nav-link" data-scroll-target="#types-of-data-seletion">Types of Data Seletion</a></li>
  <li><a href="#what-to-be-aware-of" id="toc-what-to-be-aware-of" class="nav-link" data-scroll-target="#what-to-be-aware-of">What to be aware of?</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">Descriptive Statistics</a></li>
  <li><a href="#basic-summary-statistics" id="toc-basic-summary-statistics" class="nav-link" data-scroll-target="#basic-summary-statistics">Basic Summary Statistics:</a></li>
  <li><a href="#accounting-for-weights" id="toc-accounting-for-weights" class="nav-link" data-scroll-target="#accounting-for-weights">Accounting for Weights</a></li>
  <li><a href="#summary-statistics-with-weights" id="toc-summary-statistics-with-weights" class="nav-link" data-scroll-target="#summary-statistics-with-weights">Summary Statistics with Weights</a></li>
  <li><a href="#variance-with-weights" id="toc-variance-with-weights" class="nav-link" data-scroll-target="#variance-with-weights">Variance with Weights</a></li>
  <li><a href="#how-to-account-for-weights-in-stata" id="toc-how-to-account-for-weights-in-stata" class="nav-link" data-scroll-target="#how-to-account-for-weights-in-stata">How to account for weights in Stata?</a></li>
  <li><a href="#testing-significance-across-2-groups" id="toc-testing-significance-across-2-groups" class="nav-link" data-scroll-target="#testing-significance-across-2-groups">Testing Significance across 2 groups</a></li>
  <li><a href="#testing-significance-across-2-groups-1" id="toc-testing-significance-across-2-groups-1" class="nav-link" data-scroll-target="#testing-significance-across-2-groups-1">Testing Significance across 2 groups</a></li>
  </ul></li>
  <li><a href="#io-tables" id="toc-io-tables" class="nav-link" data-scroll-target="#io-tables">IO-Tables</a>
  <ul class="collapse">
  <li><a href="#io-tables-1" id="toc-io-tables-1" class="nav-link" data-scroll-target="#io-tables-1">IO-Tables</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"></a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"></a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#example---stata" id="toc-example---stata" class="nav-link" data-scroll-target="#example---stata">Example - <code>Stata</code></a></li>
  </ul></li>
  <li><a href="#sam-social-accounting-matrix" id="toc-sam-social-accounting-matrix" class="nav-link" data-scroll-target="#sam-social-accounting-matrix">SAM: Social Accounting Matrix</a>
  <ul class="collapse">
  <li><a href="#sam-social-accounting-matrix-1" id="toc-sam-social-accounting-matrix-1" class="nav-link" data-scroll-target="#sam-social-accounting-matrix-1">SAM: Social Accounting Matrix</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example 2</a></li>
  <li><a href="#example-3" id="toc-example-3" class="nav-link" data-scroll-target="#example-3">Example 3</a></li>
  <li><a href="#other-extensions" id="toc-other-extensions" class="nav-link" data-scroll-target="#other-extensions">Other Extensions</a></li>
  </ul></li>
  <li><a href="#thats-all-folks" id="toc-thats-all-folks" class="nav-link" data-scroll-target="#thats-all-folks">Thats all folks!</a>
  <ul class="collapse">
  <li><a href="#what-to-get-from-today" id="toc-what-to-get-from-today" class="nav-link" data-scroll-target="#what-to-get-from-today">What to get from today?</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="session_1.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Research Methods II</h1>
<p class="subtitle lead">Session 1: Surveys, IO and SAM</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Fernando Rios-Avila </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="why-are-we-here" class="level2">
<h2 class="anchored" data-anchor-id="why-are-we-here">Why are we here?</h2>
<ul>
<li><p>If you are reading this, you are probably interested in the Microeconometrics path of Research methods II.</p></li>
<li><p>This course assumes you are familiar with the basics of econometrics and statistics.</p>
<ul>
<li>We will not cover questions from Research methods I. You probably know the answers to those questions already!</li>
</ul></li>
<li><p>This course will focus on tools that are commonly used in empirical research in economics:</p>
<ul>
<li><p>We will emphasize the use of Household Surveys (with the issues it entails)</p></li>
<li><p>And focus on applied econometrics using cross-sectional data, for distributional analysis and policy simulation.</p></li>
</ul></li>
<li><p>Thus, we will do much more use of empirical tools and software than we did in Research methods I.</p></li>
<li><p>We will have 7 Sessions, and 2 homeworks .</p></li>
</ul>
</section>
<section id="surveys-what-are-they" class="level1">
<h1>Surveys: What are they?</h1>
<section id="what-is-a-survey" class="level2">
<h2 class="anchored" data-anchor-id="what-is-a-survey">What is a Survey?</h2>
<ul>
<li>A Survey is a source of data that aims to collect information from a population of interest, to underestand some characteristics, behaviors, or opinions of that population as a whole.
<ul>
<li>The population of interest can be individuals, households, firms, etc.</li>
</ul></li>
<li>They can be useful to identify and analyze policy questions.</li>
<li>However, they are secondary data, and thus have limitations in terms of the questions that can be answered with them.
<ul>
<li>You cannot answer questions that require data that was not collected.</li>
<li>They can also be limited to Interivewee recall, or willingness to answer.</li>
<li>Or how accessible the population of interest is.</li>
</ul></li>
</ul>
</section>
<section id="example-of-surveys" class="level2">
<h2 class="anchored" data-anchor-id="example-of-surveys">Example of Surveys</h2>
<ul>
<li>Current Population Survey (CPS)
<ul>
<li>Monthly survey of 60,000 households in the US.</li>
</ul></li>
<li>American Community Survey (ACS)
<ul>
<li>Annual survey of 3.5 million households in the US.</li>
</ul></li>
<li>American Time Use Survey (ATUS)
<ul>
<li>Annual survey of 6,000 individuals in the US.</li>
</ul></li>
<li>Enterprise Surveys - WB (ES)
<ul>
<li>Survey of firms in developing countries. Different years of Collection</li>
</ul></li>
</ul>
</section>
<section id="what-makes-a-good-survey" class="level2">
<h2 class="anchored" data-anchor-id="what-makes-a-good-survey">What makes a good survey?</h2>
<ul>
<li><p>A Good survey is one that allows you to obtain estimates of statistics of interest for the population with “Tolaraable” levels of Accuracy.</p></li>
<li><p>To do this, you need to have a good sampling design (representation and “independence of the population”) and a good questionnaire design (questions that are clear and easy to answer).</p></li>
<li><p>A good survey needs to be representative of the population of interest. To do this appropriately, data will be collected based on a <strong>frame</strong> that will be used to select the sample.</p></li>
</ul>
</section>
<section id="types-of-data-seletion" class="level2">
<h2 class="anchored" data-anchor-id="types-of-data-seletion">Types of Data Seletion</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Simple</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Clustered</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Stratified</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<ul>
<li><p>Each observation in the “frame” has the same probability of being selected in the sample.</p></li>
<li><p>It may be difficult to implement in practice, because of cost and logistics. (distance)</p></li>
<li><p>It could also have problems of representativeness for small groups. (rare events)</p></li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ul>
<li>Using some criteria, location for example, the population is divided into clusters.</li>
<li>For the sample selection, certain clusters are selected at random, and “some” observations within each selected.</li>
<li>This is more feasible in practice, because takes advantage of the “clustering” of the population.</li>
<li>However, one may need to account for possible “common shocks” that people within the same cluster may have.</li>
</ul>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<ul>
<li>Some times, statistics are required to accurately represent certain groups of the population. (by region, race, income level, etc)</li>
<li>In such cases, data can be collected in a way that ensures that the sample has enough observations for each group of interest.
<ul>
<li>It would be as collecting multiple samples, one for each group of interest.</li>
</ul></li>
<li>Within each Strata, it would also be possible to use a simple or clustered sampling design.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="what-to-be-aware-of" class="level2">
<h2 class="anchored" data-anchor-id="what-to-be-aware-of">What to be aware of?</h2>
<ul>
<li>The sampling design is important to ensure that the sample is representative of the population of interest.</li>
<li>However, there are limitations:
<ul>
<li>Not every-one selected will respond to the survey. (Is it random? )</li>
<li>Rarey one assumes equal probability of selection. (Different sampling weights)</li>
<li>Use of Stratatification and Clustering may require special treatment.</li>
</ul></li>
<li>Something else: Panel data
<ul>
<li>Because of attrition, it can be difficult to analyze if representativeity is required.</li>
<li>However, it can be useful to analyze dynamics.</li>
</ul></li>
</ul>
</section>
<section id="descriptive-statistics" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h2>
<ul>
<li><p>Once you have your data, you can start analyzing it by simply applying your survey weights.</p>
<ul>
<li>Point estimates are straightforward to obtain.</li>
</ul></li>
<li><p>However, when considering the estimation of precision of the estimates (Variance and Standard Errors), there are two approaches that are important to consider:</p></li>
<li><p><strong>Finite Population Approach</strong>:</p>
<ul>
<li>Associated with data description</li>
<li>Assumes that the population is finite, and thus Selection probabilities are not independent.</li>
</ul></li>
<li><p><strong>Superpopulation Approach</strong>:</p>
<ul>
<li>Associated with data modeling.</li>
<li>Population is infinite. Selection probabilties are independent.</li>
</ul></li>
<li><p>For practical purposes, the difference between the two approaches is not that important.</p>
<ul>
<li>With large enough samples, he “finite sample correction” is negligible.</li>
</ul></li>
</ul>
</section>
<section id="basic-summary-statistics" class="level2">
<h2 class="anchored" data-anchor-id="basic-summary-statistics">Basic Summary Statistics:</h2>
<ul>
<li><span class="math inline">\(n\)</span> is sample size. <span class="math inline">\(N\)</span> is population size.</li>
<li><span class="math inline">\(a_i\)</span> an indicator of belonging to the sample. <span class="math inline">\(\sum a_i=n\)</span></li>
<li>Assume <span class="math inline">\(y_i\)</span> is the outcome of interest, Say income. <span class="math display">\[\texttt{mean: }\hat{\mu}_y=\bar{y} = \frac{1}{n}\sum_{i=1}^N a_i y_i = \frac{1}{n}\sum_{j=1}^n y_j\]</span> <span class="math display">\[\texttt{Variance: }\hat \sigma^2_y = \frac{1}{n-1} \sum_{i=1}^N a_i (y_i - \hat{\bar{y}} )^2\]</span> <span class="math display">\[\texttt{V of mean: }\widehat{V}(\bar{y}) = \frac{\sigma^2_y }{n} * fpc\]</span></li>
</ul>
<p>Where <span class="math inline">\(fpc = \frac{N-n}{N-1}\)</span> is the finite population correction.</p>
</section>
<section id="accounting-for-weights" class="level2">
<h2 class="anchored" data-anchor-id="accounting-for-weights">Accounting for Weights</h2>
<ul>
<li><p>The previous formulas did not account for weights.</p></li>
<li><p>Weights are factors used to “reweight/expand” the sample to make it representative of the population.</p></li>
<li><p>They can are typically related to the inverse of the probability of selection.</p></li>
<li><p>Simply said, a weight <span class="math inline">\(w_i=\frac{1}{n*\pi_i}\)</span> is a measure of how many observations in the population are represented by observation <span class="math inline">\(i\)</span> in the sample.</p></li>
</ul>
<p>But how do we account for weights in the formulas?</p>
</section>
<section id="summary-statistics-with-weights" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics-with-weights">Summary Statistics with Weights</h2>
<p>Population: <span class="math display">\[\hat N = \sum_{i=1}^n w_i\]</span></p>
<p>Normalized weights <span class="math display">\[v_i = \frac{n w_i}{ \sum w_i} \rightarrow E(v_i) = 1\]</span></p>
<p>Mean: <span class="math display">\[\hat{\mu}_y=\bar{y} = \frac{1}{\hat N}\sum_{i=1}^n w_i y_i = \frac{1}{n}\sum v_i y_i\]</span></p>
</section>
<section id="variance-with-weights" class="level2">
<h2 class="anchored" data-anchor-id="variance-with-weights">Variance with Weights</h2>
<p>Variances are a bit more complicated. Normally you would consider:</p>
<p><span class="math display">\[Var(\bar y) = \frac{1}{n} \hat \sigma^2_y =\frac{1}{n} \frac{1}{n-1} \sum_{i=1}^n v_i (y_i - \bar y)^2\]</span></p>
<p>However, with survey weights you need to consider something else: <span class="math display">\[Var(\bar y) = \frac{1}{n} \sum_{i=1}^n v_i^2 (y_i - \bar y)^2\]</span></p>
<p>Which is similar to “robust” Standard errors in OLS.</p>
<blockquote class="blockquote">
<p>What about Clusters and Strata?</p>
</blockquote>
</section>
<section id="how-to-account-for-weights-in-stata" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="how-to-account-for-weights-in-stata">How to account for weights in Stata?</h2>
<p>Lets use data from the National Health and Nutrition Examination Survey (NHANES) to illustrate how to account for weights in Stata.</p>
<div id="5cb4e235" class="cell larger" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a> frause oaxaca, <span class="kw">clear</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>** Create Weights &lt;- This will <span class="kw">be</span> provided</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">sum</span> wt, <span class="kw">meanonly</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> wt = <span class="fu">round</span>(wt/<span class="fu">r</span>(<span class="fu">min</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> wage = <span class="fu">exp</span>(lnwage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>div.jp-Notebook .datagrid-container {min-height: 448px; }</style>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(Excerpt from the Swiss Labor Market Survey 1998)
(1,647 real changes made)
(213 missing values generated)</code></pre>
</div>
</div>
<p>Summary Statistics:</p>
<div id="cd854a4b" class="cell larger" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>** unweighted</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">sum</span> wage,<span class="kw">d</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>** weighted</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">sum</span> wage [aw=wt],<span class="kw">d</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                            wage
-------------------------------------------------------------
      Percentiles      Smallest
 1%     3.907204       1.661434
 5%      11.8007       1.873127
10%      17.4216       2.197802       Obs               1,434
25%     23.19902       2.442003       Sum of wgt.       1,434

50%     30.08896                      Mean           32.39167
                        Largest       Std. dev.      16.12498
75%      38.5662       137.3627
90%     49.95005       152.6252       Variance       260.0151
95%     58.71271       164.8352       Skewness       2.486954
99%     85.47008       192.3077       Kurtosis       18.23702

                            wage
-------------------------------------------------------------
      Percentiles      Smallest
 1%     3.453689       1.661434
 5%     7.370678       1.873127
10%     15.83933       2.197802       Obs               1,434
25%     21.72247       2.442003       Sum of wgt.       2,686

50%     29.48271                      Mean            31.5322
                        Largest       Std. dev.      16.32811
75%     38.46154       137.3627
90%     49.95005       152.6252       Variance       266.6071
95%     58.11497       164.8352       Skewness       2.081806
99%     85.47008       192.3077       Kurtosis       14.68647</code></pre>
</div>
</div>
<p>Accounting for weights for summary Statistics</p>
<div id="b470d2b6" class="cell larger" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>** unweighted</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">mean</span> wage </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>** weighted</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">mean</span> wage [pw=wt]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">mean</span> wage [pw=wt], <span class="bn">over</span>(female)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mean estimation                          Number of obs = 1,434

--------------------------------------------------------------
             |       Mean   Std. err.     [95% conf. interval]
-------------+------------------------------------------------
        wage |   32.39167   .4258186      31.55637    33.22696
--------------------------------------------------------------

Mean estimation                          Number of obs = 1,434

--------------------------------------------------------------
             |       Mean   Std. err.     [95% conf. interval]
-------------+------------------------------------------------
        wage |    31.5322   .4765835      30.59733    32.46708
--------------------------------------------------------------

Mean estimation                           Number of obs = 1,434

---------------------------------------------------------------
              |       Mean   Std. err.     [95% conf. interval]
--------------+------------------------------------------------
c.wage@female |
           0  |   33.87649   .6152059      32.66969    35.08329
           1  |   28.76133    .722173       27.3447    30.17796
---------------------------------------------------------------</code></pre>
</div>
</div>
<p>Tables and cross tables</p>
<div id="e02f462d" class="cell larger" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>** unweighted</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> educ female</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">tab</span> educ female [<span class="fu">w</span>=wt]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           |   sex of respondent
  years of |      (1=female)
 education |         0          1 |     Total
-----------+----------------------+----------
         5 |         6         23 |        29 
         9 |        47         93 |       140 
      9.75 |         8         26 |        34 
        10 |        10         42 |        52 
      10.5 |       376        447 |       823 
      11.5 |         7         14 |        21 
        12 |       111         87 |       198 
      12.5 |        56         80 |       136 
        15 |        60         13 |        73 
      17.5 |        78         63 |       141 
-----------+----------------------+----------
     Total |       759        888 |     1,647 

           |   sex of respondent
  years of |      (1=female)
 education |         0          1 |     Total
-----------+----------------------+----------
         5 |        17         45 |        62 
         9 |       104        181 |       285 
      9.75 |        14         52 |        66 
        10 |        22         80 |       102 
      10.5 |       725        833 |     1,558 
      11.5 |        19         27 |        46 
        12 |       201        148 |       349 
      12.5 |       108        157 |       265 
        15 |       111         21 |       132 
      17.5 |       149        111 |       260 
-----------+----------------------+----------
     Total |     1,470      1,655 |     3,125 </code></pre>
</div>
</div>
<p>Better approach: <code>svyset</code></p>
<div id="0ab51f80" class="cell larger" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">webuse</span> nhanes2f, <span class="kw">clear</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">svyset</span> psuid <span class="co">/// Cluster</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>       [<span class="kw">pweight</span>=finalwgt], <span class="co">/// Survey Weight as Inverse of Prob of Selection</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>       <span class="kw">strata</span>(stratid)     <span class="co">// Strata Identifier</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">mean</span> zinc      </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">mean</span> zinc [pw=finalwgt]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">svy</span>: <span class="kw">mean</span> zinc      </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sampling weights: finalwgt
             VCE: linearized
     Single unit: missing
        Strata 1: stratid
 Sampling unit 1: psuid
           FPC 1: &lt;zero&gt;

Mean estimation                          Number of obs = 9,189

--------------------------------------------------------------
             |       Mean   Std. err.     [95% conf. interval]
-------------+------------------------------------------------
        zinc |   86.51518   .1510744      86.21904    86.81132
--------------------------------------------------------------

Mean estimation                          Number of obs = 9,189

--------------------------------------------------------------
             |       Mean   Std. err.     [95% conf. interval]
-------------+------------------------------------------------
        zinc |   87.18207   .1828747      86.82359    87.54054
--------------------------------------------------------------
(running mean on estimation sample)

Survey: Mean estimation

Number of strata = 31            Number of obs   =       9,189
Number of PSUs   = 62            Population size = 104,176,071
                                 Design df       =          31

--------------------------------------------------------------
             |             Linearized
             |       Mean   std. err.     [95% conf. interval]
-------------+------------------------------------------------
        zinc |   87.18207   .4944827      86.17356    88.19057
--------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="testing-significance-across-2-groups" class="level2">
<h2 class="anchored" data-anchor-id="testing-significance-across-2-groups">Testing Significance across 2 groups</h2>
<p>Consider two groups with the following characteristics:</p>
<table class="table">
<thead>
<tr class="header">
<th>Group</th>
<th>N</th>
<th>mean</th>
<th>Var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>100</td>
<td>45</td>
<td>32.56</td>
</tr>
<tr class="even">
<td>2</td>
<td>150</td>
<td>55</td>
<td>21.97</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Is the difference in means statistically significant?</p></li>
<li><p>Test <span class="math inline">\(H_0: \mu_1 = \mu_2\)</span> vs <span class="math inline">\(H_1: \mu_1 \neq \mu_2\)</span></p></li>
</ul>
<p><span class="math display">\[t = \frac{\mu_2 - \mu_1}{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}}
=\frac{10}{\sqrt{\frac{32.56}{100}+\frac{21.97}{150}}}=\frac{10}{.47207} = 14.55453
\]</span></p>
<ul>
<li><p>If <span class="math inline">\(t\)</span> is large enough, we can reject the null hypothesis.</p></li>
<li><p>But this does not work if you have weights…</p></li>
</ul>
</section>
<section id="testing-significance-across-2-groups-1" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="testing-significance-across-2-groups-1">Testing Significance across 2 groups</h2>
<ul>
<li>But you can use OLS to test the difference in means with weights!
<ul>
<li>Make sure you use “robust” standard errors, or “pw” option.</li>
</ul></li>
</ul>
<div id="fb0c6fa7" class="cell larger" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a> frause oaxaca, <span class="kw">clear</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>** Create Weights &lt;- This will <span class="kw">be</span> provided</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">sum</span> wt, <span class="kw">meanonly</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> wt = <span class="fu">round</span>(wt/<span class="fu">r</span>(<span class="fu">min</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> wage = <span class="fu">exp</span>(lnwage)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="kw">reg</span> wage i.female [pw=wt],</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Excerpt from the Swiss Labor Market Survey 1998)
(1,647 real changes made)
(213 missing values generated)
(sum of wgt is 2,686)

Linear regression                               Number of obs     =      1,434
                                                F(1, 1432)        =      29.05
                                                Prob &gt; F          =     0.0000
                                                R-squared         =     0.0244
                                                Root MSE          =     16.133

------------------------------------------------------------------------------
             |               Robust
        wage | Coefficient  std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
    1.female |  -5.115156   .9490209    -5.39   0.000    -6.976776   -3.253536
       _cons |   33.87649   .6154206    55.05   0.000     32.66927    35.08371
------------------------------------------------------------------------------</code></pre>
</div>
</div>
<ul>
<li>you can also use <code>svy: regress</code> for complex designs.</li>
</ul>
<p>see <a href="https://stats.oarc.ucla.edu/stata/faq/how-can-i-do-a-t-test-with-survey-data/">here</a> for additional examples</p>
</section>
</section>
<section id="io-tables" class="level1">
<h1>IO-Tables</h1>
<section id="io-tables-1" class="level2">
<h2 class="anchored" data-anchor-id="io-tables-1">IO-Tables</h2>
<ul>
<li><p>IO tables stand for Input-Output tables. They are a way to represent the production structure of an economy.</p></li>
<li><p>They provide a Static representation of the Economy</p></li>
<li><p>Each Row represents the production of a sector, and each column represents the use of that production by other sectors as Inputs.</p></li>
<li><p>The information it contains represent a snapshot of the economy at a given point in time.</p></li>
<li><p>It can be used to simulate changes in production, labor demand, and total production in the economy, under specific assumptions (production function)</p></li>
</ul>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<ul>
<li><p>Consider a Economy with K=3 sectors: Agriculture, Manufacturing and Services, with a Final consumer agent (households)</p></li>
<li><p>Each sector (i) produces a good (<span class="math inline">\(X_i\)</span>), which is sold to other sectors or the final consumer.</p></li>
<li><p><span class="math inline">\(X_{ij}\)</span> is the quantity of goods sector <span class="math inline">\(i\)</span> sells to sector <span class="math inline">\(j\)</span>, and <span class="math inline">\(y_i\)</span> the final consumption by households.</p></li>
<li><p><span class="math inline">\(X_{ji}\)</span> is also the quantity of goods sector <span class="math inline">\(i\)</span> uses from sector <span class="math inline">\(j\)</span> as inputs.</p></li>
<li><p><span class="math inline">\(L_i\)</span> is the amount of labor used by sector <span class="math inline">\(i\)</span>.</p></li>
<li><p>In a simple Economy, (value) Total labor demand is equal to total Household income. <span class="math inline">\(L_a + L_m + L_s = L = y_a + y_m + y_s\)</span></p></li>
</ul>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
<p>This simple Economy can be represented as follows:</p>
<p><span class="math display">\[
\begin{aligned}
X_{11} &amp;+ X_{12} &amp;+ X_{13} &amp;+ Y_{1}  &amp;= X_{1} \\
X_{21} &amp;+ X_{22} &amp;+ X_{23} &amp;+ Y_{2} &amp;= X_{2} \\
X_{31} &amp;+ X_{32} &amp;+ X_{33} &amp;+ Y_{3} &amp;= X_{3} \\
L_1 &amp;+ L_2 &amp;+ L_3 &amp;\ \ &amp;= L
\end{aligned}
\]</span></p>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2"></h2>
<p>From the consumption/inputs Side, we could also write the equations as:</p>
<p><span class="math display">\[
\begin{aligned}
X_{11} &amp;+ X_{21} &amp;+ X_{31} &amp;+ L_{1}  &amp;= X_{1} \\
X_{12} &amp;+ X_{22} &amp;+ X_{32} &amp;+ L_{2} &amp;= X_{2} \\
X_{13} &amp;+ X_{23} &amp;+ X_{33} &amp;+ L_{3} &amp;= X_{3} \\
Y_1 &amp;+ Y_2 &amp;+ Y_3 &amp;  &amp;= Y
\end{aligned}
\]</span></p>
<p>And from here we can get the technical coefficients:</p>
<p><span class="math display">\[
\begin{aligned}
a_{11} X_1 &amp;+ a_{21} X_1 &amp;+ a_{31} X_1 &amp;+ \lambda_{1} X_1 &amp;= X_1 \\
a_{12} X_2 &amp;+ a_{22} X_2 &amp;+ a_{32} X_2 &amp;+ \lambda_{2} X_2 &amp;= X_2 \\
a_{13} X_3 &amp;+ a_{23} X_3 &amp;+ a_{33} X_3 &amp;+ \lambda_{3} X_3 &amp;= X_3 \\
\delta_1 Y &amp;+ \delta_2 Y &amp; + \delta_3 Y &amp;  &amp;= Y
\end{aligned}
\]</span></p>
<p>Where <span class="math inline">\(a_{ij} = \frac{X_{ij}}{X_j}\)</span> and <span class="math inline">\(\lambda_i = \frac{L_i}{X_i}\)</span></p>
<p><span class="math display">\[a_{1i}+a_{2i}+a_{3i}+\lambda_i = 1 \ \&amp; \ \delta_1+\delta_2+\delta_3 =1\]</span></p>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3"></h2>
<p>With this, we can write the IO table</p>
<p><span class="math display">\[
\begin{aligned}
a_{11} X_1 &amp;+ a_{12} X_2 &amp;+ a_{13} X_3  &amp;+ \delta_1 Y &amp;= X_{1} \\
a_{21} X_1 &amp;+ a_{22} X_2 &amp;+ a_{23} X_3  &amp;+ \delta_2 Y &amp;= X_{2} \\
a_{31} X_1 &amp;+ a_{32} X_2 &amp;+ a_{33} X_3  &amp;+ \delta_3 Y &amp;= X_{3} \\
\lambda_1 X_1 &amp;+ \lambda_2 X_2 &amp;+ \lambda_3 X_3 &amp;\ \ &amp;= L
\end{aligned}
\]</span></p>
<p>Or into Matrix Form</p>
<p><span class="math display">\[
\begin{pmatrix}
a_{11} &amp; a_{12} &amp; a_{13}  \\
a_{21} &amp; a_{22} &amp; a_{23} \\
a_{31} &amp; a_{32} &amp; a_{33} \\
\lambda_1 &amp; \lambda_2 &amp; \lambda_3
\end{pmatrix}
\begin{pmatrix}
X_1 \\ X_2 \\ X_3
\end{pmatrix} +
\begin{pmatrix}
Y_1 \\ Y_2 \\ Y_3 \\ 0
\end{pmatrix}=
\begin{pmatrix}
X_1 \\ X_2 \\ X_3 \\ L
\end{pmatrix}
\]</span></p>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4"></h2>
<p>Solve for Production sectors:</p>
<p><span class="math display">\[
\begin{pmatrix}
a_{11} &amp; a_{12} &amp; a_{13}  \\
a_{21} &amp; a_{22} &amp; a_{23} \\
a_{31} &amp; a_{32} &amp; a_{33}
\end{pmatrix}
\begin{pmatrix}
X_1 \\ X_2 \\ X_3
\end{pmatrix} +
\begin{pmatrix}
Y_1 \\ Y_2 \\ Y_3
\end{pmatrix}=
\begin{pmatrix}
X_1 \\ X_2 \\ X_3
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[
\begin{pmatrix}
Y_1 \\ Y_2 \\ Y_3
\end{pmatrix}=I \begin{pmatrix} X_1 \\ X_2 \\ X_3 \end{pmatrix} -
A \begin{pmatrix} X_1 \\ X_2 \\ X_3 \end{pmatrix} = (I-A) \begin{pmatrix} X_1 \\ X_2 \\ X_3 \end{pmatrix}
\]</span></p>
<p>Finally:</p>
<p><span class="math display">\[
\begin{pmatrix} X_1 \\ X_2 \\ X_3 \end{pmatrix} = (I-A)^{-1} \begin{pmatrix} Y_1 \\ Y_2 \\ Y_3 \end{pmatrix}
\rightarrow
\begin{pmatrix} \Delta X_1 \\ \Delta X_2 \\ \Delta X_3 \end{pmatrix} = (I-A)^{-1}
\begin{pmatrix} \Delta Y_1 \\ \Delta Y_2 \\ \Delta Y_3 \end{pmatrix}
\]</span></p>
</section>
<section id="example" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="example">Example</h2>
<ul>
<li>Consider the following IO table for a simple economy with 3 sectors and a final consumer.</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 21%">
<col style="width: 18%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Sector</th>
<th style="text-align: center;">Agriculture</th>
<th style="text-align: center;">Manufacturing</th>
<th style="text-align: center;">Services</th>
<th style="text-align: center;">Final Consumer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Agriculture</td>
<td style="text-align: center;">102</td>
<td style="text-align: center;">103</td>
<td style="text-align: center;">153</td>
<td style="text-align: center;">129</td>
</tr>
<tr class="even">
<td>Manufacturing</td>
<td style="text-align: center;">133</td>
<td style="text-align: center;">124</td>
<td style="text-align: center;">77</td>
<td style="text-align: center;">99</td>
</tr>
<tr class="odd">
<td>Services</td>
<td style="text-align: center;">71</td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">51</td>
<td style="text-align: center;">165</td>
</tr>
<tr class="even">
<td>Households</td>
<td style="text-align: center;">181</td>
<td style="text-align: center;">114</td>
<td style="text-align: center;">98</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
<p>S1: What is the total production of each sector?</p>
<ul>
<li><span class="math inline">\(X_1 = 102 + 103 + 153 + 129 = 487\)</span></li>
<li><span class="math inline">\(X_2 = 133 + 124 + 77 + 99 = 433\)</span></li>
<li><span class="math inline">\(X_3 = 71 + 92 + 51 + 165 = 379\)</span></li>
</ul>
<p>S2: What are the technical coefficients?</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>Sector</th>
<th style="text-align: center;">Agriculture</th>
<th style="text-align: center;">Manufacturing</th>
<th style="text-align: center;">Services</th>
<th style="text-align: center;">Final Consumer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Agriculture</td>
<td style="text-align: center;"><span class="math inline">\(a_{11}\)</span> = 0.209</td>
<td style="text-align: center;">0.238</td>
<td style="text-align: center;">0.404</td>
<td style="text-align: center;">0.328</td>
</tr>
<tr class="even">
<td>Manufacturing</td>
<td style="text-align: center;">0.273</td>
<td style="text-align: center;">0.286</td>
<td style="text-align: center;">0.203</td>
<td style="text-align: center;">0.252</td>
</tr>
<tr class="odd">
<td>Services</td>
<td style="text-align: center;">0.146</td>
<td style="text-align: center;">0.212</td>
<td style="text-align: center;">0.135</td>
<td style="text-align: center;">0.420</td>
</tr>
<tr class="even">
<td>Households</td>
<td style="text-align: center;">0.372</td>
<td style="text-align: center;">0.263</td>
<td style="text-align: center;">0.259</td>
<td style="text-align: center;">0.000</td>
</tr>
</tbody>
</table>
<p>This captures a snapshot of an economy. And could use to simulate changes in production and labor demand.</p>
<p>S3. How much would production change if the final consumer demand for Agriculture increases in 20%?</p>
<p><span class="math display">\[\Delta X = (I-A)^-1
\begin{pmatrix} 0.2 * 129 \\ 0 \\ 0 \end{pmatrix} =
\begin{pmatrix} 45.54 \\ 21.08 \\ 12.84 \end{pmatrix}
\]</span></p>
<p>S4: How much would labor demand change if the final consumer demand for Agriculture increases in 20%? <span class="math display">\[\Delta L_i = \lambda_i * \Delta X_i\]</span></p>
<p><span class="math inline">\(\Delta L_1 = 0.372 * 45.54 = 16.95 ; \Delta L_2 =  0.263 * 21.08 = 5.544 ; \Delta L_3 =  0.259 * 12.84 = 3.326\)</span></p>
</section>
<section id="example---stata" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="example---stata">Example - <code>Stata</code></h2>
<p><code>mata</code>: Input Data</p>
<div id="e687e1d2" class="cell larger" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">mata</span>: x  = (102, 103, 153 \ 133, 124, 77 \ 71, 92, 51)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">mata</span>: <span class="fu">y</span>  = (129 \ 99 \ 165)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">mata</span>: hh = ( 181 , 114 , 98)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Estimate Total Production</p>
<div id="6a81dca2" class="cell larger" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">mata</span>: tp = colsum(x):+hh ; tp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1     2     3
    +-------------------+
  1 |  487   433   379  |
    +-------------------+</code></pre>
</div>
</div>
<p>Estimate Technical Coefficients</p>
<div id="a29d3747" class="cell larger" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Technical Coefficients</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">mata</span>:ai = x:/tp ; ai</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 1             2             3
    +-------------------------------------------+
  1 |  .2094455852   .2378752887   .4036939314  |
  2 |   .273100616   .2863741339   .2031662269  |
  3 |  .1457905544   .2124711316   .1345646438  |
    +-------------------------------------------+</code></pre>
</div>
</div>
<p>Estimate Change in Demand: 20% increase in Agriculture</p>
<div id="c22e787d" class="cell larger" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Technical Coefficients</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="kw">mata</span>:dy = <span class="fu">y</span> :* (.2 \ 0 \ 0); dy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1
    +--------+
  1 |  25.8  |
  2 |     0  |
  3 |     0  |
    +--------+</code></pre>
</div>
</div>
<p>Estimate Change in Production</p>
<div id="4a160a34" class="cell larger" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Change in Production</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">mata</span>:dx = <span class="kw">qrinv</span>(<span class="fu">I</span>(3)-ai)*dy; dx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 1
    +---------------+
  1 |  45.54130481  |
  2 |  21.08637814  |
  3 |  12.84872246  |
    +---------------+</code></pre>
</div>
</div>
<p>Estimate Change in Labor Demand</p>
<div id="4bb354c1" class="cell larger" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">mata</span>:dl = (hh:/tp)':*dx; dl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 1
    +---------------+
  1 |   16.9260291  |
  2 |  5.551609949  |
  3 |  3.322360954  |
    +---------------+</code></pre>
</div>
</div>
</section>
</section>
<section id="sam-social-accounting-matrix" class="level1">
<h1>SAM: Social Accounting Matrix</h1>
<section id="sam-social-accounting-matrix-1" class="level2">
<h2 class="anchored" data-anchor-id="sam-social-accounting-matrix-1">SAM: Social Accounting Matrix</h2>
<ul>
<li><p>SAM can be thought as an upgraded version of IO-tables.</p></li>
<li><p>They are a way to organize information about the production structure of an economy, but also the distribution of resources.</p>
<ul>
<li>This it will not only register production of goods and services, but also transfers of resources between sectors and agents.</li>
</ul></li>
<li><p>You can also use it as basis for a plausible model of the economy.</p>
<ul>
<li>Prediction of changes in production, income and distribution.</li>
</ul></li>
</ul>
</section>
<section id="example-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1">Example</h2>
<table class="table">
<caption>Closed Economy No GoV SAM</caption>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Production</th>
<th style="text-align: center;">Consumption</th>
<th style="text-align: center;">Accumulation</th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Production</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(C\)</span></td>
<td style="text-align: center;"><span class="math inline">\(I\)</span></td>
<td style="text-align: center;"><span class="math inline">\(C+I\)</span></td>
</tr>
<tr class="even">
<td>Consumption</td>
<td style="text-align: center;"><span class="math inline">\(Y\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(Y\)</span></td>
</tr>
<tr class="odd">
<td>Accumulation</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(S\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(S\)</span></td>
</tr>
<tr class="even">
<td>Totals</td>
<td style="text-align: center;"><span class="math inline">\(Y\)</span></td>
<td style="text-align: center;"><span class="math inline">\(C+S\)</span></td>
<td style="text-align: center;"><span class="math inline">\(I\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<ul>
<li>Goods/services are Transfered from left to Top-right</li>
<li>Monetary Transfers are from Top-right to left</li>
</ul>
</section>
<section id="example-2" class="level2">
<h2 class="anchored" data-anchor-id="example-2">Example 2</h2>
<table class="table">
<caption>Open Economy with GoV SAM</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">S1</th>
<th style="text-align: center;">S2</th>
<th style="text-align: center;">S3</th>
<th style="text-align: center;">S4</th>
<th style="text-align: center;">S5</th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S1: Prod</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(C\)</span></td>
<td style="text-align: center;"><span class="math inline">\(G\)</span></td>
<td style="text-align: center;"><span class="math inline">\(I\)</span></td>
<td style="text-align: center;"><span class="math inline">\(E\)</span></td>
<td style="text-align: center;"><span class="math inline">\(C+G+I+E\)</span></td>
</tr>
<tr class="even">
<td>S2: HH</td>
<td style="text-align: center;"><span class="math inline">\(Y\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(Y\)</span></td>
</tr>
<tr class="odd">
<td>S3: Gov</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(Tx\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(Tx\)</span></td>
</tr>
<tr class="even">
<td>S4: K acc</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(S_h\)</span></td>
<td style="text-align: center;"><span class="math inline">\(S_g\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(S_f\)</span></td>
<td style="text-align: center;"><span class="math inline">\(S_h+S_g+S_f\)</span></td>
</tr>
<tr class="odd">
<td>S5: RofW</td>
<td style="text-align: center;"><span class="math inline">\(M\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(M\)</span></td>
</tr>
<tr class="even">
<td>Totals</td>
<td style="text-align: center;"><span class="math inline">\(Y+M\)</span></td>
<td style="text-align: center;"><span class="math inline">\(C+S_h+Tx\)</span></td>
<td style="text-align: center;"><span class="math inline">\(G+S_g\)</span></td>
<td style="text-align: center;"><span class="math inline">\(I\)</span></td>
<td style="text-align: center;"><span class="math inline">\(E+S_f\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>Here <span class="math inline">\(S1\)</span> and <span class="math inline">\(S2\)</span> is what we had in the IO table. Thus, we could further expand the SAM to include more sectors and agents.</p>
</section>
<section id="example-3" class="level2">
<h2 class="anchored" data-anchor-id="example-3">Example 3</h2>
<table class="table">
<caption>MoreDetailed SAM</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">S1</th>
<th style="text-align: center;">S2</th>
<th style="text-align: center;">S3</th>
<th style="text-align: center;">S4</th>
<th style="text-align: center;">S5</th>
<th style="text-align: center;">S6</th>
<th style="text-align: center;">S7</th>
<th style="text-align: center;">S8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S1: Act</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(Gds\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>S2: Commod</td>
<td style="text-align: center;"><span class="math inline">\(IntGds\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(C\)</span></td>
<td style="text-align: center;"><span class="math inline">\(G\)</span></td>
<td style="text-align: center;"><span class="math inline">\(I\)</span></td>
<td style="text-align: center;"><span class="math inline">\(E\)</span></td>
</tr>
<tr class="odd">
<td>S3: Factors</td>
<td style="text-align: center;"><span class="math inline">\(VA\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(FE\)</span></td>
</tr>
<tr class="even">
<td>S4: Enter</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(Prof\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(ETr\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>S5: HH</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(Wage\)</span></td>
<td style="text-align: center;"><span class="math inline">\(DProf\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(Tr\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(REM\)</span></td>
</tr>
<tr class="even">
<td>S6: Gov</td>
<td style="text-align: center;"><span class="math inline">\(ITx\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(FTx\)</span></td>
<td style="text-align: center;"><span class="math inline">\(ETx\)</span></td>
<td style="text-align: center;"><span class="math inline">\(DTx\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(Tarf\)</span></td>
</tr>
<tr class="odd">
<td>S7: K acc</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(RetY\)</span></td>
<td style="text-align: center;"><span class="math inline">\(S_h\)</span></td>
<td style="text-align: center;"><span class="math inline">\(S_g\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(KTrM\)</span></td>
</tr>
<tr class="even">
<td>S8: RofW</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(M\)</span></td>
<td style="text-align: center;"><span class="math inline">\(FM\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(REMA\)</span></td>
<td style="text-align: center;"><span class="math inline">\(TrA\)</span></td>
<td style="text-align: center;"><span class="math inline">\(KtrA\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</section>
<section id="other-extensions" class="level2">
<h2 class="anchored" data-anchor-id="other-extensions">Other Extensions</h2>
<ul>
<li>SAM also allow you to do further extensions to include more agents (heterogenous)
<ul>
<li>Green-Industry</li>
<li>Informal Sector</li>
<li>Households by income level</li>
<li>etc.</li>
</ul></li>
</ul>
</section>
</section>
<section id="thats-all-folks" class="level1">
<h1>Thats all folks!</h1>
<section id="what-to-get-from-today" class="level2">
<h2 class="anchored" data-anchor-id="what-to-get-from-today">What to get from today?</h2>
<ul>
<li>How to use weights in Stata to account for survey design, and how to obtain summary statistics.</li>
<li>How to test differences in means across groups.</li>
<li>How to use IO tables to simulate changes in production and labor demand.</li>
<li>Understand how SAM can be used to represent an Economy</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>