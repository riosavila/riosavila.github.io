<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Fernando Rios-Avila">
<meta name="dcterms.date" content="2024-10-10">

<title>Time series data – Econometrics MSC Levy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>



<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Econometrics MSC Levy</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Time series data</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Courses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../adv_class/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advance Econometrics: Causal Effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../rmethods/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Methods: Econometrics I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../rmethods2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Methods II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../rm-data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Methods I: Data Analysis for Economics and Policy</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Math Refresher</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mathref/math_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Math Refresher</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mathref/math_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Math Refresher</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mathref/math_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Math Refresher</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation">Motivation</a></li>
  <li><a href="#what-is-special-in-the-analysis-of-time-series-data" id="toc-what-is-special-in-the-analysis-of-time-series-data" class="nav-link" data-scroll-target="#what-is-special-in-the-analysis-of-time-series-data">What is special in the analysis of time series data?</a>
  <ul class="collapse">
  <li><a href="#different" id="toc-different" class="nav-link" data-scroll-target="#different">Different</a></li>
  <li><a href="#with-other-features" id="toc-with-other-features" class="nav-link" data-scroll-target="#with-other-features">With other features</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data preparation</a></li>
  <li><a href="#consequences" id="toc-consequences" class="nav-link" data-scroll-target="#consequences">Consequences</a></li>
  <li><a href="#what-is-not-special-in-time-series" id="toc-what-is-not-special-in-time-series" class="nav-link" data-scroll-target="#what-is-not-special-in-time-series">What is not special in time series</a></li>
  <li><a href="#what-is-special-in-time-series" id="toc-what-is-special-in-time-series" class="nav-link" data-scroll-target="#what-is-special-in-time-series">What is special in time series</a></li>
  <li><a href="#properties" id="toc-properties" class="nav-link" data-scroll-target="#properties">Properties</a>
  <ul class="collapse">
  <li><a href="#ts-variables-may-have-trends-trends" id="toc-ts-variables-may-have-trends-trends" class="nav-link" data-scroll-target="#ts-variables-may-have-trends-trends">TS Variables may have trends Trends</a></li>
  <li><a href="#but-they-may-also-show-seasonality" id="toc-but-they-may-also-show-seasonality" class="nav-link" data-scroll-target="#but-they-may-also-show-seasonality">But they may also show Seasonality</a></li>
  <li><a href="#what-is-special-in-time-series-stationarity" id="toc-what-is-special-in-time-series-stationarity" class="nav-link" data-scroll-target="#what-is-special-in-time-series-stationarity">What is special in time series: Stationarity</a></li>
  <li><a href="#what-is-special-in-time-series-non-stationarity" id="toc-what-is-special-in-time-series-non-stationarity" class="nav-link" data-scroll-target="#what-is-special-in-time-series-non-stationarity">What is special in time series: Non-stationarity</a></li>
  <li><a href="#a-special-case-random-walk" id="toc-a-special-case-random-walk" class="nav-link" data-scroll-target="#a-special-case-random-walk">A Special case: Random walk</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#what-to-fear-of-random-walk" id="toc-what-to-fear-of-random-walk" class="nav-link" data-scroll-target="#what-to-fear-of-random-walk">What to fear of Random walk</a></li>
  <li><a href="#how-to-detect-it-unit-root-test" id="toc-how-to-detect-it-unit-root-test" class="nav-link" data-scroll-target="#how-to-detect-it-unit-root-test">How to detect it: Unit root test</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#time-series-summary" id="toc-time-series-summary" class="nav-link" data-scroll-target="#time-series-summary">Time Series: Summary</a></li>
  <li><a href="#what-to-do-with-ts-cook-book" id="toc-what-to-do-with-ts-cook-book" class="nav-link" data-scroll-target="#what-to-do-with-ts-cook-book">What to do With TS: Cook-book</a></li>
  </ul></li>
  <li><a href="#case-study-a-stocks" id="toc-case-study-a-stocks" class="nav-link" data-scroll-target="#case-study-a-stocks">Case study A: stocks</a>
  <ul class="collapse">
  <li><a href="#microsoft-and-sp-500-stock-prices---data" id="toc-microsoft-and-sp-500-stock-prices---data" class="nav-link" data-scroll-target="#microsoft-and-sp-500-stock-prices---data">Microsoft and S&amp;P 500 stock prices - data</a></li>
  <li><a href="#case-study-stock-price-and-stock-market-index-value" id="toc-case-study-stock-price-and-stock-market-index-value" class="nav-link" data-scroll-target="#case-study-stock-price-and-stock-market-index-value">Case study: Stock price and stock market index value</a></li>
  <li><a href="#time-series-comparisons---sp-500-case-study" id="toc-time-series-comparisons---sp-500-case-study" class="nav-link" data-scroll-target="#time-series-comparisons---sp-500-case-study">Time series comparisons - S&amp;P 500 case study</a></li>
  <li><a href="#microsoft-and-sp-500-stock-prices---ts-plot" id="toc-microsoft-and-sp-500-stock-prices---ts-plot" class="nav-link" data-scroll-target="#microsoft-and-sp-500-stock-prices---ts-plot">Microsoft and S&amp;P 500 stock prices - ts plot</a></li>
  <li><a href="#microsoft-and-sp-500-stock-prices---decisions-2" id="toc-microsoft-and-sp-500-stock-prices---decisions-2" class="nav-link" data-scroll-target="#microsoft-and-sp-500-stock-prices---decisions-2">Microsoft and S&amp;P 500 stock prices - decisions 2</a></li>
  <li><a href="#microsoft-and-sp-500---index-returns-pct" id="toc-microsoft-and-sp-500---index-returns-pct" class="nav-link" data-scroll-target="#microsoft-and-sp-500---index-returns-pct">Microsoft and S&amp;P 500 - index returns (pct)</a></li>
  <li><a href="#unit-root-test-microsoft-and-sp-500-returns" id="toc-unit-root-test-microsoft-and-sp-500-returns" class="nav-link" data-scroll-target="#unit-root-test-microsoft-and-sp-500-returns">Unit root test: Microsoft and S&amp;P 500 returns</a></li>
  </ul></li>
  <li><a href="#regression-with-time-series" id="toc-regression-with-time-series" class="nav-link" data-scroll-target="#regression-with-time-series">Regression with time series</a>
  <ul class="collapse">
  <li><a href="#time-series-regressions-the-same" id="toc-time-series-regressions-the-same" class="nav-link" data-scroll-target="#time-series-regressions-the-same">Time series regressions: The same</a></li>
  <li><a href="#time-series-regression-but-different" id="toc-time-series-regression-but-different" class="nav-link" data-scroll-target="#time-series-regression-but-different">Time series regression: But different</a></li>
  <li><a href="#time-series-regression-growth" id="toc-time-series-regression-growth" class="nav-link" data-scroll-target="#time-series-regression-growth">Time series regression: Growth</a></li>
  <li><a href="#returns-on-a-company-stock-and-market-returns" id="toc-returns-on-a-company-stock-and-market-returns" class="nav-link" data-scroll-target="#returns-on-a-company-stock-and-market-returns">Returns on a company stock and market returns</a></li>
  <li><a href="#issues-to-deal-with-before-regression-a-laundry-list" id="toc-issues-to-deal-with-before-regression-a-laundry-list" class="nav-link" data-scroll-target="#issues-to-deal-with-before-regression-a-laundry-list">Issues to deal with, before Regression: a laundry list</a></li>
  <li><a href="#trend-rw---spurious-regression" id="toc-trend-rw---spurious-regression" class="nav-link" data-scroll-target="#trend-rw---spurious-regression">Trend &amp; RW - Spurious regression</a></li>
  <li><a href="#time-series-regressions-trends-and-seasonality" id="toc-time-series-regressions-trends-and-seasonality" class="nav-link" data-scroll-target="#time-series-regressions-trends-and-seasonality">Time series regressions: Trends and seasonality</a></li>
  <li><a href="#time-series-regressions-trends-and-seasonality-1" id="toc-time-series-regressions-trends-and-seasonality-1" class="nav-link" data-scroll-target="#time-series-regressions-trends-and-seasonality-1">Time series regressions: Trends and seasonality</a></li>
  <li><a href="#trend-rw---solution-first-differences" id="toc-trend-rw---solution-first-differences" class="nav-link" data-scroll-target="#trend-rw---solution-first-differences">Trend &amp; RW - solution: first differences</a></li>
  <li><a href="#seasonality-in-time-series-regressions" id="toc-seasonality-in-time-series-regressions" class="nav-link" data-scroll-target="#seasonality-in-time-series-regressions">Seasonality in time series regressions</a></li>
  <li><a href="#another-problem-serial-correlation" id="toc-another-problem-serial-correlation" class="nav-link" data-scroll-target="#another-problem-serial-correlation">Another Problem: Serial correlation</a></li>
  <li><a href="#standard-errors-in-time-series-regressions" id="toc-standard-errors-in-time-series-regressions" class="nav-link" data-scroll-target="#standard-errors-in-time-series-regressions">Standard errors in time series regressions</a></li>
  </ul></li>
  <li><a href="#case-study-b-electricity-consumption-and-temperature" id="toc-case-study-b-electricity-consumption-and-temperature" class="nav-link" data-scroll-target="#case-study-b-electricity-consumption-and-temperature">Case study B: Electricity consumption and temperature</a>
  <ul class="collapse">
  <li><a href="#electricity-consumption-and-temperature" id="toc-electricity-consumption-and-temperature" class="nav-link" data-scroll-target="#electricity-consumption-and-temperature">Electricity consumption and temperature</a></li>
  <li><a href="#cs-modelling-decisions" id="toc-cs-modelling-decisions" class="nav-link" data-scroll-target="#cs-modelling-decisions">CS: Modelling decisions</a></li>
  <li><a href="#model-estimates" id="toc-model-estimates" class="nav-link" data-scroll-target="#model-estimates">Model estimates</a></li>
  <li><a href="#model-results" id="toc-model-results" class="nav-link" data-scroll-target="#model-results">Model results</a></li>
  <li><a href="#electricity-consumption-and-temperature-different-se-estimates" id="toc-electricity-consumption-and-temperature-different-se-estimates" class="nav-link" data-scroll-target="#electricity-consumption-and-temperature-different-se-estimates">Electricity consumption and temperature – different SE estimates</a></li>
  <li><a href="#electricity-consumption-and-temperature-different-se-estimates-1" id="toc-electricity-consumption-and-temperature-different-se-estimates-1" class="nav-link" data-scroll-target="#electricity-consumption-and-temperature-different-se-estimates-1">Electricity consumption and temperature – different SE estimates</a></li>
  </ul></li>
  <li><a href="#propagation-effect" id="toc-propagation-effect" class="nav-link" data-scroll-target="#propagation-effect">Propagation effect</a>
  <ul class="collapse">
  <li><a href="#propagation-effect-changes-and-lags---fdl-model" id="toc-propagation-effect-changes-and-lags---fdl-model" class="nav-link" data-scroll-target="#propagation-effect-changes-and-lags---fdl-model">Propagation effect: changes and lags - FDL model</a></li>
  <li><a href="#testing-the-cumulative-effect" id="toc-testing-the-cumulative-effect" class="nav-link" data-scroll-target="#testing-the-cumulative-effect">Testing the cumulative effect</a></li>
  <li><a href="#propagation-effect-changes-and-lags---fdl-model-1" id="toc-propagation-effect-changes-and-lags---fdl-model-1" class="nav-link" data-scroll-target="#propagation-effect-changes-and-lags---fdl-model-1">Propagation effect: changes and lags - FDL model</a></li>
  <li><a href="#summary-of-the-process" id="toc-summary-of-the-process" class="nav-link" data-scroll-target="#summary-of-the-process">Summary of the process</a></li>
  <li><a href="#main-takeaways" id="toc-main-takeaways" class="nav-link" data-scroll-target="#main-takeaways">Main takeaways</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="week09.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Time series data</h1>
<p class="subtitle lead">The past, the present, and the future</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Fernando Rios-Avila </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Levy Economics Institute
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 10, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="motivation" class="level2">
<h2 class="anchored" data-anchor-id="motivation">Motivation</h2>
<ul>
<li><p>You are considering investing in a company stock, and you want to know how risky that investment is. You have downloaded data on daily stock prices for many years. How should you define returns? How should you assess whether and to what extent returns on the company stock move together with market returns?</p></li>
<li><p>Heating and cooling are important uses of electricity. How does weather conditions affect electricity consumption? We are going to use monthly data on temperature and residential electricity consumption in Arizona. How to formulate a model which captures these factors?</p></li>
</ul>
</section>
<section id="what-is-special-in-the-analysis-of-time-series-data" class="level2">
<h2 class="anchored" data-anchor-id="what-is-special-in-the-analysis-of-time-series-data">What is special in the analysis of time series data?</h2>
<div class="fragment">
<section id="different" class="level3">
<h3 class="anchored" data-anchor-id="different">Different</h3>
<ul>
<li>We have time series data if we observe one unit across many time periods.</li>
<li>There is a special notation: <span class="math inline">\(y_t\)</span>, <span class="math inline">\(t = 1, 2, \ldots, T\)</span></li>
<li>Time series data presents additional opportunities as well as additional challenges to compare variables.</li>
</ul>
</section>
</div>
<div class="fragment">
<section id="with-other-features" class="level3">
<h3 class="anchored" data-anchor-id="with-other-features">With other features</h3>
<ul>
<li>Data wrangling novelties: frequency and aggregation</li>
<li>Special nature of time series: serial correlation</li>
<li>Coefficient interpretation.</li>
</ul>
</section>
</div>
</section>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data preparation</h2>
<ul>
<li>What is <strong>Frequency</strong>? of time series? = time elapsed between two observations of a variable</li>
<li>Practical problems with frequency:
<ul>
<li>Not all data is captured at the same frequency</li>
<li>There may be regular/irregular gaps between them: e.g.&nbsp;weekends for stock-exchange</li>
<li>Two variables have different frequencies</li>
<li>Extreme values (spikes) in your variable</li>
</ul></li>
<li>Last but not least: in Stata you need to Declare your data as time series data with <code>tsset</code> command</li>
</ul>
</section>
<section id="consequences" class="level2">
<h2 class="anchored" data-anchor-id="consequences">Consequences</h2>
<ul>
<li><p><strong>Regressions</strong>: to condition <span class="math inline">\(y_t\)</span> on values of <span class="math inline">\(x_t\)</span> the two variables need to be on the same frequency. Otherwise, we need to adjust one of them.</p></li>
<li><p>How to adjust? Aggregation!</p>
<ul>
<li>Flow variables: sum up the values within the interval. e.g.&nbsp;daily sales <span class="math inline">\(\rightarrow\)</span> weakly sales is the sum of daily sales.</li>
<li>Stock variables: take the end-period value. e.g.&nbsp;daily stock prices uses the closing price on a given day</li>
<li>Other kinds of variables: usually take the average value</li>
</ul></li>
</ul>
</section>
<section id="what-is-not-special-in-time-series" class="level2">
<h2 class="anchored" data-anchor-id="what-is-not-special-in-time-series">What is not special in time series</h2>
<ul>
<li><p>Time series regressions are special for several reasons…but many aspects remain the same</p>
<ul>
<li>Generalization, confidence intervals: Same difficulties as in cross-section</li>
<li>Time series regression uncover patterns rather than evidence of causality: There is no “sample of time”</li>
<li>Practical data issues, missing observations, extreme values etc, remain</li>
<li>Coefficient interpretation is based on conditional comparison</li>
</ul></li>
</ul>
</section>
<section id="what-is-special-in-time-series" class="level2">
<h2 class="anchored" data-anchor-id="what-is-special-in-time-series">What is special in time series</h2>
<ul>
<li>Ordering matters - key difference to cross section. Complications…Past before future</li>
<li>Trend - variables tend to have trends! Increasing or decreasing values over time</li>
<li>Seasonality - variables may show some cyclical component, such 4 seasons, months, - every e.g.&nbsp;December value is expected to be different.</li>
<li>Time series values are often not independent - correlated in time
<ul>
<li>Failure to account for this may lead to wrong (biased) conclusions</li>
</ul></li>
</ul>
</section>
<section id="properties" class="level1">
<h1>Properties</h1>
<section id="ts-variables-may-have-trends-trends" class="level2">
<h2 class="anchored" data-anchor-id="ts-variables-may-have-trends-trends">TS Variables may have trends Trends</h2>
<ul>
<li><p>Time series data “tends” to have trends. how to detect them?.</p></li>
<li><p>Define change (or fist difference): <span class="math inline">\(\Delta y_t = y_t - y_{t-1}\)</span></p></li>
</ul>
<p><span class="math display">\[
\begin{align}
\text{Positive trend}: &amp; E[\Delta y_t] &gt; 0 \\
\text{Negative trend}: &amp; E[\Delta y_t] &lt; 0
\end{align}
\]</span></p>
<ul>
<li>One may also consider two types of trends: linear and exponential</li>
</ul>
<p><span class="math display">\[
\begin{align}
\text{Linear trend}: &amp; E[\Delta y_t] = \text{constant} \\
\text{Exponential trend}: &amp; E[\Delta \ln(y_t)] = \text{constant}
\end{align}
\]</span></p>
<ul>
<li>Exponential trend, Changes are proportional</li>
</ul>
</section>
<section id="but-they-may-also-show-seasonality" class="level2">
<h2 class="anchored" data-anchor-id="but-they-may-also-show-seasonality">But they may also show Seasonality</h2>
<ul>
<li>There is seasonal variation, or <strong><em>seasonality</em></strong>, if its expected value changes periodically.
<ul>
<li>Follows the seasons of the year, days of the week, hours of the day.</li>
</ul></li>
<li>Seasonality may be linear, when the seasonal differences are constant; it may be exponential, if relative differences (that may be approximated by log differences) are constant.</li>
<li>Important real life phenomenon - many economic activities follow seasonal variation over the year, through the week or day.
<ul>
<li>Thus they need to be accounted for in the analysis.</li>
</ul></li>
</ul>
</section>
<section id="what-is-special-in-time-series-stationarity" class="level2">
<h2 class="anchored" data-anchor-id="what-is-special-in-time-series-stationarity">What is special in time series: Stationarity</h2>
<blockquote class="blockquote">
<p>To learn something, we need consistency in patterns If the patterns change constantly, we cannot learn anything from the data</p>
</blockquote>
<div class="fragment">
<ul>
<li>Stationary time series have the same expected value and same distribution, at all times.</li>
<li>Stationarity is a feature of the time series itself.</li>
<li>Stationarity means stability (in expectations).</li>
<li>If series are stationary, we can learn from them!</li>
</ul>
</div>
</section>
<section id="what-is-special-in-time-series-non-stationarity" class="level2">
<h2 class="anchored" data-anchor-id="what-is-special-in-time-series-non-stationarity">What is special in time series: Non-stationarity</h2>
<blockquote class="blockquote">
<p>In absence of stationarity, we cannot learn anything from the data Or what we learn may be misleading</p>
</blockquote>
<div class="fragment">
<ul>
<li>Non-stationary time series are those that are not stable for some reason.</li>
<li>Series that violate stationarity because the expected value is different at different times:
<ul>
<li>Has a trends</li>
<li>Has seasonality</li>
<li>Has some unstable patterns</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Although, some of this issues can be address by “controlling” for them in the regression.</li>
</ul>
</div>
</section>
<section id="a-special-case-random-walk" class="level2">
<h2 class="anchored" data-anchor-id="a-special-case-random-walk">A Special case: Random walk</h2>
<p>Some non-stationary variables are not easy to deal with:</p>
<div class="fragment">
<ul>
<li>Another example of non-stationary time series is the <strong>random walk</strong>.</li>
<li>Random walk when <span class="math inline">\(y_t\)</span> follows a random walk if its value in <span class="math inline">\(t\)</span> is the same as in <span class="math inline">\((t - 1)\)</span> plus some random term: <span class="math inline">\(y_t = y_{t-1} + e_t\)</span>.</li>
<li>Time series variables that follow random walk change in completely random ways.</li>
<li>Whatever the previous change was the next one may be anything. Wherever it starts, a random walk variable may end up anywhere after a long time.</li>
</ul>
</div>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<div id="05dcb67e" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span>: {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">clear</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="dv">scheme</span> white2</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>color_style bay</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span>:<span class="kw">set</span> <span class="kw">obs</span> 101</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> <span class="fu">r</span> = runiform(0,2*<span class="dt">_pi</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> <span class="fu">y</span> = 0 </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> x = 0</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> <span class="fu">y</span> = <span class="fu">y</span>[<span class="dt">_n</span>-1] + <span class="fu">sin</span>(<span class="fu">r</span>) <span class="kw">if</span> <span class="dt">_n</span>&gt;1</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> x = x[<span class="dt">_n</span>-1] + <span class="fu">cos</span>(<span class="fu">r</span>) <span class="kw">if</span> <span class="dt">_n</span>&gt;1</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> n = <span class="dt">_n</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>*<span class="kw">scatter</span>  <span class="fu">y</span> x , <span class="kw">connect</span>(<span class="ot">l</span>) <span class="bn">name</span>(m1, <span class="kw">replace</span>) </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>*<span class="kw">line</span> <span class="fu">y</span> x n, <span class="bn">name</span>(m2, <span class="kw">replace</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<style>div.jp-Notebook .datagrid-container {min-height: 448px; }</style>
</div>
</div>
<div>

</div>
<div id="7bb12b0e" class="cell quarto-layout-panel" data-execution_count="2" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="week09_files/figure-revealjs/cell-3-output-1.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="week09_files/figure-revealjs/cell-3-output-2.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="what-to-fear-of-random-walk" class="level2">
<h2 class="anchored" data-anchor-id="what-to-fear-of-random-walk">What to fear of Random walk</h2>
<div class="fragment">
<ul>
<li>Random walks are impossible to predict</li>
<li>after a change, they don’t revert back to some value or trend line but continue their journey from that point.</li>
<li>Spread rising from one interval to another</li>
<li>Why is this important?</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>To identify patterns, we need stationarity</li>
<li>For stationary series, we need stability of patterns</li>
<li>Avoid series with random walk when running regressions
<ul>
<li>Using them would only cause problems of Spurious Regressions</li>
</ul></li>
</ul>
</div>
</section>
<section id="how-to-detect-it-unit-root-test" class="level2">
<h2 class="anchored" data-anchor-id="how-to-detect-it-unit-root-test">How to detect it: Unit root test</h2>
<div class="fragment">
<ul>
<li><p>We can test if a series is a random walk.</p></li>
<li><p>Phillips-Perron test is based on this model: <span class="math display">\[y_t = \alpha + \rho y_{t-1} + e_t\]</span></p></li>
<li><p>This model represents a random walk if <span class="math inline">\(\rho = 1\)</span>, which is also called a unit root</p></li>
<li><p>Random walk test = testing if the series has a unit root.</p></li>
<li><p>The Phillips-Perron test has hypothesis</p></li>
</ul>
<p><span class="math display">\[H_0: \rho = 1 \text{ vs } H_A: \rho &lt; 1\]</span></p>
</div>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
<ul>
<li><p>This test does not follow the usual t-distribution. Has its own distribution.</p></li>
<li><p>in Stata, you can use it with the <code>pperron</code> command. (see <code>helpfile</code>)</p></li>
<li><p>When the p-value is large (e.g., larger than 0.05), we don’t reject the null, concluding that the time series variable follows a random walk</p></li>
<li><p>Many versions of unit root test.</p>
<ul>
<li>(Augmented) Dicky Fuller test is another popular one.</li>
</ul></li>
</ul>
<p><span class="math display">\[\Delta y_t = \alpha + \delta y_{t-1} + e_t\]</span></p>
<ul>
<li><span class="math inline">\(H_0: \delta = 0\)</span> vs <span class="math inline">\(H_A: \delta &lt; 0\)</span></li>
<li>Tests usually agree, but not always. see <code>dfuller</code></li>
</ul>
</section>
<section id="time-series-summary" class="level2">
<h2 class="anchored" data-anchor-id="time-series-summary">Time Series: Summary</h2>
<ul>
<li>Stationary series are those where the <strong>expected</strong> value, <strong>variance</strong>, and <strong>auto-correlation</strong> does not change.</li>
<li>Examples of non–stationarity:
<ul>
<li><strong>Trend</strong> - Expected value is different in later time periods than in earlier time periods</li>
<li><strong>Seasonality</strong> - Expected value is different in periodically recurring time periods</li>
<li><strong>Random walk</strong> – Variance keeps increasing over time
<ul>
<li>This is the one we need to avoid</li>
</ul></li>
</ul></li>
<li><strong>Why care?</strong> Regression with time series data variables that are not stationary are likely to give misleading results (Spurious).</li>
</ul>
</section>
<section id="what-to-do-with-ts-cook-book" class="level2">
<h2 class="anchored" data-anchor-id="what-to-do-with-ts-cook-book">What to do With TS: Cook-book</h2>
<div class="fragment">
<ul>
<li>Check if your variable is stationary
<ul>
<li>Visualize</li>
<li>Do a unit-root test</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>If there is a good reason to believe your variable trending (or is Random Walk)
<ul>
<li>Take differences <span class="math inline">\(\Delta y_t\)</span>, or add a trend variable</li>
<li>Take percentage changes or log differences
<ul>
<li>In extremely rare cases, difference your variable twice</li>
</ul></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>If your variable has a seasonality
<ul>
<li>Use seasonality dummies in your regression</li>
<li>May consider to work with seasonal changes.</li>
</ul></li>
</ul>
</div>
</section>
</section>
<section id="case-study-a-stocks" class="level1">
<h1>Case study A: stocks</h1>
<section id="microsoft-and-sp-500-stock-prices---data" class="level2">
<h2 class="anchored" data-anchor-id="microsoft-and-sp-500-stock-prices---data">Microsoft and S&amp;P 500 stock prices - data</h2>
<ul>
<li>Daily price of Microsoft stock and value of S&amp;P 500 stock market index</li>
<li>The data covers 21 years starting with December 31 1997 and ending with December 31 2018.</li>
<li>Many decisions to make…</li>
<li>Look at data first</li>
</ul>
</section>
<section id="case-study-stock-price-and-stock-market-index-value" class="level2">
<h2 class="anchored" data-anchor-id="case-study-stock-price-and-stock-market-index-value">Case study: Stock price and stock market index value</h2>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">"data_slides/stock-prices-daily.dta"</span>, <span class="kw">clear</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ren</span> *, low</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">line</span> p_sp500 <span class="fu">date</span>, <span class="bn">name</span>(m1, <span class="kw">replace</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="kw">line</span> p_msft <span class="fu">date</span>, <span class="bn">name</span>(m2, <span class="kw">replace</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="11f69657" class="cell quarto-layout-panel" data-execution_count="3" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week09_files/figure-revealjs/cell-4-output-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week09_files/figure-revealjs/cell-4-output-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="time-series-comparisons---sp-500-case-study" class="level2">
<h2 class="anchored" data-anchor-id="time-series-comparisons---sp-500-case-study">Time series comparisons - S&amp;P 500 case study</h2>
<p>Key decisions:</p>
<ul>
<li>Daily price = closing price</li>
<li>Gaps will be overlooked
<ul>
<li>Friday-Monday gap ignored</li>
<li>Holidays (Christmas, 4 of July (when would be a weekday)</li>
</ul></li>
<li>All values kept, extreme values part of process</li>
<li>In finance, portfolio managers often focus on monthly returns, Hence we choose monthly returns to analyze.</li>
<li>Take the last day of each month</li>
</ul>
</section>
<section id="microsoft-and-sp-500-stock-prices---ts-plot" class="level2">
<h2 class="anchored" data-anchor-id="microsoft-and-sp-500-stock-prices---ts-plot">Microsoft and S&amp;P 500 stock prices - ts plot</h2>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span> {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">"data_slides/stock-prices-daily.dta"</span>, <span class="kw">clear</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ren</span> *, low</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">sort</span> <span class="fu">ym</span> <span class="fu">date</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">bysort</span> <span class="fu">ym</span>: <span class="kw">gen</span> flag = <span class="dt">_n</span> == _N</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">keep</span> <span class="kw">if</span> flag==1</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">line</span> p_sp500 <span class="fu">ym</span>, <span class="bn">name</span>(m1, <span class="kw">replace</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="kw">line</span> p_msft <span class="fu">ym</span>, <span class="bn">name</span>(m2, <span class="kw">replace</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="3b9b9e10" class="cell quarto-layout-panel" data-execution_count="4" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week09_files/figure-revealjs/cell-5-output-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week09_files/figure-revealjs/cell-5-output-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="microsoft-and-sp-500-stock-prices---decisions-2" class="level2">
<h2 class="anchored" data-anchor-id="microsoft-and-sp-500-stock-prices---decisions-2">Microsoft and S&amp;P 500 stock prices - decisions 2</h2>
<ul>
<li>Monthly time series plot - easier to read</li>
<li>Additional decision needed: it is obviously non-stationary (Phillips-Perron test: very high p-value)</li>
<li>Use returns:
<ul>
<li>Returns: percent change of the closing prices: <span class="math inline">\(100\% \frac{y_t - y_{t-1}}{y_t}\)</span>.</li>
<li>monthly returns - take the closing price for the last day of a month</li>
<li>Alternative measure: first difference of log prices.</li>
</ul></li>
</ul>
</section>
<section id="microsoft-and-sp-500---index-returns-pct" class="level2">
<h2 class="anchored" data-anchor-id="microsoft-and-sp-500---index-returns-pct">Microsoft and S&amp;P 500 - index returns (pct)</h2>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span>: {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="st">"data_slides/stock-prices-daily.dta"</span>, <span class="kw">clear</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">ren</span> *, low</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">sort</span> <span class="fu">ym</span> <span class="fu">date</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">bysort</span> <span class="fu">ym</span>: <span class="kw">gen</span> flag = <span class="dt">_n</span> == _N</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="kw">keep</span> <span class="kw">if</span> flag==1</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="kw">tsset</span> <span class="fu">ym</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> ret_sp500 = 100 * (p_sp500 - p_sp500[<span class="dt">_n</span>-1]) / p_sp500[<span class="dt">_n</span>-1]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> ret_msft = 100 * (p_msft - p_msft[<span class="dt">_n</span>-1]) / p_msft[<span class="dt">_n</span>-1]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="kw">line</span> ret_sp500 <span class="fu">ym</span>, <span class="bn">name</span>(m1, <span class="kw">replace</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="kw">line</span> ret_msft <span class="fu">ym</span>, <span class="bn">name</span>(m2, <span class="kw">replace</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="48b82e26" class="cell quarto-layout-panel" data-execution_count="5" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week09_files/figure-revealjs/cell-6-output-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week09_files/figure-revealjs/cell-6-output-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="unit-root-test-microsoft-and-sp-500-returns" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="unit-root-test-microsoft-and-sp-500-returns">Unit root test: Microsoft and S&amp;P 500 returns</h2>
<div id="75012fa0" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">pperron</span> ret_sp500</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">pperron</span> ret_msft</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Phillips–Perron test for unit root       Number of obs   = 251
Variable: ret_sp500                      Newey–West lags =   4

H0: Random walk without drift, d = 0

                                       Dickey–Fuller
                   Test      -------- critical value ---------
              statistic           1%           5%          10%
--------------------------------------------------------------
 Z(rho)        -230.845      -20.301      -14.000      -11.200
 Z(t)           -14.365       -3.460       -2.880       -2.570
--------------------------------------------------------------
MacKinnon approximate p-value for Z(t) = 0.0000.

Phillips–Perron test for unit root       Number of obs   = 251
Variable: ret_msft                       Newey–West lags =   4

H0: Random walk without drift, d = 0

                                       Dickey–Fuller
                   Test      -------- critical value ---------
              statistic           1%           5%          10%
--------------------------------------------------------------
 Z(rho)        -284.851      -20.301      -14.000      -11.200
 Z(t)           -19.346       -3.460       -2.880       -2.570
--------------------------------------------------------------
MacKinnon approximate p-value for Z(t) = 0.0000.</code></pre>
</div>
</div>
</section>
</section>
<section id="regression-with-time-series" class="level1">
<h1>Regression with time series</h1>
<section id="time-series-regressions-the-same" class="level2">
<h2 class="anchored" data-anchor-id="time-series-regressions-the-same">Time series regressions: The same</h2>
<ul>
<li>Regression in time series data is defined and estimated the same way as in other data.</li>
</ul>
<p><span class="math display">\[y^E_t = \beta_0 + \beta_1 x_{1t} + \beta_2 x_{2t} + \ldots\]</span></p>
<ul>
<li>Interpretations similar to cross-section
<ul>
<li><span class="math inline">\(\beta_0\)</span>: We expect <span class="math inline">\(y\)</span> to be <span class="math inline">\(\beta_0\)</span> when all explanatory variables are zero.</li>
<li><span class="math inline">\(\beta_1\)</span>: Comparing time periods with different <span class="math inline">\(x_1\)</span> but the same in terms of all other explanatory variables, we expect <span class="math inline">\(y\)</span> to be higher by <span class="math inline">\(\beta_1\)</span> when <span class="math inline">\(x_1\)</span> is higher by one unit.</li>
</ul></li>
</ul>
</section>
<section id="time-series-regression-but-different" class="level2">
<h2 class="anchored" data-anchor-id="time-series-regression-but-different">Time series regression: But different</h2>
<ul>
<li>With time series data, we often estimate regressions in <strong>changes</strong></li>
<li>We use the <span class="math inline">\(\Delta\)</span> notation for changes</li>
</ul>
<p><span class="math display">\[\Delta x_t = x_t - x_{t-1}\]</span></p>
<ul>
<li><p>The regression in changes is <span class="math display">\[\Delta y^E_t = \alpha + \beta \Delta x_t\]</span></p>
<ul>
<li><span class="math inline">\(\alpha\)</span>: <span class="math inline">\(y\)</span> is expected to change by <span class="math inline">\(\alpha\)</span> when <span class="math inline">\(x\)</span> doesn’t change</li>
<li><span class="math inline">\(\beta\)</span>: <span class="math inline">\(y\)</span> is expected to change by <span class="math inline">\(\beta\)</span> more when <span class="math inline">\(x\)</span> increases by one unit more</li>
</ul></li>
</ul>
</section>
<section id="time-series-regression-growth" class="level2">
<h2 class="anchored" data-anchor-id="time-series-regression-growth">Time series regression: Growth</h2>
<ul>
<li>We often have variables in relative or percentage changes,</li>
</ul>
<p><span class="math display">\[\%\Delta  (y_t)^E = \alpha + \beta \%\Delta(x_t)\]</span></p>
<ul>
<li>We can approximate relative differences by log differences, which are here log change: first taking logs of the variables and then taking the first difference</li>
</ul>
<p><span class="math display">\[\Delta \ln(y_t) = \ln(y_t) - \ln(y_{t1})\]</span></p>
</section>
<section id="returns-on-a-company-stock-and-market-returns" class="level2">
<h2 class="anchored" data-anchor-id="returns-on-a-company-stock-and-market-returns">Returns on a company stock and market returns</h2>
<p><span class="math display">\[\%\Delta(\text{MSFT}_t) = \alpha + \beta \%\Delta (\text{SP500}_t)\]</span></p>
<ul>
<li><span class="math inline">\(\alpha = 0.54\)</span>; <span class="math inline">\(\beta = 1.26\)</span></li>
<li>Intercept: returns on the Microsoft stock tend to be 0.54 percent when the S%P500 index doesn’t change.</li>
<li>Slope: returns on the Microsoft stock tend to be 1.26% higher when the returns on the S&amp;P500 index are 1% higher. The 95% CI is <span class="math inline">\([1.06, 1.46]\)</span>.</li>
<li>R-squared: 0.36</li>
<li>First difference of log prices. Estimate is 1.24</li>
<li>Daily returns (percent), beta is 1.10</li>
</ul>
</section>
<section id="issues-to-deal-with-before-regression-a-laundry-list" class="level2">
<h2 class="anchored" data-anchor-id="issues-to-deal-with-before-regression-a-laundry-list">Issues to deal with, before Regression: a laundry list</h2>
<ul>
<li>Handling trend(s) and random walk (RW)
<ul>
<li>Add trend variable or Difference the series</li>
</ul></li>
<li>Transforming the series, such as taking first differences or percent change</li>
<li>Handling seasonality and special events
<ul>
<li>Include dummies</li>
</ul></li>
<li>Reconsidering standard errors. Specially if series have Unit Roots</li>
<li>Dealing with serial correlation - taking time-to-build into account with lags</li>
</ul>
</section>
<section id="trend-rw---spurious-regression" class="level2">
<h2 class="anchored" data-anchor-id="trend-rw---spurious-regression">Trend &amp; RW - Spurious regression</h2>
<ul>
<li>Trends, seasonality, and random walks can present serious threats to uncovering meaningful patterns in time series data.
<ul>
<li>Example: time series regression in levels <span class="math inline">\(y^E_t = \alpha + \beta x_t\)</span>.</li>
<li>If both <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> have a positive trend, the slope coefficient <span class="math inline">\(\beta\)</span> will be positive whether the two variables are related or not.</li>
<li>Associations between variables only because of the effect of trends are said to be spurious correlation.</li>
</ul></li>
<li>Think of trend and seasonality are confounders (omitted variables)
<ul>
<li>trend: global tendencies e.g.&nbsp;economic activity, fashion</li>
<li>seasonality: e.g.&nbsp;weather, holidays, human habits (sleep)</li>
</ul></li>
<li>Another reason for spurious correlation is small sample size…</li>
</ul>
</section>
<section id="time-series-regressions-trends-and-seasonality" class="level2">
<h2 class="anchored" data-anchor-id="time-series-regressions-trends-and-seasonality">Time series regressions: Trends and seasonality</h2>
<ul>
<li>Trend as confounder example</li>
<li>A regression of the price of college education in the U.S. on the GDP of Germany over the past few decades</li>
<li>Positive slope coefficient even though that two may not be related in any fundamental way.</li>
<li>But US GDP is correlated with both</li>
</ul>
<p>Examples <a href="https://tylervigen.com/spurious-correlations" class="uri">https://tylervigen.com/spurious-correlations</a></p>
</section>
<section id="time-series-regressions-trends-and-seasonality-1" class="level2">
<h2 class="anchored" data-anchor-id="time-series-regressions-trends-and-seasonality-1">Time series regressions: Trends and seasonality</h2>
<ul>
<li>In a regression, we shall deal with trends
<ul>
<li>Replacing variables in the regression with their first differences
<ul>
<li>Variables in differences – no trends – likely to to be stationary.</li>
<li>Could be log difference for exponential trends</li>
</ul></li>
<li>Could also add trends to model</li>
</ul></li>
<li>In a regression, we shall deal with seasonality
<ul>
<li>Including binary season variables in regressions.</li>
<li>Look at pattern, figure out if quarters, months, weeks, days of week, etc.</li>
<li>Or work with year-on-year (event to event) changes instead of first differences.</li>
</ul></li>
</ul>
</section>
<section id="trend-rw---solution-first-differences" class="level2">
<h2 class="anchored" data-anchor-id="trend-rw---solution-first-differences">Trend &amp; RW - solution: first differences</h2>
<p><span class="math display">\[\Delta y^E_t = \alpha + \beta \Delta x_t\]</span></p>
<ul>
<li>Coefficients have the same interpretation as before, but relate changes in variables.</li>
<li>Because variables denote changes…
<ul>
<li><span class="math inline">\(\alpha\)</span> is the average change in <span class="math inline">\(y\)</span> when <span class="math inline">\(x\)</span> doesn’t change.</li>
<li>The slope coefficient on <span class="math inline">\(\Delta x_t\)</span> shows how much more <span class="math inline">\(y\)</span> is expected to change when <span class="math inline">\(x\)</span> changes by one <strong>more</strong> unit.</li>
<li>The slope shows how <span class="math inline">\(y\)</span> is expected to change when <span class="math inline">\(x\)</span> changes, in addition to <span class="math inline">\(\alpha\)</span>.</li>
</ul></li>
</ul>
</section>
<section id="seasonality-in-time-series-regressions" class="level2">
<h2 class="anchored" data-anchor-id="seasonality-in-time-series-regressions">Seasonality in time series regressions</h2>
<ul>
<li>Capturing seasonality is also crucial.</li>
<li>Higher the frequency – the more important.
<ul>
<li>People behave differently on different hours and days</li>
<li>Weather varies over months</li>
<li>Holidays, ect</li>
</ul></li>
<li>Have seasonal dummies if seasonality is stable.</li>
</ul>
<p><span class="math display">\[y^E_t = \alpha + \beta x_t + \delta_{Jan} + \delta_{Feb} + \cdots + \delta_{Nov}\]</span></p>
<ul>
<li>Pattern may vary over time. If it does, solutions must capture exact pattern – (difficult, not covering here)</li>
</ul>
</section>
<section id="another-problem-serial-correlation" class="level2">
<h2 class="anchored" data-anchor-id="another-problem-serial-correlation">Another Problem: Serial correlation</h2>
<ul>
<li><p>Serial correlation means correlation of a variable with its previous values</p>
<ul>
<li>It usually refers to the correlation of the residuals with their previous values.</li>
</ul></li>
<li><p>Order serial correlation coefficient is defined as <span class="math display">\[\rho_k = \text{Corr}[x_t, x_{t-k}]\]</span></p></li>
<li><p>If independent variables are serially correlated, usually not a problem.</p></li>
<li><p>If dependent variable is serially correlated (the error), it is a problem.</p></li>
<li><p>Serial correlation makes the usual standard error estimates wrong.</p>
<ul>
<li>Even classical heteroskedasticity robust SE is wrong - sometimes very wrong</li>
</ul></li>
<li><p>More precisely it is serial correlation in residuals, but think about is as serial correlation in <span class="math inline">\(y_t\)</span> is okay</p></li>
</ul>
</section>
<section id="standard-errors-in-time-series-regressions" class="level2">
<h2 class="anchored" data-anchor-id="standard-errors-in-time-series-regressions">Standard errors in time series regressions</h2>
<ul>
<li><p>In most time series, there will be <strong>some</strong> serial correlation</p></li>
<li><p>Sol1: Use the <strong>Newey-West</strong> SE: in Stata <code>newey</code> command.</p>
<ul>
<li>This incorporates structure of serial correlation of the regression residuals</li>
<li>Fine if heteroskedasticity as well</li>
<li>Need to specify lags, based on frequency and seasonality</li>
</ul></li>
<li><p>Sol2: Have lagged dependent variable in the regression (one lag is usually enough) <span class="math display">\[y_t = \alpha + \beta x_t + \gamma_1 y_{t-1} + \gamma_2 y_{t-2} \ldots\]</span></p>
<ul>
<li>This will change Coefficients and adjust SEs</li>
</ul></li>
</ul>
</section>
</section>
<section id="case-study-b-electricity-consumption-and-temperature" class="level1">
<h1>Case study B: Electricity consumption and temperature</h1>
<section id="electricity-consumption-and-temperature" class="level2">
<h2 class="anchored" data-anchor-id="electricity-consumption-and-temperature">Electricity consumption and temperature</h2>
<ul>
<li>We have access to monthly weather and electricity data for Phoenix, Arizona: Overall 204 month</li>
<li>Also access to “cooling degree days” and “heating degree days” data</li>
<li>The <strong>cooling degree days</strong> measure Number of degrees that a day’s average temperature is above 65F (18C). This is add up over the month.</li>
<li>Similar for <strong>heating degree days</strong> but below 65F (18C)</li>
<li>Access to Electricity consumption data over the month</li>
<li>As expected, this values will be seasonal.</li>
</ul>
</section>
<section id="cs-modelling-decisions" class="level2">
<h2 class="anchored" data-anchor-id="cs-modelling-decisions">CS: Modelling decisions</h2>
<ul>
<li>There is an exponential trend in electricity –&gt; use log difference</li>
<li>For easier interpretation, take first difference (FD) of cooling and heating days</li>
<li><strong>Natural question</strong>: How much does electricity consumption change when temperature changes?</li>
<li>Add monthly dummies, January (December to January) is reference</li>
<li>Use Newey-West standard errors</li>
</ul>
</section>
<section id="model-estimates" class="level2">
<h2 class="anchored" data-anchor-id="model-estimates">Model estimates</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Variables</th>
<th>(1)</th>
<th>(2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\Delta\)</span>CD</td>
<td>0.031**</td>
<td>0.017**</td>
</tr>
<tr class="even">
<td></td>
<td>(0.001)</td>
<td>(0.002)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\Delta\)</span>HD</td>
<td>0.037**</td>
<td>0.014**</td>
</tr>
<tr class="even">
<td></td>
<td>(0.003)</td>
<td>(0.003)</td>
</tr>
<tr class="odd">
<td>month = 2, February</td>
<td></td>
<td>-0.274**</td>
</tr>
<tr class="even">
<td>month = 3, March</td>
<td></td>
<td>-0.122**</td>
</tr>
<tr class="odd">
<td>…</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Constant</td>
<td>0.001</td>
<td>0.092**</td>
</tr>
<tr class="odd">
<td></td>
<td>(0.002)</td>
<td>(0.013)</td>
</tr>
<tr class="even">
<td>Observations</td>
<td>203</td>
<td>203</td>
</tr>
</tbody>
</table>
</section>
<section id="model-results" class="level2">
<h2 class="anchored" data-anchor-id="model-results">Model results</h2>
<ul>
<li>Simple (1) model:
<ul>
<li>In months when cooling degrees increase by one degree and heating degrees do not change, electricity consumption increases by 3.1 percent, on average.</li>
<li>When heating degrees increase by one degree and cooling degrees do not change, electricity consumption increases by 3.7 percent, on average.</li>
</ul></li>
<li>Model (2) with monthly dummies.
<ul>
<li>The reference month is January: constant (when cooling and heating degrees stay the same), electricity consumption increases by about 9% from December to January.</li>
<li>The other season coefficients compare to this change:
<ul>
<li>February: the January to February change is 28 percentage points lower than in the reference month, December to January.</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="electricity-consumption-and-temperature-different-se-estimates" class="level2">
<h2 class="anchored" data-anchor-id="electricity-consumption-and-temperature-different-se-estimates">Electricity consumption and temperature – different SE estimates</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Variables</th>
<th>(1)</th>
<th>(2)</th>
<th>(3)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>Simple SE</td>
<td>Newey–West SE</td>
<td>Lagged dep.var</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\Delta\)</span>CD</td>
<td>0.017**</td>
<td>0.017**</td>
<td>0.017**</td>
</tr>
<tr class="odd">
<td></td>
<td>(0.002)</td>
<td>(0.002)</td>
<td>(0.002)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\Delta\)</span>HD</td>
<td>0.014**</td>
<td>0.014**</td>
<td>0.014**</td>
</tr>
<tr class="odd">
<td></td>
<td>(0.002)</td>
<td>(0.003)</td>
<td>(0.002)</td>
</tr>
<tr class="even">
<td>Lag of <span class="math inline">\(\Delta\)</span> ln Q</td>
<td></td>
<td></td>
<td>-0.002</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td>(0.062)</td>
</tr>
<tr class="even">
<td>Month dummies</td>
<td>YES</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr class="odd">
<td>Observations</td>
<td>203</td>
<td>203</td>
<td>202</td>
</tr>
<tr class="even">
<td>R-squared</td>
<td>0.951</td>
<td>0.951</td>
<td></td>
</tr>
<tr class="odd">
<td>Standard errors in parentheses</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>** p&lt;0.01, * p&lt;0.05</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="electricity-consumption-and-temperature-different-se-estimates-1" class="level2">
<h2 class="anchored" data-anchor-id="electricity-consumption-and-temperature-different-se-estimates-1">Electricity consumption and temperature – different SE estimates</h2>
<ul>
<li>To correct for serial correlation, compare simple SE model with two correctly specified models
<ul>
<li>with Newey-West SE</li>
<li>with Lagged dependent variable</li>
</ul></li>
<li>SE marginally different, and with lagged values, coefficients are also similar up to 3 digits
<ul>
<li><strong>Similar, not the same</strong></li>
<li>Sometimes substantial difference (if strong serial correlation)</li>
</ul></li>
</ul>
</section>
</section>
<section id="propagation-effect" class="level1">
<h1>Propagation effect</h1>
<section id="propagation-effect-changes-and-lags---fdl-model" class="level2">
<h2 class="anchored" data-anchor-id="propagation-effect-changes-and-lags---fdl-model">Propagation effect: changes and lags - FDL model</h2>
<p>In time series, we can analyze how an impact builds up across several periods (time-to-build):</p>
<p><span class="math display">\[\Delta y^E_t = \alpha + \beta_0 \Delta x_t + \beta_1 \Delta x_{t-1} + \beta_2 \Delta x_{t-2}\]</span></p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> = how many units more <span class="math inline">\(y\)</span> is expected to change within the same time period when <span class="math inline">\(x\)</span> changes by one more unit (No change before or after).</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> = how much more <span class="math inline">\(y\)</span> is expected to change in the next time period after <span class="math inline">\(x\)</span> changed by one more unit.</p></li>
<li><p>Cumulative effect: <span class="math inline">\(\beta_\text{cumul} = \beta_0 + \beta_1 + \beta_2\)</span></p></li>
<li><p><span class="math inline">\(\beta_k\)</span> are the short-term effects, <span class="math inline">\(\beta_\text{cumul}\)</span> is the cumulative effect/Long Term Effect.</p></li>
</ul>
</section>
<section id="testing-the-cumulative-effect" class="level2">
<h2 class="anchored" data-anchor-id="testing-the-cumulative-effect">Testing the cumulative effect</h2>
<ul>
<li>To get a SE on the cumulative effect, do a trick and transformation, and estimate a different model</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\Delta y^E_t &amp;= \alpha + \beta_0 \Delta x_t + \beta_1 \Delta x_{t-1} + \beta_2 \Delta x_{t-2} \\
\Delta y^E_t &amp;= \alpha + (\beta_\text{cumul} - \beta_1 - \beta_2) \Delta x_t + \beta_1 \Delta x_{t-1} + \beta_2 \Delta x_{t-2} \\
\Delta y^E_t &amp;= \alpha + \beta_\text{cumul} \Delta x_t + \beta_1 (\Delta x_{t-1}- \Delta x_t) + \beta_2 (\Delta x_{t-2} - \Delta x_t)\\
\Delta y^E_t &amp;= \alpha + \beta_\text{cumul} \Delta x_{t} + \delta_0 \Delta(\Delta x_t) + \delta_1 \Delta(\Delta x_{t-1})
\end{aligned}\]</span></p>
<ul>
<li><span class="math inline">\(\beta_\text{cumul}\)</span> is exactly the same as <span class="math inline">\(\beta_0 + \beta_1 + \beta_2\)</span></li>
<li>Usually estimate both. Separate and cumulative effect</li>
<li>Often need a few lags</li>
</ul>
</section>
<section id="propagation-effect-changes-and-lags---fdl-model-1" class="level2">
<h2 class="anchored" data-anchor-id="propagation-effect-changes-and-lags---fdl-model-1">Propagation effect: changes and lags - FDL model</h2>
<p>See Case Study in Chapter 12</p>
</section>
<section id="summary-of-the-process" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-the-process">Summary of the process</h2>
<ul>
<li>Decide on frequency; deal with gaps if necessary.</li>
<li>Plot the series. Identify features and issues.</li>
<li>Handle trends by transforming variables (Often: first difference <code>d.</code>).</li>
<li>Specify regression that handles seasonality, usually by including season dummies.</li>
<li>Include or don’t include lags of the right-hand-side variable(s).</li>
<li>Handle serial correlation. <code>newey</code> or lagged dependent variable.</li>
<li>Interpret coefficients in a way that pays attention to potential trend and seasonality.</li>
<li>Time series econometrics very complicated beyond this.</li>
<li>But: These steps often good enough.</li>
</ul>
</section>
<section id="main-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="main-takeaways">Main takeaways</h2>
<ul>
<li>Regressions with time series data allow for additional opportunities, but they pose additional challenges, too</li>
<li>Regressions with time series data help uncover associations from changes and associations across time</li>
<li>Trend, seasonality, and random walk-like non-stationarity are additional challenges</li>
<li>Do not regress variables that have trend or seasonality; without dealing with them they produce spurious results</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>