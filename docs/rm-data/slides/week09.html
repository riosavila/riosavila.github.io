<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-07ba0ad10f5680c660e360ac31d2f3b6.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.33">

  <meta name="author" content="Fernando Rios-Avila">
  <meta name="dcterms.date" content="2024-09-17">
  <title>Econometrics MSC Levy – Time series data</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-97edfe54b73ff960639f8ac44205bcc0.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Time series data</h1>
  <p class="subtitle">The past, the present, and the future</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Fernando Rios-Avila 
</div>
        <p class="quarto-title-affiliation">
            Levy Economics Institute
          </p>
    </div>
</div>

  <p class="date">September 17, 2024</p>
</section>
<section id="motivation" class="slide level2">
<h2>Motivation</h2>
<ul>
<li><p>You are considering investing in a company stock, and you want to know how risky that investment is. You have downloaded data on daily stock prices for many years. How should you define returns? How should you assess whether and to what extent returns on the company stock move together with market returns?</p></li>
<li><p>Heating and cooling are important uses of electricity. How does weather conditions affect electricity consumption? We are going to use monthly data on temperature and residential electricity consumption in Arizona. How to formulate a model which captures these factors?</p></li>
</ul>
</section>
<section id="what-is-special-in-the-analysis-of-time-series-data" class="slide level2">
<h2>What is special in the analysis of time series data?</h2>
<div class="fragment">
<h3 id="different">Different</h3>
<ul>
<li>We have time series data if we observe one unit across many time periods.</li>
<li>There is a special notation: <span class="math inline">\(y_t\)</span>, <span class="math inline">\(t = 1, 2, \ldots, T\)</span></li>
<li>Time series data presents additional opportunities as well as additional challenges to compare variables.</li>
</ul>
</div>
<div class="fragment">
<h3 id="with-other-features">With other features</h3>
<ul>
<li>Data wrangling novelties: frequency and aggregation</li>
<li>Special nature of time series: serial correlation</li>
<li>Coefficient interpretation.</li>
</ul>
</div>
</section>
<section id="data-preparation" class="slide level2">
<h2>Data preparation</h2>
<ul>
<li>What is <strong>Frequency</strong>? of time series? = time elapsed between two observations of a variable</li>
<li>Practical problems with frequency:
<ul>
<li>Not all data is captured at the same frequency</li>
<li>There may be regular/irregular gaps between them: e.g.&nbsp;weekends for stock-exchange</li>
<li>Two variables have different frequencies</li>
<li>Extreme values (spikes) in your variable</li>
</ul></li>
<li>Last but not least: in Stata you need to Declare your data as time series data with <code>tsset</code> command</li>
</ul>
</section>
<section id="consequences" class="slide level2">
<h2>Consequences</h2>
<ul>
<li><p><strong>Regressions</strong>: to condition <span class="math inline">\(y_t\)</span> on values of <span class="math inline">\(x_t\)</span> the two variables need to be on the same frequency. Otherwise, we need to adjust one of them.</p></li>
<li><p>How to adjust? Aggregation!</p>
<ul>
<li>Flow variables: sum up the values within the interval. e.g.&nbsp;daily sales <span class="math inline">\(\rightarrow\)</span> weakly sales is the sum of daily sales.</li>
<li>Stock variables: take the end-period value. e.g.&nbsp;daily stock prices uses the closing price on a given day</li>
<li>Other kinds of variables: usually take the average value</li>
</ul></li>
</ul>
</section>
<section id="what-is-not-special-in-time-series" class="slide level2">
<h2>What is not special in time series</h2>
<ul>
<li><p>Time series regressions are special for several reasons…but many aspects remain the same</p>
<ul>
<li>Generalization, confidence intervals: Same difficulties as in cross-section</li>
<li>Time series regression uncover patterns rather than evidence of causality: There is no “sample of time”</li>
<li>Practical data issues, missing observations, extreme values etc, remain</li>
<li>Coefficient interpretation is based on conditional comparison</li>
</ul></li>
</ul>
</section>
<section id="what-is-special-in-time-series" class="slide level2">
<h2>What is special in time series</h2>
<ul>
<li>Ordering matters - key difference to cross section. Complications…Past before future</li>
<li>Trend - variables tend to have trends! Increasing or decreasing values over time</li>
<li>Seasonality - variables may show some cyclical component, such 4 seasons, months, - every e.g.&nbsp;December value is expected to be different.</li>
<li>Time series values are often not independent - correlated in time
<ul>
<li>Failure to account for this may lead to wrong (biased) conclusions</li>
</ul></li>
</ul>
</section>
<section>
<section id="properties" class="title-slide slide level1 center">
<h1>Properties</h1>

</section>
<section id="ts-variables-may-have-trends-trends" class="slide level2">
<h2>TS Variables may have trends Trends</h2>
<ul>
<li><p>Time series data “tends” to have trends. how to detect them?.</p></li>
<li><p>Define change (or fist difference): <span class="math inline">\(\Delta y_t = y_t - y_{t-1}\)</span></p></li>
</ul>
<p><span class="math display">\[
\begin{align}
\text{Positive trend}: &amp; E[\Delta y_t] &gt; 0 \\
\text{Negative trend}: &amp; E[\Delta y_t] &lt; 0
\end{align}
\]</span></p>
<ul>
<li>One may also consider two types of trends: linear and exponential</li>
</ul>
<p><span class="math display">\[
\begin{align}
\text{Linear trend}: &amp; E[\Delta y_t] = \text{constant} \\
\text{Exponential trend}: &amp; E[\Delta \ln(y_t)] = \text{constant}
\end{align}
\]</span></p>
<ul>
<li>Exponential trend, Changes are proportional</li>
</ul>
</section>
<section id="but-they-may-also-show-seasonality" class="slide level2">
<h2>But they may also show Seasonality</h2>
<ul>
<li>There is seasonal variation, or <strong><em>seasonality</em></strong>, if its expected value changes periodically.
<ul>
<li>Follows the seasons of the year, days of the week, hours of the day.</li>
</ul></li>
<li>Seasonality may be linear, when the seasonal differences are constant; it may be exponential, if relative differences (that may be approximated by log differences) are constant.</li>
<li>Important real life phenomenon - many economic activities follow seasonal variation over the year, through the week or day.
<ul>
<li>Thus they need to be accounted for in the analysis.</li>
</ul></li>
</ul>
</section>
<section id="what-is-special-in-time-series-stationarity" class="slide level2">
<h2>What is special in time series: Stationarity</h2>
<blockquote>
<p>To learn something, we need consistency in patterns If the patterns change constantly, we cannot learn anything from the data</p>
</blockquote>
<div class="fragment">
<ul>
<li>Stationary time series have the same expected value and same distribution, at all times.</li>
<li>Stationarity is a feature of the time series itself.</li>
<li>Stationarity means stability (in expectations).</li>
<li>If series are stationary, we can learn from them!</li>
</ul>
</div>
</section>
<section id="what-is-special-in-time-series-non-stationarity" class="slide level2">
<h2>What is special in time series: Non-stationarity</h2>
<blockquote>
<p>In absence of stationarity, we cannot learn anything from the data Or what we learn may be misleading</p>
</blockquote>
<div class="fragment">
<ul>
<li>Non-stationary time series are those that are not stable for some reason.</li>
<li>Series that violate stationarity because the expected value is different at different times:
<ul>
<li>Has a trends</li>
<li>Has seasonality</li>
<li>Has some unstable patterns</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Although, some of this issues can be address by “controlling” for them in the regression.</li>
</ul>
</div>
</section>
<section id="a-special-case-random-walk" class="slide level2">
<h2>A Special case: Random walk</h2>
<p>Some non-stationary variables are not easy to deal with:</p>
<div class="fragment">
<ul>
<li>Another example of non-stationary time series is the <strong>random walk</strong>.</li>
<li>Random walk when <span class="math inline">\(y_t\)</span> follows a random walk if its value in <span class="math inline">\(t\)</span> is the same as in <span class="math inline">\((t - 1)\)</span> plus some random term: <span class="math inline">\(y_t = y_{t-1} + e_t\)</span>.</li>
<li>Time series variables that follow random walk change in completely random ways.</li>
<li>Whatever the previous change was the next one may be anything. Wherever it starts, a random walk variable may end up anywhere after a long time.</li>
</ul>
</div>
</section>
<section id="section" class="slide level2">
<h2></h2>
<div id="05dcb67e" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a></a><span class="kw">qui</span>: {</span>
<span id="cb1-2"><a></a>  <span class="kw">clear</span></span>
<span id="cb1-3"><a></a><span class="kw">set</span> <span class="dv">scheme</span> white2</span>
<span id="cb1-4"><a></a>color_style bay</span>
<span id="cb1-5"><a></a><span class="kw">qui</span>:<span class="kw">set</span> <span class="kw">obs</span> 101</span>
<span id="cb1-6"><a></a><span class="kw">gen</span> <span class="fu">r</span> = runiform(0,2*<span class="dt">_pi</span>)</span>
<span id="cb1-7"><a></a></span>
<span id="cb1-8"><a></a><span class="kw">gen</span> <span class="fu">y</span> = 0 </span>
<span id="cb1-9"><a></a><span class="kw">gen</span> x = 0</span>
<span id="cb1-10"><a></a><span class="kw">replace</span> <span class="fu">y</span> = <span class="fu">y</span>[<span class="dt">_n</span>-1] + <span class="fu">sin</span>(<span class="fu">r</span>) <span class="kw">if</span> <span class="dt">_n</span>&gt;1</span>
<span id="cb1-11"><a></a><span class="kw">replace</span> x = x[<span class="dt">_n</span>-1] + <span class="fu">cos</span>(<span class="fu">r</span>) <span class="kw">if</span> <span class="dt">_n</span>&gt;1</span>
<span id="cb1-12"><a></a><span class="kw">gen</span> n = <span class="dt">_n</span></span>
<span id="cb1-13"><a></a>}</span>
<span id="cb1-14"><a></a></span>
<span id="cb1-15"><a></a>*<span class="kw">scatter</span>  <span class="fu">y</span> x , <span class="kw">connect</span>(<span class="ot">l</span>) <span class="bn">name</span>(m1, <span class="kw">replace</span>) </span>
<span id="cb1-16"><a></a>*<span class="kw">line</span> <span class="fu">y</span> x n, <span class="bn">name</span>(m2, <span class="kw">replace</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<style>div.jp-Notebook .datagrid-container {min-height: 448px; }</style>
</div>
</div>
<div>

</div>
<div id="7bb12b0e" class="cell quarto-layout-panel" data-execution_count="3" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="week09_files/figure-revealjs/cell-3-output-1.png"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="week09_files/figure-revealjs/cell-3-output-2.png"></p>
</div>
</div>
</div>
</section>
<section id="what-to-fear-of-random-walk" class="slide level2">
<h2>What to fear of Random walk</h2>
<div class="fragment">
<ul>
<li>Random walks are impossible to predict</li>
<li>after a change, they don’t revert back to some value or trend line but continue their journey from that point.</li>
<li>Spread rising from one interval to another</li>
<li>Why is this important?</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>To identify patterns, we need stationarity</li>
<li>For stationary series, we need stability of patterns</li>
<li>Avoid series with random walk when running regressions
<ul>
<li>Using them would only cause problems of Spurious Regressions</li>
</ul></li>
</ul>
</div>
</section>
<section id="how-to-detect-it-unit-root-test" class="slide level2">
<h2>How to detect it: Unit root test</h2>
<div class="fragment">
<ul>
<li><p>We can test if a series is a random walk.</p></li>
<li><p>Phillips-Perron test is based on this model: <span class="math display">\[y_t = \alpha + \rho y_{t-1} + e_t\]</span></p></li>
<li><p>This model represents a random walk if <span class="math inline">\(\rho = 1\)</span>, which is also called a unit root</p></li>
<li><p>Random walk test = testing if the series has a unit root.</p></li>
<li><p>The Phillips-Perron test has hypothesis</p></li>
</ul>
<p><span class="math display">\[H_0: \rho = 1 \text{ vs } H_A: \rho &lt; 1\]</span></p>
</div>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<ul>
<li><p>This test does not follow the usual t-distribution. Has its own distribution.</p></li>
<li><p>in Stata, you can use it with the <code>pperron</code> command. (see <code>helpfile</code>)</p></li>
<li><p>When the p-value is large (e.g., larger than 0.05), we don’t reject the null, concluding that the time series variable follows a random walk</p></li>
<li><p>Many versions of unit root test.</p>
<ul>
<li>(Augmented) Dicky Fuller test is another popular one.</li>
</ul></li>
</ul>
<p><span class="math display">\[\Delta y_t = \alpha + \delta y_{t-1} + e_t\]</span></p>
<ul>
<li><span class="math inline">\(H_0: \delta = 0\)</span> vs <span class="math inline">\(H_A: \delta &lt; 0\)</span></li>
<li>Tests usually agree, but not always. see <code>dfuller</code></li>
</ul>
</section>
<section id="time-series-summary" class="slide level2">
<h2>Time Series: Summary</h2>
<ul>
<li>Stationary series are those where the <strong>expected</strong> value, <strong>variance</strong>, and <strong>auto-correlation</strong> does not change.</li>
<li>Examples of non–stationarity:
<ul>
<li><strong>Trend</strong> - Expected value is different in later time periods than in earlier time periods</li>
<li><strong>Seasonality</strong> - Expected value is different in periodically recurring time periods</li>
<li><strong>Random walk</strong> – Variance keeps increasing over time
<ul>
<li>This is the one we need to avoid</li>
</ul></li>
</ul></li>
<li><strong>Why care?</strong> Regression with time series data variables that are not stationary are likely to give misleading results (Spurious).</li>
</ul>
</section>
<section id="what-to-do-with-ts-cook-book" class="slide level2">
<h2>What to do With TS: Cook-book</h2>
<div class="fragment">
<ul>
<li>Check if your variable is stationary
<ul>
<li>Visualize</li>
<li>Do a unit-root test</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>If there is a good reason to believe your variable trending (or is Random Walk)
<ul>
<li>Take differences <span class="math inline">\(\Delta y_t\)</span>, or add a trend variable</li>
<li>Take percentage changes or log differences
<ul>
<li>In extremely rare cases, difference your variable twice</li>
</ul></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>If your variable has a seasonality
<ul>
<li>Use seasonality dummies in your regression</li>
<li>May consider to work with seasonal changes.</li>
</ul></li>
</ul>
</div>
</section></section>
<section>
<section id="case-study-a-stocks" class="title-slide slide level1 center">
<h1>Case study A: stocks</h1>

</section>
<section id="microsoft-and-sp-500-stock-prices---data" class="slide level2">
<h2>Microsoft and S&amp;P 500 stock prices - data</h2>
<ul>
<li>Daily price of Microsoft stock and value of S&amp;P 500 stock market index</li>
<li>The data covers 21 years starting with December 31 1997 and ending with December 31 2018.</li>
<li>Many decisions to make…</li>
<li>Look at data first</li>
</ul>
</section>
<section id="case-study-stock-price-and-stock-market-index-value" class="slide level2">
<h2>Case study: Stock price and stock market index value</h2>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb2-1"><a></a><span class="kw">qui</span> {</span>
<span id="cb2-2"><a></a><span class="kw">use</span> <span class="st">"data_slides/stock-prices-daily.dta"</span>, <span class="kw">clear</span></span>
<span id="cb2-3"><a></a><span class="kw">ren</span> *, low</span>
<span id="cb2-4"><a></a>}</span>
<span id="cb2-5"><a></a><span class="kw">line</span> p_sp500 <span class="fu">date</span>, <span class="bn">name</span>(m1, <span class="kw">replace</span>)</span>
<span id="cb2-6"><a></a><span class="kw">line</span> p_msft <span class="fu">date</span>, <span class="bn">name</span>(m2, <span class="kw">replace</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="11f69657" class="cell quarto-layout-panel" data-execution_count="4" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="week09_files/figure-revealjs/cell-4-output-1.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="week09_files/figure-revealjs/cell-4-output-2.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="time-series-comparisons---sp-500-case-study" class="slide level2">
<h2>Time series comparisons - S&amp;P 500 case study</h2>
<p>Key decisions:</p>
<ul>
<li>Daily price = closing price</li>
<li>Gaps will be overlooked
<ul>
<li>Friday-Monday gap ignored</li>
<li>Holidays (Christmas, 4 of July (when would be a weekday)</li>
</ul></li>
<li>All values kept, extreme values part of process</li>
<li>In finance, portfolio managers often focus on monthly returns, Hence we choose monthly returns to analyze.</li>
<li>Take the last day of each month</li>
</ul>
</section>
<section id="microsoft-and-sp-500-stock-prices---ts-plot" class="slide level2">
<h2>Microsoft and S&amp;P 500 stock prices - ts plot</h2>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb3-1"><a></a><span class="kw">qui</span> {</span>
<span id="cb3-2"><a></a><span class="kw">use</span> <span class="st">"data_slides/stock-prices-daily.dta"</span>, <span class="kw">clear</span></span>
<span id="cb3-3"><a></a><span class="kw">ren</span> *, low</span>
<span id="cb3-4"><a></a><span class="kw">sort</span> <span class="fu">ym</span> <span class="fu">date</span></span>
<span id="cb3-5"><a></a><span class="kw">bysort</span> <span class="fu">ym</span>: <span class="kw">gen</span> flag = <span class="dt">_n</span> == _N</span>
<span id="cb3-6"><a></a><span class="kw">keep</span> <span class="kw">if</span> flag==1</span>
<span id="cb3-7"><a></a>}</span>
<span id="cb3-8"><a></a><span class="kw">line</span> p_sp500 <span class="fu">ym</span>, <span class="bn">name</span>(m1, <span class="kw">replace</span>)</span>
<span id="cb3-9"><a></a><span class="kw">line</span> p_msft <span class="fu">ym</span>, <span class="bn">name</span>(m2, <span class="kw">replace</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="3b9b9e10" class="cell quarto-layout-panel" data-execution_count="5" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="week09_files/figure-revealjs/cell-5-output-1.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="week09_files/figure-revealjs/cell-5-output-2.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="microsoft-and-sp-500-stock-prices---decisions-2" class="slide level2">
<h2>Microsoft and S&amp;P 500 stock prices - decisions 2</h2>
<ul>
<li>Monthly time series plot - easier to read</li>
<li>Additional decision needed: it is obviously non-stationary (Phillips-Perron test: very high p-value)</li>
<li>Use returns:
<ul>
<li>Returns: percent change of the closing prices: <span class="math inline">\(100\% \frac{y_t - y_{t-1}}{y_t}\)</span>.</li>
<li>monthly returns - take the closing price for the last day of a month</li>
<li>Alternative measure: first difference of log prices.</li>
</ul></li>
</ul>
</section>
<section id="microsoft-and-sp-500---index-returns-pct" class="slide level2">
<h2>Microsoft and S&amp;P 500 - index returns (pct)</h2>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb4-1"><a></a><span class="kw">qui</span>: {</span>
<span id="cb4-2"><a></a><span class="kw">use</span> <span class="st">"data_slides/stock-prices-daily.dta"</span>, <span class="kw">clear</span></span>
<span id="cb4-3"><a></a><span class="kw">ren</span> *, low</span>
<span id="cb4-4"><a></a><span class="kw">sort</span> <span class="fu">ym</span> <span class="fu">date</span></span>
<span id="cb4-5"><a></a><span class="kw">bysort</span> <span class="fu">ym</span>: <span class="kw">gen</span> flag = <span class="dt">_n</span> == _N</span>
<span id="cb4-6"><a></a><span class="kw">keep</span> <span class="kw">if</span> flag==1</span>
<span id="cb4-7"><a></a><span class="kw">tsset</span> <span class="fu">ym</span></span>
<span id="cb4-8"><a></a><span class="kw">gen</span> ret_sp500 = 100 * (p_sp500 - p_sp500[<span class="dt">_n</span>-1]) / p_sp500[<span class="dt">_n</span>-1]</span>
<span id="cb4-9"><a></a><span class="kw">gen</span> ret_msft = 100 * (p_msft - p_msft[<span class="dt">_n</span>-1]) / p_msft[<span class="dt">_n</span>-1]</span>
<span id="cb4-10"><a></a>}</span>
<span id="cb4-11"><a></a></span>
<span id="cb4-12"><a></a><span class="kw">line</span> ret_sp500 <span class="fu">ym</span>, <span class="bn">name</span>(m1, <span class="kw">replace</span>)</span>
<span id="cb4-13"><a></a><span class="kw">line</span> ret_msft <span class="fu">ym</span>, <span class="bn">name</span>(m2, <span class="kw">replace</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="48b82e26" class="cell quarto-layout-panel" data-execution_count="6" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="week09_files/figure-revealjs/cell-6-output-1.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="week09_files/figure-revealjs/cell-6-output-2.png" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="unit-root-test-microsoft-and-sp-500-returns" class="slide level2 scrollable">
<h2>Unit root test: Microsoft and S&amp;P 500 returns</h2>
<div id="75012fa0" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a></a><span class="kw">pperron</span> ret_sp500</span>
<span id="cb5-2"><a></a><span class="kw">pperron</span> ret_msft</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Phillips–Perron test for unit root       Number of obs   = 251
Variable: ret_sp500                      Newey–West lags =   4

H0: Random walk without drift, d = 0

                                       Dickey–Fuller
                   Test      -------- critical value ---------
              statistic           1%           5%          10%
--------------------------------------------------------------
 Z(rho)        -230.845      -20.301      -14.000      -11.200
 Z(t)           -14.365       -3.460       -2.880       -2.570
--------------------------------------------------------------
MacKinnon approximate p-value for Z(t) = 0.0000.

Phillips–Perron test for unit root       Number of obs   = 251
Variable: ret_msft                       Newey–West lags =   4

H0: Random walk without drift, d = 0

                                       Dickey–Fuller
                   Test      -------- critical value ---------
              statistic           1%           5%          10%
--------------------------------------------------------------
 Z(rho)        -284.851      -20.301      -14.000      -11.200
 Z(t)           -19.346       -3.460       -2.880       -2.570
--------------------------------------------------------------
MacKinnon approximate p-value for Z(t) = 0.0000.</code></pre>
</div>
</div>
</section></section>
<section>
<section id="regression-with-time-series" class="title-slide slide level1 center">
<h1>Regression with time series</h1>

</section>
<section id="time-series-regressions-the-same" class="slide level2">
<h2>Time series regressions: The same</h2>
<ul>
<li>Regression in time series data is defined and estimated the same way as in other data.</li>
</ul>
<p><span class="math display">\[y^E_t = \beta_0 + \beta_1 x_{1t} + \beta_2 x_{2t} + \ldots\]</span></p>
<ul>
<li>Interpretations similar to cross-section
<ul>
<li><span class="math inline">\(\beta_0\)</span>: We expect <span class="math inline">\(y\)</span> to be <span class="math inline">\(\beta_0\)</span> when all explanatory variables are zero.</li>
<li><span class="math inline">\(\beta_1\)</span>: Comparing time periods with different <span class="math inline">\(x_1\)</span> but the same in terms of all other explanatory variables, we expect <span class="math inline">\(y\)</span> to be higher by <span class="math inline">\(\beta_1\)</span> when <span class="math inline">\(x_1\)</span> is higher by one unit.</li>
</ul></li>
</ul>
</section>
<section id="time-series-regression-but-different" class="slide level2">
<h2>Time series regression: But different</h2>
<ul>
<li>With time series data, we often estimate regressions in <strong>changes</strong></li>
<li>We use the <span class="math inline">\(\Delta\)</span> notation for changes</li>
</ul>
<p><span class="math display">\[\Delta x_t = x_t - x_{t-1}\]</span></p>
<ul>
<li><p>The regression in changes is <span class="math display">\[\Delta y^E_t = \alpha + \beta \Delta x_t\]</span></p>
<ul>
<li><span class="math inline">\(\alpha\)</span>: <span class="math inline">\(y\)</span> is expected to change by <span class="math inline">\(\alpha\)</span> when <span class="math inline">\(x\)</span> doesn’t change</li>
<li><span class="math inline">\(\beta\)</span>: <span class="math inline">\(y\)</span> is expected to change by <span class="math inline">\(\beta\)</span> more when <span class="math inline">\(x\)</span> increases by one unit more</li>
</ul></li>
</ul>
</section>
<section id="time-series-regression-growth" class="slide level2">
<h2>Time series regression: Growth</h2>
<ul>
<li>We often have variables in relative or percentage changes,</li>
</ul>
<p><span class="math display">\[\%\Delta  (y_t)^E = \alpha + \beta \%\Delta(x_t)\]</span></p>
<ul>
<li>We can approximate relative differences by log differences, which are here log change: first taking logs of the variables and then taking the first difference</li>
</ul>
<p><span class="math display">\[\Delta \ln(y_t) = \ln(y_t) - \ln(y_{t1})\]</span></p>
</section>
<section id="returns-on-a-company-stock-and-market-returns" class="slide level2">
<h2>Returns on a company stock and market returns</h2>
<p><span class="math display">\[\%\Delta(\text{MSFT}_t) = \alpha + \beta \%\Delta (\text{SP500}_t)\]</span></p>
<ul>
<li><span class="math inline">\(\alpha = 0.54\)</span>; <span class="math inline">\(\beta = 1.26\)</span></li>
<li>Intercept: returns on the Microsoft stock tend to be 0.54 percent when the S%P500 index doesn’t change.</li>
<li>Slope: returns on the Microsoft stock tend to be 1.26% higher when the returns on the S&amp;P500 index are 1% higher. The 95% CI is <span class="math inline">\([1.06, 1.46]\)</span>.</li>
<li>R-squared: 0.36</li>
<li>First difference of log prices. Estimate is 1.24</li>
<li>Daily returns (percent), beta is 1.10</li>
</ul>
</section>
<section id="issues-to-deal-with-before-regression-a-laundry-list" class="slide level2">
<h2>Issues to deal with, before Regression: a laundry list</h2>
<ul>
<li>Handling trend(s) and random walk (RW)
<ul>
<li>Add trend variable or Difference the series</li>
</ul></li>
<li>Transforming the series, such as taking first differences or percent change</li>
<li>Handling seasonality and special events
<ul>
<li>Include dummies</li>
</ul></li>
<li>Reconsidering standard errors. Specially if series have Unit Roots</li>
<li>Dealing with serial correlation - taking time-to-build into account with lags</li>
</ul>
</section>
<section id="trend-rw---spurious-regression" class="slide level2">
<h2>Trend &amp; RW - Spurious regression</h2>
<ul>
<li>Trends, seasonality, and random walks can present serious threats to uncovering meaningful patterns in time series data.
<ul>
<li>Example: time series regression in levels <span class="math inline">\(y^E_t = \alpha + \beta x_t\)</span>.</li>
<li>If both <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> have a positive trend, the slope coefficient <span class="math inline">\(\beta\)</span> will be positive whether the two variables are related or not.</li>
<li>Associations between variables only because of the effect of trends are said to be spurious correlation.</li>
</ul></li>
<li>Think of trend and seasonality are confounders (omitted variables)
<ul>
<li>trend: global tendencies e.g.&nbsp;economic activity, fashion</li>
<li>seasonality: e.g.&nbsp;weather, holidays, human habits (sleep)</li>
</ul></li>
<li>Another reason for spurious correlation is small sample size…</li>
</ul>
</section>
<section id="time-series-regressions-trends-and-seasonality" class="slide level2">
<h2>Time series regressions: Trends and seasonality</h2>
<ul>
<li>Trend as confounder example</li>
<li>A regression of the price of college education in the U.S. on the GDP of Germany over the past few decades</li>
<li>Positive slope coefficient even though that two may not be related in any fundamental way.</li>
<li>But US GDP is correlated with both</li>
</ul>
<p>Examples <a href="https://tylervigen.com/spurious-correlations" class="uri">https://tylervigen.com/spurious-correlations</a></p>
</section>
<section id="time-series-regressions-trends-and-seasonality-1" class="slide level2">
<h2>Time series regressions: Trends and seasonality</h2>
<ul>
<li>In a regression, we shall deal with trends
<ul>
<li>Replacing variables in the regression with their first differences
<ul>
<li>Variables in differences – no trends – likely to to be stationary.</li>
<li>Could be log difference for exponential trends</li>
</ul></li>
<li>Could also add trends to model</li>
</ul></li>
<li>In a regression, we shall deal with seasonality
<ul>
<li>Including binary season variables in regressions.</li>
<li>Look at pattern, figure out if quarters, months, weeks, days of week, etc.</li>
<li>Or work with year-on-year (event to event) changes instead of first differences.</li>
</ul></li>
</ul>
</section>
<section id="trend-rw---solution-first-differences" class="slide level2">
<h2>Trend &amp; RW - solution: first differences</h2>
<p><span class="math display">\[\Delta y^E_t = \alpha + \beta \Delta x_t\]</span></p>
<ul>
<li>Coefficients have the same interpretation as before, but relate changes in variables.</li>
<li>Because variables denote changes…
<ul>
<li><span class="math inline">\(\alpha\)</span> is the average change in <span class="math inline">\(y\)</span> when <span class="math inline">\(x\)</span> doesn’t change.</li>
<li>The slope coefficient on <span class="math inline">\(\Delta x_t\)</span> shows how much more <span class="math inline">\(y\)</span> is expected to change when <span class="math inline">\(x\)</span> changes by one <strong>more</strong> unit.</li>
<li>The slope shows how <span class="math inline">\(y\)</span> is expected to change when <span class="math inline">\(x\)</span> changes, in addition to <span class="math inline">\(\alpha\)</span>.</li>
</ul></li>
</ul>
</section>
<section id="seasonality-in-time-series-regressions" class="slide level2">
<h2>Seasonality in time series regressions</h2>
<ul>
<li>Capturing seasonality is also crucial.</li>
<li>Higher the frequency – the more important.
<ul>
<li>People behave differently on different hours and days</li>
<li>Weather varies over months</li>
<li>Holidays, ect</li>
</ul></li>
<li>Have seasonal dummies if seasonality is stable.</li>
</ul>
<p><span class="math display">\[y^E_t = \alpha + \beta x_t + \delta_{Jan} + \delta_{Feb} + \cdots + \delta_{Nov}\]</span></p>
<ul>
<li>Pattern may vary over time. If it does, solutions must capture exact pattern – (difficult, not covering here)</li>
</ul>
</section>
<section id="another-problem-serial-correlation" class="slide level2">
<h2>Another Problem: Serial correlation</h2>
<ul>
<li><p>Serial correlation means correlation of a variable with its previous values</p>
<ul>
<li>It usually refers to the correlation of the residuals with their previous values.</li>
</ul></li>
<li><p>Order serial correlation coefficient is defined as <span class="math display">\[\rho_k = \text{Corr}[x_t, x_{t-k}]\]</span></p></li>
<li><p>If independent variables are serially correlated, usually not a problem.</p></li>
<li><p>If dependent variable is serially correlated (the error), it is a problem.</p></li>
<li><p>Serial correlation makes the usual standard error estimates wrong.</p>
<ul>
<li>Even classical heteroskedasticity robust SE is wrong - sometimes very wrong</li>
</ul></li>
<li><p>More precisely it is serial correlation in residuals, but think about is as serial correlation in <span class="math inline">\(y_t\)</span> is okay</p></li>
</ul>
</section>
<section id="standard-errors-in-time-series-regressions" class="slide level2">
<h2>Standard errors in time series regressions</h2>
<ul>
<li><p>In most time series, there will be <strong>some</strong> serial correlation</p></li>
<li><p>Sol1: Use the <strong>Newey-West</strong> SE: in Stata <code>newey</code> command.</p>
<ul>
<li>This incorporates structure of serial correlation of the regression residuals</li>
<li>Fine if heteroskedasticity as well</li>
<li>Need to specify lags, based on frequency and seasonality</li>
</ul></li>
<li><p>Sol2: Have lagged dependent variable in the regression (one lag is usually enough) <span class="math display">\[y_t = \alpha + \beta x_t + \gamma_1 y_{t-1} + \gamma_2 y_{t-2} \ldots\]</span></p>
<ul>
<li>This will change Coefficients and adjust SEs</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="case-study-b-electricity-consumption-and-temperature" class="title-slide slide level1 center">
<h1>Case study B: Electricity consumption and temperature</h1>

</section>
<section id="electricity-consumption-and-temperature" class="slide level2">
<h2>Electricity consumption and temperature</h2>
<ul>
<li>We have access to monthly weather and electricity data for Phoenix, Arizona: Overall 204 month</li>
<li>Also access to “cooling degree days” and “heating degree days” data</li>
<li>The <strong>cooling degree days</strong> measure Number of degrees that a day’s average temperature is above 65F (18C). This is add up over the month.</li>
<li>Similar for <strong>heating degree days</strong> but below 65F (18C)</li>
<li>Access to Electricity consumption data over the month</li>
<li>As expected, this values will be seasonal.</li>
</ul>
</section>
<section id="cs-modelling-decisions" class="slide level2">
<h2>CS: Modelling decisions</h2>
<ul>
<li>There is an exponential trend in electricity –&gt; use log difference</li>
<li>For easier interpretation, take first difference (FD) of cooling and heating days</li>
<li><strong>Natural question</strong>: How much does electricity consumption change when temperature changes?</li>
<li>Add monthly dummies, January (December to January) is reference</li>
<li>Use Newey-West standard errors</li>
</ul>
</section>
<section id="model-estimates" class="slide level2">
<h2>Model estimates</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>Variables</th>
<th>(1)</th>
<th>(2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\Delta\)</span>CD</td>
<td>0.031**</td>
<td>0.017**</td>
</tr>
<tr class="even">
<td></td>
<td>(0.001)</td>
<td>(0.002)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\Delta\)</span>HD</td>
<td>0.037**</td>
<td>0.014**</td>
</tr>
<tr class="even">
<td></td>
<td>(0.003)</td>
<td>(0.003)</td>
</tr>
<tr class="odd">
<td>month = 2, February</td>
<td></td>
<td>-0.274**</td>
</tr>
<tr class="even">
<td>month = 3, March</td>
<td></td>
<td>-0.122**</td>
</tr>
<tr class="odd">
<td>…</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Constant</td>
<td>0.001</td>
<td>0.092**</td>
</tr>
<tr class="odd">
<td></td>
<td>(0.002)</td>
<td>(0.013)</td>
</tr>
<tr class="even">
<td>Observations</td>
<td>203</td>
<td>203</td>
</tr>
</tbody>
</table>
</section>
<section id="model-results" class="slide level2">
<h2>Model results</h2>
<ul>
<li>Simple (1) model:
<ul>
<li>In months when cooling degrees increase by one degree and heating degrees do not change, electricity consumption increases by 3.1 percent, on average.</li>
<li>When heating degrees increase by one degree and cooling degrees do not change, electricity consumption increases by 3.7 percent, on average.</li>
</ul></li>
<li>Model (2) with monthly dummies.
<ul>
<li>The reference month is January: constant (when cooling and heating degrees stay the same), electricity consumption increases by about 9% from December to January.</li>
<li>The other season coefficients compare to this change:
<ul>
<li>February: the January to February change is 28 percentage points lower than in the reference month, December to January.</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="electricity-consumption-and-temperature-different-se-estimates" class="slide level2">
<h2>Electricity consumption and temperature – different SE estimates</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>Variables</th>
<th>(1)</th>
<th>(2)</th>
<th>(3)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>Simple SE</td>
<td>Newey–West SE</td>
<td>Lagged dep.var</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\Delta\)</span>CD</td>
<td>0.017**</td>
<td>0.017**</td>
<td>0.017**</td>
</tr>
<tr class="odd">
<td></td>
<td>(0.002)</td>
<td>(0.002)</td>
<td>(0.002)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\Delta\)</span>HD</td>
<td>0.014**</td>
<td>0.014**</td>
<td>0.014**</td>
</tr>
<tr class="odd">
<td></td>
<td>(0.002)</td>
<td>(0.003)</td>
<td>(0.002)</td>
</tr>
<tr class="even">
<td>Lag of <span class="math inline">\(\Delta\)</span> ln Q</td>
<td></td>
<td></td>
<td>-0.002</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td>(0.062)</td>
</tr>
<tr class="even">
<td>Month dummies</td>
<td>YES</td>
<td>YES</td>
<td>YES</td>
</tr>
<tr class="odd">
<td>Observations</td>
<td>203</td>
<td>203</td>
<td>202</td>
</tr>
<tr class="even">
<td>R-squared</td>
<td>0.951</td>
<td>0.951</td>
<td></td>
</tr>
<tr class="odd">
<td>Standard errors in parentheses</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>** p&lt;0.01, * p&lt;0.05</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="electricity-consumption-and-temperature-different-se-estimates-1" class="slide level2">
<h2>Electricity consumption and temperature – different SE estimates</h2>
<ul>
<li>To correct for serial correlation, compare simple SE model with two correctly specified models
<ul>
<li>with Newey-West SE</li>
<li>with Lagged dependent variable</li>
</ul></li>
<li>SE marginally different, and with lagged values, coefficients are also similar up to 3 digits
<ul>
<li><strong>Similar, not the same</strong></li>
<li>Sometimes substantial difference (if strong serial correlation)</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="propagation-effect" class="title-slide slide level1 center">
<h1>Propagation effect</h1>

</section>
<section id="propagation-effect-changes-and-lags---fdl-model" class="slide level2">
<h2>Propagation effect: changes and lags - FDL model</h2>
<p>In time series, we can analyze how an impact builds up across several periods (time-to-build):</p>
<p><span class="math display">\[\Delta y^E_t = \alpha + \beta_0 \Delta x_t + \beta_1 \Delta x_{t-1} + \beta_2 \Delta x_{t-2}\]</span></p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> = how many units more <span class="math inline">\(y\)</span> is expected to change within the same time period when <span class="math inline">\(x\)</span> changes by one more unit (No change before or after).</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> = how much more <span class="math inline">\(y\)</span> is expected to change in the next time period after <span class="math inline">\(x\)</span> changed by one more unit.</p></li>
<li><p>Cumulative effect: <span class="math inline">\(\beta_\text{cumul} = \beta_0 + \beta_1 + \beta_2\)</span></p></li>
<li><p><span class="math inline">\(\beta_k\)</span> are the short-term effects, <span class="math inline">\(\beta_\text{cumul}\)</span> is the cumulative effect/Long Term Effect.</p></li>
</ul>
</section>
<section id="testing-the-cumulative-effect" class="slide level2">
<h2>Testing the cumulative effect</h2>
<ul>
<li>To get a SE on the cumulative effect, do a trick and transformation, and estimate a different model</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\Delta y^E_t &amp;= \alpha + \beta_0 \Delta x_t + \beta_1 \Delta x_{t-1} + \beta_2 \Delta x_{t-2} \\
\Delta y^E_t &amp;= \alpha + (\beta_\text{cumul} - \beta_1 - \beta_2) \Delta x_t + \beta_1 \Delta x_{t-1} + \beta_2 \Delta x_{t-2} \\
\Delta y^E_t &amp;= \alpha + \beta_\text{cumul} \Delta x_t + \beta_1 (\Delta x_{t-1}- \Delta x_t) + \beta_2 (\Delta x_{t-2} - \Delta x_t)\\
\Delta y^E_t &amp;= \alpha + \beta_\text{cumul} \Delta x_{t} + \delta_0 \Delta(\Delta x_t) + \delta_1 \Delta(\Delta x_{t-1})
\end{aligned}\]</span></p>
<ul>
<li><span class="math inline">\(\beta_\text{cumul}\)</span> is exactly the same as <span class="math inline">\(\beta_0 + \beta_1 + \beta_2\)</span></li>
<li>Usually estimate both. Separate and cumulative effect</li>
<li>Often need a few lags</li>
</ul>
</section>
<section id="propagation-effect-changes-and-lags---fdl-model-1" class="slide level2">
<h2>Propagation effect: changes and lags - FDL model</h2>
<p>See Case Study in Chapter 12</p>
</section>
<section id="summary-of-the-process" class="slide level2">
<h2>Summary of the process</h2>
<ul>
<li>Decide on frequency; deal with gaps if necessary.</li>
<li>Plot the series. Identify features and issues.</li>
<li>Handle trends by transforming variables (Often: first difference <code>d.</code>).</li>
<li>Specify regression that handles seasonality, usually by including season dummies.</li>
<li>Include or don’t include lags of the right-hand-side variable(s).</li>
<li>Handle serial correlation. <code>newey</code> or lagged dependent variable.</li>
<li>Interpret coefficients in a way that pays attention to potential trend and seasonality.</li>
<li>Time series econometrics very complicated beyond this.</li>
<li>But: These steps often good enough.</li>
</ul>
</section>
<section id="main-takeaways" class="slide level2">
<h2>Main takeaways</h2>
<ul>
<li>Regressions with time series data allow for additional opportunities, but they pose additional challenges, too</li>
<li>Regressions with time series data help uncover associations from changes and associations across time</li>
<li>Trend, seasonality, and random walk-like non-stationarity are additional challenges</li>
<li>Do not regress variables that have trend or seasonality; without dealing with them they produce spurious results</li>
</ul>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><em>Rios-Avila and Cia</em></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1200,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>