<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Fernando Rios-Avila">
<meta name="dcterms.date" content="2024-09-30">

<title>Origins of Data, and Data Preparation – Econometrics MSC Levy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Econometrics MSC Levy</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Origins of Data, and Data Preparation</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Courses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../adv_class/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advance Econometrics: Causal Effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../rmethods/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Methods: Econometrics I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../rmethods2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Methods II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../rm-data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Methods I: Data Analysis for Economics and Policy</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Math Refresher</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mathref/math_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Math Refresher</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mathref/math_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Math Refresher</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mathref/math_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Math Refresher</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation">Motivation</a></li>
  <li><a href="#what-is-data" id="toc-what-is-data" class="nav-link" data-scroll-target="#what-is-data">What is data ?</a>
  <ul class="collapse">
  <li><a href="#what-is-data-0s-and-1s" id="toc-what-is-data-0s-and-1s" class="nav-link" data-scroll-target="#what-is-data-0s-and-1s">What is data ? 0s and 1s…</a></li>
  <li><a href="#what-is-data-1" id="toc-what-is-data-1" class="nav-link" data-scroll-target="#what-is-data-1">What is data ?</a></li>
  <li><a href="#data-structures" id="toc-data-structures" class="nav-link" data-scroll-target="#data-structures">Data structures</a></li>
  <li><a href="#data-structures-panel-xt-data" id="toc-data-structures-panel-xt-data" class="nav-link" data-scroll-target="#data-structures-panel-xt-data">Data structures: Panel (xt) data</a></li>
  </ul></li>
  <li><a href="#data-quality" id="toc-data-quality" class="nav-link" data-scroll-target="#data-quality">Data Quality</a>
  <ul class="collapse">
  <li><a href="#data-quality-is-key" id="toc-data-quality-is-key" class="nav-link" data-scroll-target="#data-quality-is-key">Data quality is key</a></li>
  <li><a href="#dimensions-of-data-quality" id="toc-dimensions-of-data-quality" class="nav-link" data-scroll-target="#dimensions-of-data-quality">Dimensions of data quality</a></li>
  <li><a href="#you-should-allways-know-your-data" id="toc-you-should-allways-know-your-data" class="nav-link" data-scroll-target="#you-should-allways-know-your-data"><strong>YOU</strong> should allways know your data</a></li>
  </ul></li>
  <li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection">Data collection</a>
  <ul class="collapse">
  <li><a href="#secondary-data-general-characteristics" id="toc-secondary-data-general-characteristics" class="nav-link" data-scroll-target="#secondary-data-general-characteristics">Secondary data: General characteristics</a></li>
  <li><a href="#how-to-collect-the-data" id="toc-how-to-collect-the-data" class="nav-link" data-scroll-target="#how-to-collect-the-data">How to Collect the Data</a></li>
  <li><a href="#how-to-collect-the-data-1" id="toc-how-to-collect-the-data-1" class="nav-link" data-scroll-target="#how-to-collect-the-data-1">How to Collect the Data</a></li>
  <li><a href="#administrative-data-general-characteristics" id="toc-administrative-data-general-characteristics" class="nav-link" data-scroll-target="#administrative-data-general-characteristics">Administrative Data: General Characteristics</a></li>
  </ul></li>
  <li><a href="#survey-and-sampling" id="toc-survey-and-sampling" class="nav-link" data-scroll-target="#survey-and-sampling">Survey and sampling</a>
  <ul class="collapse">
  <li><a href="#survey-general-characteristics" id="toc-survey-general-characteristics" class="nav-link" data-scroll-target="#survey-general-characteristics">Survey: General characteristics</a></li>
  <li><a href="#sampling" id="toc-sampling" class="nav-link" data-scroll-target="#sampling">Sampling</a></li>
  <li><a href="#what-we-want-representative-samples" id="toc-what-we-want-representative-samples" class="nav-link" data-scroll-target="#what-we-want-representative-samples">What We Want: Representative samples</a></li>
  <li><a href="#how-can-we-tell-if-a-sample-is-representative" id="toc-how-can-we-tell-if-a-sample-is-representative" class="nav-link" data-scroll-target="#how-can-we-tell-if-a-sample-is-representative">How can we tell if a sample is representative</a></li>
  <li><a href="#sampling-random-sampling" id="toc-sampling-random-sampling" class="nav-link" data-scroll-target="#sampling-random-sampling">Sampling: Random sampling</a></li>
  <li><a href="#random-sampling-is-best" id="toc-random-sampling-is-best" class="nav-link" data-scroll-target="#random-sampling-is-best">Random sampling is <strong>best</strong></a></li>
  <li><a href="#sampling-clusterstratified-sampling" id="toc-sampling-clusterstratified-sampling" class="nav-link" data-scroll-target="#sampling-clusterstratified-sampling">Sampling: Cluster/Stratified sampling</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#what-is-different-with-big-data" id="toc-what-is-different-with-big-data" class="nav-link" data-scroll-target="#what-is-different-with-big-data">What is different with Big Data?</a></li>
  <li><a href="#different-yet-the-same" id="toc-different-yet-the-same" class="nav-link" data-scroll-target="#different-yet-the-same">Different yet the same</a></li>
  </ul></li>
  <li><a href="#other-aspects-to-consider" id="toc-other-aspects-to-consider" class="nav-link" data-scroll-target="#other-aspects-to-consider">Other Aspects to consider</a>
  <ul class="collapse">
  <li><a href="#sample-selection-bias" id="toc-sample-selection-bias" class="nav-link" data-scroll-target="#sample-selection-bias">Sample selection bias</a></li>
  <li><a href="#legal-and-ethical-aspects" id="toc-legal-and-ethical-aspects" class="nav-link" data-scroll-target="#legal-and-ethical-aspects">Legal and ethical aspects</a></li>
  <li><a href="#ai-and-data-collection-wrangling" id="toc-ai-and-data-collection-wrangling" class="nav-link" data-scroll-target="#ai-and-data-collection-wrangling">AI and data collection, wrangling</a></li>
  <li><a href="#main-takeaway" id="toc-main-takeaway" class="nav-link" data-scroll-target="#main-takeaway">Main takeaway</a></li>
  </ul></li>
  <li><a href="#break" id="toc-break" class="nav-link" data-scroll-target="#break"><strong>Break</strong></a></li>
  <li><a href="#preparing-the-data" id="toc-preparing-the-data" class="nav-link" data-scroll-target="#preparing-the-data">Preparing the Data</a>
  <ul class="collapse">
  <li><a href="#motivation-1" id="toc-motivation-1" class="nav-link" data-scroll-target="#motivation-1">Motivation</a></li>
  </ul></li>
  <li><a href="#variables" id="toc-variables" class="nav-link" data-scroll-target="#variables">Variables</a>
  <ul class="collapse">
  <li><a href="#variable-types-qualitative-vs-quantitative" id="toc-variable-types-qualitative-vs-quantitative" class="nav-link" data-scroll-target="#variable-types-qualitative-vs-quantitative">Variable types: Qualitative vs quantitative</a></li>
  <li><a href="#variable-types-dummies-or-binary" id="toc-variable-types-dummies-or-binary" class="nav-link" data-scroll-target="#variable-types-dummies-or-binary">Variable types: Dummies or binary</a></li>
  <li><a href="#variable-types---formal-definition" id="toc-variable-types---formal-definition" class="nav-link" data-scroll-target="#variable-types---formal-definition">Variable types - formal definition</a></li>
  </ul></li>
  <li><a href="#data-wrangling-cleaning" id="toc-data-wrangling-cleaning" class="nav-link" data-scroll-target="#data-wrangling-cleaning">Data Wrangling &amp; Cleaning</a>
  <ul class="collapse">
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling</a></li>
  <li><a href="#the-tidy-data-approach" id="toc-the-tidy-data-approach" class="nav-link" data-scroll-target="#the-tidy-data-approach">The tidy data approach</a></li>
  <li><a href="#simple-tidy-data-table" id="toc-simple-tidy-data-table" class="nav-link" data-scroll-target="#simple-tidy-data-table">Simple tidy data table</a></li>
  <li><a href="#tidy-data-table-of-multi-dimensional-data" id="toc-tidy-data-table-of-multi-dimensional-data" class="nav-link" data-scroll-target="#tidy-data-table-of-multi-dimensional-data">Tidy data table of multi-dimensional data</a></li>
  <li><a href="#displaying-immunization-rates-across-countries---wide" id="toc-displaying-immunization-rates-across-countries---wide" class="nav-link" data-scroll-target="#displaying-immunization-rates-across-countries---wide">Displaying immunization rates across countries - WIDE</a></li>
  <li><a href="#displaying-immunization-rates-across-countries---long" id="toc-displaying-immunization-rates-across-countries---long" class="nav-link" data-scroll-target="#displaying-immunization-rates-across-countries---long">Displaying immunization rates across countries - LONG</a></li>
  <li><a href="#stata-programming-corner" id="toc-stata-programming-corner" class="nav-link" data-scroll-target="#stata-programming-corner">Stata Programming corner</a></li>
  <li><a href="#stata-programming-corner-1" id="toc-stata-programming-corner-1" class="nav-link" data-scroll-target="#stata-programming-corner-1">Stata Programming corner</a></li>
  <li><a href="#a-complex-dataset-relational-database" id="toc-a-complex-dataset-relational-database" class="nav-link" data-scroll-target="#a-complex-dataset-relational-database">A complex Dataset: Relational database</a></li>
  <li><a href="#identifying-successful-futbol-managers" id="toc-identifying-successful-futbol-managers" class="nav-link" data-scroll-target="#identifying-successful-futbol-managers">Identifying successful Futbol managers</a></li>
  <li><a href="#american-time-use-survey" id="toc-american-time-use-survey" class="nav-link" data-scroll-target="#american-time-use-survey">American Time Use Survey</a></li>
  <li><a href="#american-time-use-survey-1" id="toc-american-time-use-survey-1" class="nav-link" data-scroll-target="#american-time-use-survey-1">American Time Use Survey</a></li>
  <li><a href="#stata-corner-types-of-merging" id="toc-stata-corner-types-of-merging" class="nav-link" data-scroll-target="#stata-corner-types-of-merging">Stata-Corner: Types of Merging</a></li>
  <li><a href="#stata-corner" id="toc-stata-corner" class="nav-link" data-scroll-target="#stata-corner">Stata-Corner</a></li>
  <li><a href="#complex-data---tidy-data-summary" id="toc-complex-data---tidy-data-summary" class="nav-link" data-scroll-target="#complex-data---tidy-data-summary">Complex data - tidy data: summary</a></li>
  </ul></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data cleaning</a>
  <ul class="collapse">
  <li><a href="#data-cleaning-1" id="toc-data-cleaning-1" class="nav-link" data-scroll-target="#data-cleaning-1">Data cleaning</a></li>
  <li><a href="#dealing-with-duplicates" id="toc-dealing-with-duplicates" class="nav-link" data-scroll-target="#dealing-with-duplicates">Dealing with duplicates</a></li>
  <li><a href="#entity-identification-and-resolution" id="toc-entity-identification-and-resolution" class="nav-link" data-scroll-target="#entity-identification-and-resolution">Entity identification and resolution</a></li>
  <li><a href="#entity-resolution-example" id="toc-entity-resolution-example" class="nav-link" data-scroll-target="#entity-resolution-example">Entity resolution example</a></li>
  <li><a href="#getting-rid-of-non-entity-observations" id="toc-getting-rid-of-non-entity-observations" class="nav-link" data-scroll-target="#getting-rid-of-non-entity-observations">Getting rid of non-entity observations</a></li>
  </ul></li>
  <li><a href="#missing-data" id="toc-missing-data" class="nav-link" data-scroll-target="#missing-data">Missing Data</a>
  <ul class="collapse">
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values">Missing values</a></li>
  <li><a href="#missing-values-what-to-do" id="toc-missing-values-what-to-do" class="nav-link" data-scroll-target="#missing-values-what-to-do">Missing values: What to do?</a></li>
  <li><a href="#missing-values-understanding-the-selection-process" id="toc-missing-values-understanding-the-selection-process" class="nav-link" data-scroll-target="#missing-values-understanding-the-selection-process">Missing values: Understanding the selection process</a></li>
  <li><a href="#missing-values-what-can-we-do" id="toc-missing-values-what-can-we-do" class="nav-link" data-scroll-target="#missing-values-what-can-we-do">Missing values: what can we do?</a></li>
  <li><a href="#missing-values-some-practical-advice" id="toc-missing-values-some-practical-advice" class="nav-link" data-scroll-target="#missing-values-some-practical-advice">Missing values: Some practical advice</a></li>
  <li><a href="#more-on-data-cleaning" id="toc-more-on-data-cleaning" class="nav-link" data-scroll-target="#more-on-data-cleaning">More on Data Cleaning</a></li>
  <li><a href="#data-wrangling-cooking-recipe" id="toc-data-wrangling-cooking-recipe" class="nav-link" data-scroll-target="#data-wrangling-cooking-recipe">Data wrangling: Cooking recipe</a></li>
  <li><a href="#ai-and-data-wrangling-upside" id="toc-ai-and-data-wrangling-upside" class="nav-link" data-scroll-target="#ai-and-data-wrangling-upside">AI and data wrangling: Upside</a></li>
  </ul></li>
  <li><a href="#thats-all-for-today" id="toc-thats-all-for-today" class="nav-link" data-scroll-target="#thats-all-for-today">Thats all for today</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="week02.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Origins of Data, and Data Preparation</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Fernando Rios-Avila </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Levy Economics Institute
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 30, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="motivation" class="level2">
<h2 class="anchored" data-anchor-id="motivation">Motivation</h2>
<ul>
<li>Suppose, you want to understand the extent and patterns of differences in online and offline prices. How would you go about collecting data?
<ul>
<li>A super project, the Billion Prices Project at MIT did a variety of data collection approaches such as crowd-sourcing platforms, mobile phone apps and web scraping methods.</li>
</ul></li>
<li>Interested in understanding more about management practices?
<ul>
<li>The World Management Survey is a major effort by academics to survey practices around the world - asking the same questions in many countries the same way.</li>
</ul></li>
</ul>
</section>
<section id="what-is-data" class="level1">
<h1>What is data ?</h1>
<section id="what-is-data-0s-and-1s" class="level2">
<h2 class="anchored" data-anchor-id="what-is-data-0s-and-1s">What is data ? 0s and 1s…</h2>
<ul>
<li>Data is a collection of numbers, characters, images, or other formats.</li>
<li>They provide information about <strong>something</strong>. (Prices? Management practices? Hotel characteristics? etc.)</li>
<li>Of course, depending on how the data was collected, and what structure it has, it can be more or less useful for answering a particular question.</li>
</ul>
</section>
<section id="what-is-data-1" class="level2">
<h2 class="anchored" data-anchor-id="what-is-data-1">What is data ?</h2>
<p>As Economist, we are more familiar with a specific data structure:</p>
<ul>
<li>Data is most straightforward to analyze if it is in a <strong><em>data table</em></strong> form (2D Matrix form):
<ul>
<li>A single <em>file</em> with rows and columns.</li>
<li>Each row is an observation, and each column is a variable.</li>
</ul></li>
<li>How do you find it in the real world?1
<ul>
<li>Storage: Comma separated values .csv (.txt) is simplest, but other formats are possible</li>
<li>Stata (.dta), SPSS (.sav), R (.rda), Python (.pkl), etc.</li>
</ul></li>
<li>A Dataset is a collection of data tables that may be related to each other.</li>
</ul>
</section>
<section id="data-structures" class="level2">
<h2 class="anchored" data-anchor-id="data-structures">Data structures</h2>
<p>Aside from “format”, data can be structured in different ways:</p>
<ul>
<li><strong>Cross-sectional</strong> (<em>xsec</em>) data have information on many units observed at the same time</li>
<li><strong>Time series</strong> (<em>tseries</em>) data have information on a single unit observed many times</li>
<li><strong>Multi-dimensional</strong> (<em>panel</em>?) data have multiple dimensions (the observations)</li>
</ul>
</section>
<section id="data-structures-panel-xt-data" class="level2">
<h2 class="anchored" data-anchor-id="data-structures-panel-xt-data">Data structures: Panel (xt) data</h2>
<p><strong>Multi-dimensional: Panel data</strong> is of particular interest in economics:</p>
<ul>
<li>A common type of <strong>panel data</strong> has many units, each observed multiple times
<ul>
<li>countries observed repeatedly for several years</li>
</ul></li>
<li>In <strong>xt</strong> data tables observations are identified by two ID variables: one for the cross-sectional units, one for time</li>
<li><strong>xt</strong> data is balanced if all cross-sectional units are observed at the very same time periods</li>
<li>It is called unbalanced if some cross-sectional units are observed more times than others</li>
</ul>
</section>
</section>
<section id="data-quality" class="level1">
<h1>Data Quality</h1>
<p>Not all data is created equal</p>
<section id="data-quality-is-key" class="level2">
<h2 class="anchored" data-anchor-id="data-quality-is-key">Data quality is key</h2>
<ul>
<li><strong>Keyword</strong>: Quality, Quality, Quality</li>
<li>Data quality is key for any analysis
<ul>
<li><strong>Garbage-in-garbage-out</strong>: If data is <em>useless</em>, then answers of our analysis are bound to be useless…</li>
<li>… no matter how fancy a method we apply to it.</li>
</ul></li>
<li>Data quality is generally a subjective notion: Different standards for different purposes</li>
<li>First you have to specify what is your (research) question:
<ul>
<li>What do you want to explore or understand?</li>
</ul></li>
<li>If you have a clear (pseudo) answer, then you can decide on your data quality</li>
</ul>
<div class="incremental">
<ul class="incremental">
<li>However, there are some objective measures to decide if you have your question</li>
</ul>
</div>
</section>
<section id="dimensions-of-data-quality" class="level2">
<h2 class="anchored" data-anchor-id="dimensions-of-data-quality">Dimensions of data quality</h2>
<ol type="1">
<li><strong>Content</strong> - what is the variable really capturing?</li>
<li><strong>Validity</strong> - how close the actual content of the variable to the intended content</li>
<li><strong>Reliability</strong> - if we were to measure the same variable multiple times for the same observation it should give the same result</li>
<li><strong>Comparability of measurement</strong> - how similarly the same variable is measured across different observations</li>
<li><strong>Coverage</strong> - what proportion of the population are represented in the data</li>
<li><strong>Unbiased selection</strong> - if coverage is incomplete, is it representative of the population?</li>
</ol>
<div class="notes">
<p>How was the data collected??</p>
<p>Does the variable capture what it is supposed to capture? are labels correct? is the variable measured correctly? (is =1 a true or a false?)</p>
</div>
</section>
<section id="you-should-allways-know-your-data" class="level2">
<h2 class="anchored" data-anchor-id="you-should-allways-know-your-data"><strong>YOU</strong> should allways know your data</h2>
<ul>
<li>How data was born? How was it collected, and processed?</li>
<li>All details of measurement that may be relevant for their analysis
<ul>
<li>When in doubt, ask the data source. Manuals, codebooks, etc.</li>
</ul></li>
<li>Because of this, you may want to have a:
<ul>
<li><code>README.txt</code> that describes where dataset comes from</li>
<li><code>VARIABLES.xls</code> that provides basic information on your variables (cookbook)</li>
</ul></li>
</ul>
</section>
</section>
<section id="data-collection" class="level1">
<h1>Data collection</h1>
<p>How was the data Born?</p>
<section id="secondary-data-general-characteristics" class="level2">
<h2 class="anchored" data-anchor-id="secondary-data-general-characteristics">Secondary data: General characteristics</h2>
<ul>
<li><strong>Type</strong>: Data, or information, collected by someone else, for different purposes
<ul>
<li>Tax records collects do not contain demographics and education.</li>
<li>A Survey that collects Demographics, but not income data.</li>
</ul></li>
<li><strong>Data quality</strong> consequences
<ul>
<li>May not contain variables that we need</li>
<li>Validity may be high or low</li>
<li>Potential selection bias if low covarege</li>
</ul></li>
<li><strong>Frequent advantages</strong>
<ul>
<li>Inexpensive?</li>
<li>Often many observations</li>
</ul></li>
</ul>
<div class="notes">
<ul>
<li>Secondary data is data that was collected by someone else for a different purpose</li>
<li>We cant control how the data was collected, but we can control how we use it. You need to assume that the data is not perfect. And assume consequences of that.</li>
</ul>
</div>
</section>
<section id="how-to-collect-the-data" class="level2">
<h2 class="anchored" data-anchor-id="how-to-collect-the-data">How to Collect the Data</h2>
<ul>
<li><strong>By hand</strong>:
<ul>
<li>Many data sources are available online: World Bank and IMF data, etc. (usually easy to download)</li>
<li>For the US, <a href="https://www.ipums.org">www.ipums.org</a> has a lot of standardized data (CPS, ATUS, ACS, etc.)</li>
</ul></li>
<li>Automated <strong>API</strong>:
<ul>
<li>Many agencies also offer API (Application Programming Interface) to directly load data into a statistical software</li>
<li>API widely used in many context. see <a href="https://guides.lib.berkeley.edu/c.php?g=4395&amp;p=7995952">here</a> for a list from Berkeley</li>
</ul></li>
</ul>
</section>
<section id="how-to-collect-the-data-1" class="level2">
<h2 class="anchored" data-anchor-id="how-to-collect-the-data-1">How to Collect the Data</h2>
<ul>
<li>Data from online platform (<strong>web scraping</strong>):
<ul>
<li>html code includes data, that can be collected and analyzed</li>
<li>R (rvest) and Python (beautiful soup) can be used for that purpose</li>
<li>Stata does not have good tools for web scraping</li>
</ul></li>
<li><strong>Need extensive cleaning</strong></li>
<li>Can be repeated (automated) if data is updated frequently
<ul>
<li>Mindful of the terms of service of the website</li>
</ul></li>
<li>Data collection limited to what is on a site</li>
</ul>
<div class="notes">
<ul>
<li>Web scraping is a powerful tool that needs a know-how, and requires extensive cleaning</li>
<li>Web scraping is limited to what is on a site</li>
<li>Always be mindful of the terms of service of the website. Not all websites allow web scraping</li>
</ul>
</div>
</section>
<section id="administrative-data-general-characteristics" class="level2">
<h2 class="anchored" data-anchor-id="administrative-data-general-characteristics">Administrative Data: General Characteristics</h2>
<ul>
<li>Business transactions, Government records, taxes, social security</li>
<li><strong>Many advantages</strong>
<ul>
<li>Often great coverage (Census), few missing values, high quality content (tax records)</li>
<li>Many well defined and documented variables</li>
</ul></li>
<li><strong>Some disadvantages</strong>
<ul>
<li>Defined for a different purpose, not your research question</li>
<li>Often not detailed/specific enough</li>
<li><strong>Biggest</strong> problem is very <strong><em>limited access</em></strong>: Need to apply for access</li>
</ul></li>
</ul>
</section>
</section>
<section id="survey-and-sampling" class="level1">
<h1>Survey and sampling</h1>
<p>If you ask (few), they <em>may</em> answer</p>
<section id="survey-general-characteristics" class="level2">
<h2 class="anchored" data-anchor-id="survey-general-characteristics">Survey: General characteristics</h2>
<ul>
<li>Surveys collect data by asking people (respondents) and recording their answers</li>
<li>Answers should be short(!) and easily(!) transformed into variables</li>
<li><strong>Major advantage</strong>: you can ask what you want to know</li>
<li>How?
<ul>
<li>self-administered surveys and interviews</li>
<li>Web, telephone, in person, mix - computer aided interview</li>
</ul></li>
<li>What could go wrong? (and assume <strong><em>House MD</em></strong> is wrong)</li>
</ul>
<div class="notes">
<p>Choice of data collection approach matters a great deal. Can be done efficiently, with good aids. And depending on design, can be cheap</p>
</div>
</section>
<section id="sampling" class="level2">
<h2 class="anchored" data-anchor-id="sampling">Sampling</h2>
<ul>
<li><p>Perhaps one can collect data on all observations we want (the population)</p></li>
<li><p>but, more often we don’t because it’s impractical or prohibitively expensive</p></li>
<li><p><strong>Sampling</strong> is when we purposefully collect data on a subset/sample (<span class="math inline">\(&lt;100%\)</span> coverage) of the population</p></li>
<li><p><strong>Sampling</strong> is the <strong>process</strong> that selects that subset (How do we select the sample?)</p></li>
</ul>
</section>
<section id="what-we-want-representative-samples" class="level2">
<h2 class="anchored" data-anchor-id="what-we-want-representative-samples">What We Want: Representative samples</h2>
<ul>
<li>A sample is <span class="blue"><em>good</em></span> if it represents the population
<ul>
<li>all <strong>important</strong> variables have very similar distributions in the sample and the population</li>
<li>all <strong>patterns</strong> in the sample are very similar to the patterns in the population</li>
</ul></li>
<li>Examples
<ul>
<li>The age distribution of a sample of employees is the same as the age distribution of all employees</li>
<li>The income distribution in the CPS is the same as the income distribution in the US</li>
</ul></li>
<li>But how can we tell?</li>
</ul>
</section>
<section id="how-can-we-tell-if-a-sample-is-representative" class="level2">
<h2 class="anchored" data-anchor-id="how-can-we-tell-if-a-sample-is-representative">How can we tell if a sample is representative</h2>
<ul>
<li>Never for sure
<ul>
<li>If you knew the population, you wouldn’t need the sample</li>
<li>We know the patterns in the sample but not in the population</li>
</ul></li>
<li>But, we could do Benchmarking
<ul>
<li>We may know <strong>a few</strong> distributions or patterns in the population</li>
<li>Those should be similar in the sample</li>
<li>Example: Using the Census to check the age distribution in the CPS</li>
</ul></li>
<li>Or, knowing the process of sampling
<ul>
<li>Random sampling is known to lead to representative samples with high likelihood</li>
</ul></li>
</ul>
</section>
<section id="sampling-random-sampling" class="level2">
<h2 class="anchored" data-anchor-id="sampling-random-sampling">Sampling: Random sampling</h2>
<ul>
<li><strong>Random sampling</strong> is a selection rule <span class="red"><strong><em>independent</em></strong></span> of any important variable
<ul>
<li>its the most likely to produce representative samples</li>
<li>Any other methods may lead to biased selection</li>
</ul></li>
<li>Examples
<ul>
<li>Good: people with odd-numbered birth dates (a 50% sample)</li>
<li>Good: the first half of a list of firms <strong>sorted</strong> by a random number generated by the computer</li>
<li>Bad: the first half of a list of people by alphabetical order</li>
<li>Bad: firms that were established in the most recent years</li>
</ul></li>
</ul>
</section>
<section id="random-sampling-is-best" class="level2">
<h2 class="anchored" data-anchor-id="random-sampling-is-best">Random sampling is <strong>best</strong></h2>
<ul>
<li>Provided sample is large enough (N <span class="math inline">\(\rightarrow\)</span> infinity)</li>
<li>In small samples (dozens) anything is possible</li>
<li>In a representative sample, size (N) matters, not coverage
<ul>
<li>CPS ~ 70,000 households (0.02% of US); ATUS ~ 9,000 ppl (0.003% of US)</li>
</ul></li>
<li>Larger samples better (more power/precise estimates) but …</li>
</ul>
</section>
<section id="sampling-clusterstratified-sampling" class="level2">
<h2 class="anchored" data-anchor-id="sampling-clusterstratified-sampling">Sampling: Cluster/Stratified sampling</h2>
<ul>
<li>Some times, however, random sampling is prohibitively expensive.</li>
<li>Furthermore, sometimes we want to oversample some groups (rare groups), to make sure we have enough observations</li>
<li>Both approaches may help to reduce costs of collection.</li>
</ul>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<!--# 
This is the code used for the following:

clear
set obs 2000
gen r0 = runiform() 
gen r1 = 0.5*(runiform() +r0)
gen r2 = 0.5*(runiform() +r0)
scatter r1 r2, xlabel("",nogrid) ylabel("",nogrid) ///
               yscale(noline) xscale(noline)  ///
               ytitle("") xtitle("") aspect(1) ///
               ysize(6) xsize(6)
cluster kmeans r1 r2, k(100) name(qr0)
bysort qr0: gen sel2 = runiform()
bysort qr0: gen sel = sel2[1]<.1
drop sel2
                            
               
gen qr1 = floor(r1*10)+1
gen qr2 = floor(r2*10)+1
gen rx = runiform()
sort qr1 qr2 rx
by qr1 qr2 :gen sel2 = _n<=(0.1*_N)
by qr1 qr2 :replace sel2 = 1 if _n==1
set scheme white2
two (scatter r1 r2,  mcolor(%40)) (scatter r1 r2 if runiform()<.1, msize(2) mcolor(%70) ) ///
               , xlabel("",nogrid) ylabel("",nogrid) ///
               yscale(noline) xscale(noline)  ///
               ytitle("") xtitle("") aspect(1) ///
               ysize(6) xsize(6) legend(off)  xline(0(.1)1) yline(0(.1)1)            
graph export "C:\Users\Fernando\Documents\GitHub\rm-data-analysis\Slides\images\paste-1.png", replace        
two (scatter r1 r2,  mcolor(%40)) (scatter r1 r2 if sel, msize(2) mcolor(%70) ) ///
               , xlabel("",nogrid) ylabel("",nogrid) ///
               yscale(noline) xscale(noline)  ///
               ytitle("") xtitle("") aspect(1) ///
               ysize(6) xsize(6) legend(off)  xline(0(.1)1) yline(0(.1)1)
graph export "C:\Users\Fernando\Documents\GitHub\rm-data-analysis\Slides\images\paste-2.png", replace 
two (scatter r1 r2,  mcolor(%40)) (scatter r1 r2 if sel2, msize(2) mcolor(%70) ) ///
               , xlabel("",nogrid) ylabel("",nogrid) ///
               yscale(noline) xscale(noline)  ///
               ytitle("") xtitle("") aspect(1) ///
               ysize(6) xsize(6) legend(off) xline(0(.1)1) yline(0(.1)1)
graph export "C:\Users\Fernando\Documents\GitHub\rm-data-analysis\Slides\images\paste-3.png", replace                


 -->
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Random sampling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Cluster sampling</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Stratified sampling</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:45.0%"></p>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:45.0%"></p>
</figure>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:45.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="what-is-different-with-big-data" class="level2">
<h2 class="anchored" data-anchor-id="what-is-different-with-big-data">What is different with Big Data?</h2>
<ul>
<li><strong>massive</strong> datasets that are (billions?) Not necessarily representative</li>
<li>often <strong>automatically</strong> and <strong>continuously</strong> collected and stored (Transaction data, tweets, etc.)
<ul>
<li>Not necessarily for analytic purposes</li>
</ul></li>
<li>Complex
<ul>
<li>text (video, music/noise), network, multidimensional, maps</li>
</ul></li>
</ul>
</section>
<section id="different-yet-the-same" class="level2">
<h2 class="anchored" data-anchor-id="different-yet-the-same">Different yet the same</h2>
<p>Different:</p>
<ul>
<li>A particular source of uncertainty of the results of an analysis is greatly reduced</li>
<li>Rare or more nuanced patterns can be uncovered</li>
<li>Practical challenges (storage, processing, etc.)</li>
<li>Some challenges may be solved by working with a random subsample</li>
</ul>
<p>Same:</p>
<ul>
<li>Need to represent entire population if incomplete coverage</li>
<li>Example: Big Data with 75% coverage with a selection bias leads to biased results</li>
<li>Non-big data from same population with 1% random sample leads to good results</li>
</ul>
</section>
</section>
<section id="other-aspects-to-consider" class="level1">
<h1>Other Aspects to consider</h1>
<section id="sample-selection-bias" class="level2">
<h2 class="anchored" data-anchor-id="sample-selection-bias">Sample selection bias</h2>
<ul>
<li>The sample you collect is different from the population</li>
<li>This difference is crucial in the story</li>
<li>Example: Predicting presidential election
<ul>
<li>1936: Literary Digest. <a href="https://en.wikipedia.org/wiki/The_Literary_Digest#:~:text=In%201936%2C%20the%20magazine's%20poll,vote%20and%20370%20electoral%20votes.">FD Roosevelt vs Landon</a>. 10m people asked. 2m replied. Biggest poll ever. Landon was predicted win 57%<br>
</li>
<li>1948 Chicago Tribune. <a href="https://en.wikipedia.org/wiki/Dewey_Defeats_Truman">Dewey predicted beat Truman</a>. Used phone registry</li>
</ul></li>
</ul>
</section>
<section id="legal-and-ethical-aspects" class="level2">
<h2 class="anchored" data-anchor-id="legal-and-ethical-aspects">Legal and ethical aspects</h2>
<p>During Data collection, be aware of ethical and legal constraints, Special care with sensitive information</p>
<p>More with web scraping…</p>
<p>Always communicate with the source owner(s) and or with legal professional if you are planning to use seemingly sensitive data (names, addresses, etc.)</p>
</section>
<section id="ai-and-data-collection-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="ai-and-data-collection-wrangling">AI and data collection, wrangling</h2>
<ul>
<li>Data collection and management often behind walls</li>
<li>AI can help write code to web-scrape, etc. (Python is quite good at it)</li>
<li>AI is great to give a first impression of your dataset, incl.&nbsp;quality, data structure</li>
<li>AI is helpful to discuss sampling ideas</li>
<li>AI needs context to do good, and will not have proper domain knowledge</li>
<li>AI needs supervision</li>
</ul>
<p>Lesson: AI is a tool, not a replacement</p>
</section>
<section id="main-takeaway" class="level2">
<h2 class="anchored" data-anchor-id="main-takeaway">Main takeaway</h2>
<ul>
<li>Know your data
<ul>
<li>How it was born,</li>
<li>What its main advantages are</li>
<li>What its main disadvantages are</li>
</ul></li>
<li>Data quality determines the results of your analysis</li>
<li>Data quality is determined by how the data was born, and how you are planning to use it</li>
</ul>
</section>
</section>
<section id="break" class="level1">
<h1><strong>Break</strong></h1>
</section>
<section id="preparing-the-data" class="level1">
<h1>Preparing the Data</h1>
<p>From raw to tidy</p>
<section id="motivation-1" class="level2">
<h2 class="anchored" data-anchor-id="motivation-1">Motivation</h2>
<ul>
<li><p>Does immunization of infants against measles save lives in poor countries? Use data on immunization rates in various countries in various years from the World Bank. How should you store, organize and use the data to have all relevant information in an accessible format that lends itself to meaningful analysis?</p></li>
<li><p>You want to know, who has been the best manager in the top English football league. Have downloaded data on football games and on managers. To answer your question you need to combine this data. How should you do that? And are there issues with the data that you need to address?</p></li>
</ul>
</section>
</section>
<section id="variables" class="level1">
<h1>Variables</h1>
<section id="variable-types-qualitative-vs-quantitative" class="level2">
<h2 class="anchored" data-anchor-id="variable-types-qualitative-vs-quantitative">Variable types: Qualitative vs quantitative</h2>
<ul>
<li>Data can be born (collected, generated) in different form, and our variables may capture the quality or the quantity of a phenomenon.</li>
<li>Quantitative variables are born as numbers. Typically take many values. (age, height, steps…)</li>
<li>Qualitative variables, also called categorical variables, take on a few values, with each value having a specific interpretation (belonging a category). (Race, Gender, Brand, etc)</li>
</ul>
</section>
<section id="variable-types-dummies-or-binary" class="level2">
<h2 class="anchored" data-anchor-id="variable-types-dummies-or-binary">Variable types: Dummies or binary</h2>
<ul>
<li>A special case is a binary variable, which can take on two values</li>
<li>…yes/no answer to whether the observation belongs to some group. <strong>Best</strong> to represent these as <code>0</code> or <code>1</code> variables: <code>0</code> for no, <code>1</code> for yes.
<ul>
<li>Example: <code>is_female</code>, <code>is_head_of_household</code>, <code>is_pregnant</code>, <code>is_employed</code></li>
</ul></li>
<li>Flag - binary showing existence of some issue (such as missing value for another variable, presence in another dataset)
<ul>
<li>Example: <code>missing_age</code>, <code>missing_income</code>, <code>in_sample</code></li>
</ul></li>
<li><strong>Note</strong> Some times Surveys do <strong>NOT</strong> use 0-1 for binary variables. <strong>Be careful</strong>.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ssc</span> install fre</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>fre categorical_variable</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>* This <span class="kw">program</span> will <span class="kw">tabulate</span> the <span class="kw">data</span> and show you the labels <span class="kw">if</span> any</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="variable-types---formal-definition" class="level2">
<h2 class="anchored" data-anchor-id="variable-types---formal-definition">Variable types - formal definition</h2>
<ol type="1">
<li><strong>Nominal qualitative</strong> variables take on values that <em>cannot</em> be unambiguously ordered: Color, brands, race</li>
<li><strong>Ordinal</strong>, or <strong>ordered</strong> variables take on values that are unambiguously ordered. Grade, satisfaction, income brackets</li>
<li><strong>Interval/continuous</strong> variables are ordered variables, with a comparable “change”: Age, Degree Celsius, Price in dollars.</li>
</ol>
</section>
</section>
<section id="data-wrangling-cleaning" class="level1 left">
<h1 class="left">Data Wrangling &amp; Cleaning</h1>
<p>Taking care of your data</p>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">Data Wrangling</h2>
<blockquote class="blockquote">
<p>Data wrangling is the process of transforming raw data to a set of data tables that can be used for a variety of downstream purposes such as data analysis.</p>
</blockquote>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Understanding and storing
<ul>
<li>start from raw data</li>
<li>understand the structure and content</li>
<li>create tidy data tables</li>
<li>understand links between tables</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>Data cleaning
<ul>
<li>understand features, variable types</li>
<li>filter duplicates</li>
<li>look for and manage missing observations</li>
<li>understand limitations</li>
</ul></li>
</ul>
</div>
</div>
<ul>
<li>This is a <strong>crucial</strong> because out there, Data is Messy</li>
</ul>
</section>
<section id="the-tidy-data-approach" class="level2">
<h2 class="anchored" data-anchor-id="the-tidy-data-approach">The tidy data approach</h2>
<p>A useful concept of organizing and cleaning data is called the tidy data approach:</p>
<ol type="1">
<li>Each observation forms a row.</li>
<li>Each variable forms a column.</li>
<li>Each type of observational unit forms a table. (One for Families, One for Members)</li>
<li>Each observation has a unique identifier (ID) (Family ID and Person ID)</li>
<li>Can be merged with other tables if needed.</li>
</ol>
<p>Advantages:</p>
<ul>
<li>Tidy tables are easy to work with, and make finding errors easy.</li>
<li>Easy to understand and extend: New observations adds rows; new variables adds columns.</li>
</ul>
</section>
<section id="simple-tidy-data-table" class="level2">
<h2 class="anchored" data-anchor-id="simple-tidy-data-table">Simple tidy data table</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>hotel_id</th>
<th>price</th>
<th>distance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>21897</td>
<td>81</td>
<td>1.7</td>
</tr>
<tr class="even">
<td>21901</td>
<td>85</td>
<td>1.4</td>
</tr>
<tr class="odd">
<td>21902</td>
<td>83</td>
<td>1.7</td>
</tr>
</tbody>
</table>
<p>Source: <code>hotels-vienna data</code>. Vienna, 2017 November week-end.</p>
<p>Each Row a new observation, Each Column a new Variable</p>
</section>
<section id="tidy-data-table-of-multi-dimensional-data" class="level2">
<h2 class="anchored" data-anchor-id="tidy-data-table-of-multi-dimensional-data">Tidy data table of multi-dimensional data</h2>
<ul>
<li>The tidy approach - store <strong><code>xt</code></strong> data so that One row is one <code>it</code> observation (Cross-section unit <code>i</code> observed at time <code>t</code>). (Long format)<br>
</li>
<li>The next row then may be the same cross-sectional unit observed in the next time period.
<ul>
<li>You may want to use similar criteria with multi-dimensional data (<code>ijt</code> data)</li>
</ul></li>
<li>Alternative <strong>wide format</strong> : one row refers to one cross-sectional unit, and different time periods are represented in different columns. Not the best way to keep the data</li>
</ul>
</section>
<section id="displaying-immunization-rates-across-countries---wide" class="level2">
<h2 class="anchored" data-anchor-id="displaying-immunization-rates-across-countries---wide">Displaying immunization rates across countries - WIDE</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>Country</th>
<th>imm2015</th>
<th>imm2016</th>
<th>imm2017</th>
<th>gdppc2015</th>
<th>gdppc2016</th>
<th>gdppc2017</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>India</td>
<td>87</td>
<td>88</td>
<td>88</td>
<td>5743</td>
<td>6145</td>
<td>6516</td>
</tr>
<tr class="even">
<td>Pakistan</td>
<td>75</td>
<td>75</td>
<td>76</td>
<td>4459</td>
<td>4608</td>
<td>4771</td>
</tr>
</tbody>
</table>
<p>Source: <code>world-bank-vaccination</code> data</p>
<p><strong>Wide format</strong> of country-year panel data, each row is one country, different years are different variables.</p>
<p><code>imm</code>: rate of immunization against measles among 12–13-month-old infants.<br>
<code>gdppc</code>: GDP per capital, PPP, constant 2011 USD.</p>
</section>
<section id="displaying-immunization-rates-across-countries---long" class="level2">
<h2 class="anchored" data-anchor-id="displaying-immunization-rates-across-countries---long">Displaying immunization rates across countries - LONG</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Country</th>
<th>Year</th>
<th>imm</th>
<th>gdppc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>India</td>
<td>2015</td>
<td>87</td>
<td>5743</td>
</tr>
<tr class="even">
<td>India</td>
<td>2016</td>
<td>88</td>
<td>6145</td>
</tr>
<tr class="odd">
<td>India</td>
<td>2017</td>
<td>88</td>
<td>6516</td>
</tr>
<tr class="even">
<td>Pakistan</td>
<td>2015</td>
<td>75</td>
<td>4459</td>
</tr>
<tr class="odd">
<td>Pakistan</td>
<td>2016</td>
<td>75</td>
<td>4608</td>
</tr>
<tr class="even">
<td>Pakistan</td>
<td>2017</td>
<td>76</td>
<td>4771</td>
</tr>
</tbody>
</table>
<p>Note: Tidy (long) format of country-year panel data, each row is one country in one year.<br>
<code>imm</code>: rate of immunization against measles among 12–13-month-old infants.<br>
<code>gdppc</code>: GDP per capital, PPP, constant 2011 USD. Source: world-bank-vaccination data.</p>
</section>
<section id="stata-programming-corner" class="level2">
<h2 class="anchored" data-anchor-id="stata-programming-corner">Stata Programming corner</h2>
<ul>
<li>Transforming your data from Wide to Long format (or viceversa) can be done using <code>reshape</code></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>* From <span class="kw">wide</span> to <span class="kw">long</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">ren</span> *, low <span class="co">// &lt;- Make sure your variables are all lower case</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">reshape</span> <span class="kw">long</span> imm gdppc, <span class="co">/// &lt;- Make variable Long, and indicate what variables to "make" long</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    i(country) j(<span class="fu">year</span>) <span class="fu">string</span> <span class="co">// &lt;- also the dimension that was previously "wide" Year</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>* From <span class="kw">long</span> to <span class="kw">wide</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="kw">reshape</span> <span class="kw">wide</span> imm gdppc, <span class="co">/// &lt;- Make variable Long, and indicate what variables to "make" long</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    i(country) j(<span class="fu">year</span>)  <span class="co">// &lt;- also the dimension that was previously "wide" Year    </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stata-programming-corner-1" class="level2">
<h2 class="anchored" data-anchor-id="stata-programming-corner-1">Stata Programming corner</h2>
<ul>
<li>Some times, you may need to <code>reshape</code> only 1 variable, and keep the rest as they are.
<ul>
<li>Adding <span class="blue"><strong>head of household education</strong></span> to all family members.</li>
</ul></li>
<li>You can do it two ways:
<ul>
<li>Create a smaller dataset and <code>merge</code></li>
<li>ID head, and gen the new variable<br>
<code>bysort hid: egen head_educ = max(educ*(is_head==1))</code></li>
</ul></li>
</ul>
</section>
<section id="a-complex-dataset-relational-database" class="level2">
<h2 class="anchored" data-anchor-id="a-complex-dataset-relational-database">A complex Dataset: Relational database</h2>
<ul>
<li>Some datasets cannot be stored in a single table.
<ul>
<li>ok, they could, but would be very inefficient.</li>
</ul></li>
<li>Data like this are typically stored in a relational database.
<ul>
<li>Smaller <strong><em>tidy</em></strong> datasets can be stored in a single table (single unit of observation),</li>
<li>and that can be linked to other tables with a unique identifiers (ID or Keys).</li>
</ul></li>
<li>This structure forces you to better understand your data.</li>
<li>After understanding the data, you can <code>merge</code>/<code>join</code>/<code>link</code>/<code>match</code> tables as needed.</li>
</ul>
</section>
<section id="identifying-successful-futbol-managers" class="level2">
<h2 class="anchored" data-anchor-id="identifying-successful-futbol-managers">Identifying successful Futbol managers</h2>
<ul>
<li><p>Review the example, Specially if interested in Futbol</p></li>
<li><p>In short, Data can have different structures (all tidy)</p></li>
<li><p>Some structures are more useful than others.</p></li>
<li><p>Understanding those structures will allow you to work with the data</p></li>
</ul>
</section>
<section id="american-time-use-survey" class="level2">
<h2 class="anchored" data-anchor-id="american-time-use-survey">American Time Use Survey</h2>
<ul>
<li>The ATUS is a good example of a relational dataset</li>
<li>If downloaded RAW (census) you need to navigate through many files:
<ul>
<li><strong>ATUS-ACT</strong>: contains all time activities, plus other info, for the individuals interviewed in the ATUS. Keys: <code>tucaseid</code> and <code>tuactivity_n</code></li>
<li><strong>ATUS-CPS</strong>: Data for all Family members, from CPS. Keys <code>tucaseid</code> <code>tulineno</code></li>
<li><strong>ATUS-RESP</strong>: Some aggregated TimeUse, and additional respondand information. Key <code>tucaseid</code></li>
<li><strong>ATUS-ROST</strong>: Basic demographics for all household members. Keys <code>tucaseid</code> <code>tulineno</code></li>
<li><strong>ATUS-SUM</strong>: Aggregated Time use data, by different types. Keys <code>tucaseid</code></li>
</ul></li>
</ul>
</section>
<section id="american-time-use-survey-1" class="level2">
<h2 class="anchored" data-anchor-id="american-time-use-survey-1">American Time Use Survey</h2>
<ul>
<li>Depending on your goals, you may want to combine information from various datasets
<ul>
<li>Aggregate some data, combine others, transform.</li>
</ul></li>
<li>Understanding the data structure may also help you see how to best “merge the data”</li>
</ul>
</section>
<section id="stata-corner-types-of-merging" class="level2">
<h2 class="anchored" data-anchor-id="stata-corner-types-of-merging">Stata-Corner: Types of <a href="https://friosavila.github.io/chatgpt/merge_04_20_2023/index.html">Merging</a></h2>
<p>There are <del>4</del> 3 types of merging, depending of the <code>master</code> or <code>using</code> dataset</p>
<ul>
<li><code>1:1 merging</code>: Both master and using datasets are uniquely by the <strong>same variables</strong>. use atus-rost merge 1:1 tucaseid tulineno using atus-cps</li>
<li><code>1:m merging</code>: Each observation in the <code>master</code> file will be merge with <code>many</code> units in the <code>using</code> dataset. Master has unique ID. use atus-resp merge 1:m tucaseid using atus-act</li>
<li><code>m:1 merging</code>: Many observations in the <code>master</code> will be merge with <code>one</code> unit in the <code>using</code>. Using has a unique ID<br>
use atus-act merge m:1 tucaseid using atus-resp</li>
<li><code>m:m merging</code>: its wrong…dont do it. Perhaps think <code>joinby</code> instead</li>
</ul>
</section>
<section id="stata-corner" class="level2">
<h2 class="anchored" data-anchor-id="stata-corner">Stata-Corner</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Every time you do a merge, Stata will create a variable called <code>_merge</code> that will tell you what happened to the merge.</li>
<li>If this variable exist in your datasets (master or using) you will get an error.</li>
<li>so make sure to drop (or rename) it before merging (after you have checked it)</li>
</ul>
</div>
</div>
</section>
<section id="complex-data---tidy-data-summary" class="level2">
<h2 class="anchored" data-anchor-id="complex-data---tidy-data-summary">Complex data - tidy data: summary</h2>
<ul>
<li>Creating a tidy data is important so data tables are easy to understand, combine and extend in the future.</li>
<li>If relational data, IDs are essential (allow to link tables)</li>
<li>Often raw data will not come in a tidy format, and you will need to work understanding the structure, relationships and find the individual ingredients.</li>
<li>For analysis work, may need to combine tidy data tables</li>
<li>But probably only need a fraction of all variables.</li>
</ul>
</section>
</section>
<section id="data-cleaning" class="level1">
<h1>Data cleaning</h1>
<p>Tidying up your tidy data</p>
<section id="data-cleaning-1" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-1">Data cleaning</h2>
<p>With most data, in addition to understand it, you need to “clean”, before using it (<strong>Very Important</strong>)</p>
<ul>
<li>Entity resolution:
<ul>
<li>Dealing with duplicates: Why are they there? What to do?</li>
<li>Ambiguous identification: is it John or Jonh or Jon ?</li>
<li>non-entity rows: uh? what is this?</li>
</ul></li>
<li>Missing values
<ul>
<li>why is it missing? is it missing at random? by design? endogenous?</li>
</ul></li>
</ul>
</section>
<section id="dealing-with-duplicates" class="level2">
<h2 class="anchored" data-anchor-id="dealing-with-duplicates">Dealing with duplicates</h2>
<ul>
<li>** Duplicates**: Observations appearing more than once in the data.
<ul>
<li>May be the result of human error, or the features of data source (e.g., data scraped from classified ads. Some posts appear more than once).</li>
</ul></li>
<li>Often, easy spot
<ul>
<li><code>duplicates report</code> in Stata, or <code>bysort ID: gen dup = _n</code></li>
</ul></li>
<li>but one needs to investigate. Makes sense / an error? something else?</li>
<li>Decision: what to keep. Sometimes no clear-cut way, but <strong><em>usually</em></strong> no big deal.</li>
</ul>
</section>
<section id="entity-identification-and-resolution" class="level2">
<h2 class="anchored" data-anchor-id="entity-identification-and-resolution">Entity identification and resolution</h2>
<ul>
<li>You need to have unique IDs
<ul>
<li>you can use <code>isid</code> to check if a variable(s) is a unique identifier</li>
<li>If not, check why not. Perhaps wrong ID?</li>
</ul></li>
<li>Possible cases:
<ul>
<li>Same identifier, different entities</li>
<li>Different identifiers, same entity (??)</li>
</ul></li>
<li>Entity resolution: process of identifying, merging and eliminating duplicate entities.</li>
</ul>
</section>
<section id="entity-resolution-example" class="level2">
<h2 class="anchored" data-anchor-id="entity-resolution-example">Entity resolution example</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Team ID</th>
<th>Unified name</th>
<th>Original name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>19</td>
<td>Man City</td>
<td>Manchester City</td>
</tr>
<tr class="even">
<td>19</td>
<td>Man City</td>
<td>Man City</td>
</tr>
<tr class="odd">
<td>19</td>
<td>Man City</td>
<td>Man. City</td>
</tr>
<tr class="even">
<td>19</td>
<td>Man City</td>
<td>Manchester City F.C.</td>
</tr>
<tr class="odd">
<td>20</td>
<td>Man United</td>
<td>Manchester United</td>
</tr>
<tr class="even">
<td>20</td>
<td>Man United</td>
<td>Manchester United F.C.</td>
</tr>
<tr class="odd">
<td>20</td>
<td>Man United</td>
<td>Manchester United Football Club</td>
</tr>
<tr class="even">
<td>20</td>
<td>Man United</td>
<td>Man United</td>
</tr>
</tbody>
</table>
</section>
<section id="getting-rid-of-non-entity-observations" class="level2">
<h2 class="anchored" data-anchor-id="getting-rid-of-non-entity-observations">Getting rid of non-entity observations</h2>
<ul>
<li>Sometimes, data may contain rows that do not belong to an entity we want
<ul>
<li>For example, region-level data may contain country-level aggregates</li>
</ul></li>
<li>Find them and drop them (unless you have a good reason to keep them)</li>
<li>Common Case: a data table from the World Bank on countries often includes observations for larger regions (continents, low income countries, etc)</li>
</ul>
</section>
</section>
<section id="missing-data" class="level1">
<h1>Missing Data</h1>
<section id="missing-values" class="level2">
<h2 class="anchored" data-anchor-id="missing-values">Missing values</h2>
<ul>
<li>A frequent <strong>and</strong> important issue: missing values.</li>
<li>Missing values mean that the value of a variable is available for some, but not all, observations.</li>
<li>Different languages may encode missing values differently.
<ul>
<li>In <code>Stata</code> dot “.”, an empty space “” are missing for numbers and strings.</li>
<li>But, “.” is considered larger than any number, so be careful when coding.</li>
</ul></li>
<li>Surveys, may also have their own rules for coding missing
<ul>
<li>binary 0 for no, 1 for yes, 9 for missing</li>
<li>percent 0-100, 9999 for missing</li>
<li>numeric, range is 1-100000, 9999999999 for missing</li>
</ul></li>
</ul>
</section>
<section id="missing-values-what-to-do" class="level2">
<h2 class="anchored" data-anchor-id="missing-values-what-to-do">Missing values: What to do?</h2>
<p>Depends on: <strong>Scope</strong>: How much missing? and <strong>Reason</strong>: Why missing?</p>
<ol type="1">
<li>Look at content of data. This could be related to data quality (especially coverage)</li>
<li>Missing by design may not be a problem. (Ever been pregnant? missing for men)</li>
<li>Missing values should be counted, because they mean fewer observations with valid information. (compounding effect)</li>
<li>Big problem: potential selection bias.
<ul>
<li>Is data missing at random?</li>
<li>Is the data still representative?</li>
</ul></li>
</ol>
</section>
<section id="missing-values-understanding-the-selection-process" class="level2">
<h2 class="anchored" data-anchor-id="missing-values-understanding-the-selection-process">Missing values: Understanding the selection process</h2>
<ul>
<li>Random: When missing data really means no information, it may be the result of errors in the data collection process. Rare.</li>
<li>In some other cases, missing just means “zero” or “no”. In these instances, we should simply recode (replace) the missing values as “zero” or as “no”. (how many children? missing means zero)</li>
<li>Often, values are missing for a reason.
<ul>
<li>Some survey respondents may not know the answer to a question or refuse to answer it,</li>
<li>They are likely to be different from those who provide valid answers.</li>
</ul></li>
</ul>
</section>
<section id="missing-values-what-can-we-do" class="level2">
<h2 class="anchored" data-anchor-id="missing-values-what-can-we-do">Missing values: what can we do?</h2>
<p>Two basic options:</p>
<ul>
<li>Restrict the analysis to observations with non-missing values for all variables used in the analysis.
<ul>
<li>Default option in many statistical packages.</li>
</ul></li>
<li>Imputation - Fill in some value for the missing values, such as the mean or median.
<ul>
<li>There are more advanced and better options, but should be used with caution.</li>
<li>Not all imputation methods are created equal.</li>
</ul></li>
<li>Be conservative, impute if absolutely necessary, and document it.</li>
</ul>
</section>
<section id="missing-values-some-practical-advice" class="level2">
<h2 class="anchored" data-anchor-id="missing-values-some-practical-advice">Missing values: Some practical advice</h2>
<ul>
<li>For binary variables: zero if yes/no.</li>
<li>For qualitative nominal variables, missing as a new value: white, blue, red and missing.</li>
<li>For ordinal variables, missing could be recoded to a neutral variable.</li>
<li>For quantitative variables -&gt; mean or median? (try not to! There are good imputation methods)</li>
<li>if impute, create a flag and use it analysis. At the very least for sensitivity analysis.</li>
<li>(<strong>Bad</strong>) Imputation will have consequences, be conservative.</li>
</ul>
</section>
<section id="more-on-data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="more-on-data-cleaning">More on Data Cleaning</h2>
<ul>
<li><p>Consider the data quality, and the data collection process.</p>
<ul>
<li>Are there outliers? data entry errors? bunching?</li>
</ul></li>
<li><p>Understand the data generating process.</p>
<ul>
<li>Are there missing values? why?</li>
</ul></li>
<li><p>This is an iterative process, and you may need to go back and forth between data cleaning and data analysis.</p></li>
<li><p>More on this with EDA and Data Visualization</p></li>
</ul>
</section>
<section id="data-wrangling-cooking-recipe" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling-cooking-recipe">Data wrangling: Cooking recipe</h2>
<ol type="1">
<li><span class="blue"><strong>Write a code</strong></span>: it can be repeated, commented, cleaned, and improved later</li>
<li>Understand the structure of the dataset, recognize links. Draw a schema</li>
<li>Start by looking into the data to spot issues. (<code>summarize</code>, <code>tabulate</code>, <code>edit</code>, <code>browse</code>)
<ul>
<li>do they have meaningful ranges? Correct them or set them as missing</li>
</ul></li>
<li>Store data in <strong>tidy</strong> datasets. one row is one observation, one column a variable</li>
<li>Have a description of variables (Labels, make sure you know what they are)</li>
<li>Identify missing values and store them in an appropriate format. Make edits if needed.</li>
<li>Document every step of data cleaning &lt;- <strong>Very Important</strong> and goes to the code</li>
</ol>
</section>
<section id="ai-and-data-wrangling-upside" class="level2">
<h2 class="anchored" data-anchor-id="ai-and-data-wrangling-upside">AI and data wrangling: Upside</h2>
<p>If given the right instructions, and information, AI can help you with data wrangling:</p>
<ul>
<li>understands your data structure</li>
<li>combines datasets</li>
<li>summarizes the data</li>
<li>understands your variables</li>
<li>finds potential problems</li>
</ul>
<p>But, it is not perfect. You need to understand the data and the process. Review and control.</p>
</section>
</section>
<section id="thats-all-for-today" class="level1">
<h1>Thats all for today</h1>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>