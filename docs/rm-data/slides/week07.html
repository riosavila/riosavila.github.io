<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Fernando Rios-Avila">
<meta name="dcterms.date" content="2024-10-10">

<title>Multiple regression analysis – Econometrics MSC Levy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>



<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Econometrics MSC Levy</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Multiple regression analysis</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Courses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../adv_class/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advance Econometrics: Causal Effects</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../rmethods/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Methods: Econometrics I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../rmethods2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Methods II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../rm-data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Research Methods I: Data Analysis for Economics and Policy</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Math Refresher</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mathref/math_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Math Refresher</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mathref/math_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Math Refresher</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mathref/math_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Math Refresher</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation">Motivation</a></li>
  <li><a href="#topics-to-cover" id="toc-topics-to-cover" class="nav-link" data-scroll-target="#topics-to-cover">Topics to cover</a></li>
  <li><a href="#how-multivariate-ols-works" id="toc-how-multivariate-ols-works" class="nav-link" data-scroll-target="#how-multivariate-ols-works">How multivariate OLS works</a>
  <ul class="collapse">
  <li><a href="#multivariate-regression" id="toc-multivariate-regression" class="nav-link" data-scroll-target="#multivariate-regression">Multivariate Regression</a></li>
  <li><a href="#multivariate-regression-1" id="toc-multivariate-regression-1" class="nav-link" data-scroll-target="#multivariate-regression-1">Multivariate Regression</a></li>
  <li><a href="#mr-ommited-variable-bias" id="toc-mr-ommited-variable-bias" class="nav-link" data-scroll-target="#mr-ommited-variable-bias">MR: Ommited Variable Bias</a></li>
  <li><a href="#mr-ommited-variable-bias-1" id="toc-mr-ommited-variable-bias-1" class="nav-link" data-scroll-target="#mr-ommited-variable-bias-1">MR: Ommited Variable Bias</a></li>
  <li><a href="#mr-ommited-variable-bias-2" id="toc-mr-ommited-variable-bias-2" class="nav-link" data-scroll-target="#mr-ommited-variable-bias-2">MR: Ommited Variable Bias</a></li>
  <li><a href="#simple-example" id="toc-simple-example" class="nav-link" data-scroll-target="#simple-example">Simple example</a></li>
  <li><a href="#mr-some-language" id="toc-mr-some-language" class="nav-link" data-scroll-target="#mr-some-language">MR: Some language</a></li>
  <li><a href="#stata-multiple-regression" id="toc-stata-multiple-regression" class="nav-link" data-scroll-target="#stata-multiple-regression">Stata: Multiple regression</a></li>
  </ul></li>
  <li><a href="#estimation" id="toc-estimation" class="nav-link" data-scroll-target="#estimation">Estimation</a>
  <ul class="collapse">
  <li><a href="#mr-standard-errors" id="toc-mr-standard-errors" class="nav-link" data-scroll-target="#mr-standard-errors">MR: Standard Errors</a></li>
  <li><a href="#mr-collinearity" id="toc-mr-collinearity" class="nav-link" data-scroll-target="#mr-collinearity">MR: Collinearity</a></li>
  <li><a href="#mr-collinearity-and-se" id="toc-mr-collinearity-and-se" class="nav-link" data-scroll-target="#mr-collinearity-and-se">MR: Collinearity and SE</a></li>
  <li><a href="#mr-collinearity-1" id="toc-mr-collinearity-1" class="nav-link" data-scroll-target="#mr-collinearity-1">MR: Collinearity</a></li>
  <li><a href="#mr-testing-single-hypotheses" id="toc-mr-testing-single-hypotheses" class="nav-link" data-scroll-target="#mr-testing-single-hypotheses">MR: Testing Single hypotheses</a></li>
  <li><a href="#mr-testing-joint-hypotheses" id="toc-mr-testing-joint-hypotheses" class="nav-link" data-scroll-target="#mr-testing-joint-hypotheses">MR: Testing Joint hypotheses</a></li>
  <li><a href="#mr-testing-joint-hypotheses-1" id="toc-mr-testing-joint-hypotheses-1" class="nav-link" data-scroll-target="#mr-testing-joint-hypotheses-1">MR: Testing Joint hypotheses</a></li>
  <li><a href="#mr-testing-hypotheses-in-stata" id="toc-mr-testing-hypotheses-in-stata" class="nav-link" data-scroll-target="#mr-testing-hypotheses-in-stata">MR: Testing hypotheses in Stata</a></li>
  <li><a href="#mr-non-linear-patterns" id="toc-mr-non-linear-patterns" class="nav-link" data-scroll-target="#mr-non-linear-patterns">MR: Non-linear patterns</a></li>
  <li><a href="#cs-understanding-the-gender-difference-in-earnings" id="toc-cs-understanding-the-gender-difference-in-earnings" class="nav-link" data-scroll-target="#cs-understanding-the-gender-difference-in-earnings">CS: Understanding the gender difference in earnings</a></li>
  <li><a href="#cs-the-data" id="toc-cs-the-data" class="nav-link" data-scroll-target="#cs-the-data">CS: The data</a></li>
  <li><a href="#cs-the-model" id="toc-cs-the-model" class="nav-link" data-scroll-target="#cs-the-model">CS: The model</a></li>
  <li><a href="#cs-the-regression" id="toc-cs-the-regression" class="nav-link" data-scroll-target="#cs-the-regression">CS: The Regression</a></li>
  <li><a href="#cs-adjustment-and-robustness" id="toc-cs-adjustment-and-robustness" class="nav-link" data-scroll-target="#cs-adjustment-and-robustness">CS: Adjustment and Robustness</a></li>
  </ul></li>
  <li><a href="#qualitative-variables-and-interactions" id="toc-qualitative-variables-and-interactions" class="nav-link" data-scroll-target="#qualitative-variables-and-interactions">Qualitative variables <br> and interactions</a>
  <ul class="collapse">
  <li><a href="#mr-qualitative-variables" id="toc-mr-qualitative-variables" class="nav-link" data-scroll-target="#mr-qualitative-variables">MR: Qualitative variables</a></li>
  <li><a href="#mr-qualitative-variables-1" id="toc-mr-qualitative-variables-1" class="nav-link" data-scroll-target="#mr-qualitative-variables-1">MR: Qualitative variables</a></li>
  <li><a href="#mr-how-to-pick-a-reference-category" id="toc-mr-how-to-pick-a-reference-category" class="nav-link" data-scroll-target="#mr-how-to-pick-a-reference-category">MR: How to pick a reference category?</a></li>
  <li><a href="#cs-gender-difference-in-earnings-and-education" id="toc-cs-gender-difference-in-earnings-and-education" class="nav-link" data-scroll-target="#cs-gender-difference-in-earnings-and-education">CS: Gender difference in earnings and education</a></li>
  <li><a href="#mr-interactions" id="toc-mr-interactions" class="nav-link" data-scroll-target="#mr-interactions">MR: Interactions</a></li>
  <li><a href="#mr-interactions-and-parallel-lines" id="toc-mr-interactions-and-parallel-lines" class="nav-link" data-scroll-target="#mr-interactions-and-parallel-lines">MR: Interactions and parallel lines</a></li>
  <li><a href="#mr-interaction-with-two-continuous-variable" id="toc-mr-interaction-with-two-continuous-variable" class="nav-link" data-scroll-target="#mr-interaction-with-two-continuous-variable">MR: Interaction with two continuous variable</a></li>
  <li><a href="#mr-interaction-with-two-continuous-variable-1" id="toc-mr-interaction-with-two-continuous-variable-1" class="nav-link" data-scroll-target="#mr-interaction-with-two-continuous-variable-1">MR: Interaction with two continuous variable</a></li>
  <li><a href="#cs-interaction-between-gender-and-age" id="toc-cs-interaction-between-gender-and-age" class="nav-link" data-scroll-target="#cs-interaction-between-gender-and-age">CS: Interaction between gender and age</a></li>
  <li><a href="#mr-stata-corner" id="toc-mr-stata-corner" class="nav-link" data-scroll-target="#mr-stata-corner">MR: Stata corner</a></li>
  </ul></li>
  <li><a href="#conditioning-and-causality" id="toc-conditioning-and-causality" class="nav-link" data-scroll-target="#conditioning-and-causality">Conditioning and causality</a>
  <ul class="collapse">
  <li><a href="#mr-causal-analysis" id="toc-mr-causal-analysis" class="nav-link" data-scroll-target="#mr-causal-analysis">MR: Causal analysis</a></li>
  <li><a href="#mr-causal-analysis-1" id="toc-mr-causal-analysis-1" class="nav-link" data-scroll-target="#mr-causal-analysis-1">MR: Causal analysis</a></li>
  <li><a href="#mr-causal-analysis-dont-overdo-it" id="toc-mr-causal-analysis-dont-overdo-it" class="nav-link" data-scroll-target="#mr-causal-analysis-dont-overdo-it">MR: Causal analysis Don’t overdo it</a></li>
  <li><a href="#mr-causal-analysis-2" id="toc-mr-causal-analysis-2" class="nav-link" data-scroll-target="#mr-causal-analysis-2">MR: Causal analysis</a></li>
  <li><a href="#cs-understanding-the-gender-difference-in-earnings-1" id="toc-cs-understanding-the-gender-difference-in-earnings-1" class="nav-link" data-scroll-target="#cs-understanding-the-gender-difference-in-earnings-1">CS: Understanding the gender difference in earnings</a></li>
  <li><a href="#regression-table-detour" id="toc-regression-table-detour" class="nav-link" data-scroll-target="#regression-table-detour">Regression table detour</a></li>
  </ul></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction">Prediction</a>
  <ul class="collapse">
  <li><a href="#mr-prediction-and-benchmarking" id="toc-mr-prediction-and-benchmarking" class="nav-link" data-scroll-target="#mr-prediction-and-benchmarking">MR: Prediction and benchmarking</a></li>
  <li><a href="#mr-variable-selection" id="toc-mr-variable-selection" class="nav-link" data-scroll-target="#mr-variable-selection">MR: Variable selection</a></li>
  <li><a href="#mr-variable-selection-for-causal-questions" id="toc-mr-variable-selection-for-causal-questions" class="nav-link" data-scroll-target="#mr-variable-selection-for-causal-questions">MR: Variable selection for causal questions</a></li>
  <li><a href="#mr-variable-selection-process" id="toc-mr-variable-selection-process" class="nav-link" data-scroll-target="#mr-variable-selection-process">MR: Variable selection – process</a></li>
  <li><a href="#mr-variable-selection-for-prediction" id="toc-mr-variable-selection-for-prediction" class="nav-link" data-scroll-target="#mr-variable-selection-for-prediction">MR: Variable selection for prediction</a></li>
  <li><a href="#summary-take-away" id="toc-summary-take-away" class="nav-link" data-scroll-target="#summary-take-away">Summary take-away</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="week07.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Multiple regression analysis</h1>
<p class="subtitle lead">When one <span class="math inline">\(x\)</span> variable is not enough</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Fernando Rios-Avila </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Levy Economics Institute
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 10, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="motivation" class="level2">
<h2 class="anchored" data-anchor-id="motivation">Motivation</h2>
<ul>
<li>We are interested in finding evidence for or against labor market discrimination of women. Compare wages for men and women who share similarities in wage relevant factors such as experience and education.</li>
<li>Find a good deal on a hotel to spend a night in a European city- analyzed the pattern of hotel price and distance and many other features to find hotels that are underpriced not only for their location but also those other features.</li>
</ul>
</section>
<section id="topics-to-cover" class="level2">
<h2 class="anchored" data-anchor-id="topics-to-cover">Topics to cover</h2>
<ul>
<li>Multiple regression mechanics</li>
<li>Estimation and interpreting coefficients</li>
<li>Non-linear terms, interactions</li>
<li>Variable selection, small sample problems</li>
<li>Multiple regression and causality</li>
<li>Multiple regression and prediction</li>
</ul>
</section>
<section id="how-multivariate-ols-works" class="level1">
<h1>How multivariate OLS works</h1>
<section id="multivariate-regression" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-regression">Multivariate Regression</h2>
<ul>
<li>Whenever you start modeling an outcome <span class="math inline">\(y\)</span>, there will always be two factors that will determine that outcome:
<ul>
<li>Factors that you can control (e.g., education, experience, etc.)</li>
<li>Factors that you cannot control (e.g., errors)<br>
</li>
</ul></li>
<li>Multiple regression analysis uncovers average <span class="math inline">\(y\)</span> as a function of more than one <span class="math inline">\(x\)</span> variable: <span class="math inline">\(y^E = f(x_1, x_2, ...)\)</span>.</li>
<li>It can lead to better predictions <span class="math inline">\(\hat{y}\)</span> by considering more explanatory variables.</li>
<li>It <strong>may</strong> improve the interpretation of slope coefficients by comparing observations that are similar in terms of other <span class="math inline">\(x's\)</span> variables.</li>
</ul>
</section>
<section id="multivariate-regression-1" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-regression-1">Multivariate Regression</h2>
<ul>
<li><p>Multiple linear regression specifies a linear function of the explanatory variables for the average <span class="math inline">\(y\)</span>: <span class="math display">\[y^E = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_k x_k\]</span></p></li>
<li><p>But, now that we now we can have more than one <span class="math inline">\(x\)</span> variable, what happens if we don’t?</p></li>
</ul>
</section>
<section id="mr-ommited-variable-bias" class="level2">
<h2 class="anchored" data-anchor-id="mr-ommited-variable-bias">MR: Ommited Variable Bias</h2>
<p>Lets say we have to models: <span class="math display">\[\begin{aligned}
y &amp;= \alpha_0 + \alpha_1 x_1 + \varepsilon_1  \\
y &amp;= \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \varepsilon_2
\end{aligned}
\]</span></p>
<ul>
<li>How do <span class="math inline">\(\alpha_1\)</span> and <span class="math inline">\(\beta_1\)</span> compare?</li>
<li>Lets Start by regressing <span class="math inline">\(x_2\)</span> on <span class="math inline">\(x_1\)</span>: <span class="math inline">\(x_2 = \delta_0 + \delta_1 x_1 + u\)</span></li>
<li>And plug this back into the second equation:</li>
</ul>
<p><span class="math display">\[\begin{aligned}
y &amp;= \beta_0 + \beta_1 x_1 + \beta_2 (\delta_0 + \delta_1 x_1 + u) + \varepsilon_2 \\
y &amp;= (\beta_0 + \beta_2\delta_0) + (\beta_1 + \beta_2 \delta_1) x  + (\beta_2 u + \varepsilon_2)
\end{aligned}
\]</span></p>
</section>
<section id="mr-ommited-variable-bias-1" class="level2">
<h2 class="anchored" data-anchor-id="mr-ommited-variable-bias-1">MR: Ommited Variable Bias</h2>
<ul>
<li>So it turns out that:</li>
</ul>
<p><span class="math display">\[\alpha_1 = \beta_1 + \beta_2 \delta_1 \rightarrow \beta_1-\alpha_1 = -\beta_2 \delta_1
\]</span></p>
<ul>
<li>By “ignoring” <span class="math inline">\(x_2\)</span> in the first regression, we are actually estimating a <strong>biased</strong> coefficient for <span class="math inline">\(x_1\)</span>.
<ul>
<li>Assuming the second model is the “true” model</li>
</ul></li>
<li>This is what is known as the <strong>Omitted variable bias</strong> OBV
<ul>
<li>Note: You could also have a bias because you are including a variable that <strong>should not</strong> be there. This is known as <strong>bad control</strong>.</li>
</ul></li>
</ul>
</section>
<section id="mr-ommited-variable-bias-2" class="level2">
<h2 class="anchored" data-anchor-id="mr-ommited-variable-bias-2">MR: Ommited Variable Bias</h2>
<ul>
<li><strong>OBV</strong> is a common problem in empirical research because we can never include all the variables that determine <span class="math inline">\(y\)</span>.</li>
<li>However, mechanically, there are two cases where OBV is not a problem:
<ul>
<li>When <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are uncorrelated (<span class="math inline">\(\delta_1 = 0\)</span>)</li>
<li>When <span class="math inline">\(y\)</span> and <span class="math inline">\(x_2\)</span> are uncorrelated (<span class="math inline">\(\beta_2 = 0\)</span>)</li>
</ul></li>
</ul>
</section>
<section id="simple-example" class="level2">
<h2 class="anchored" data-anchor-id="simple-example">Simple example</h2>
<ul>
<li>TS regression: Regress month-to-month change in log quantity sold of Beer (<span class="math inline">\(y\)</span>) on month-to-month change in log price (<span class="math inline">\(x_1\)</span>).
<ul>
<li><span class="math inline">\(\beta = -0.5\)</span>: sales tend to decrease by 0.5% when our price increases by 1%.</li>
</ul></li>
<li>Robustness: <span class="math inline">\(x_2\)</span>: change in ln average price charged by our competitors
<ul>
<li>New Results: <span class="math inline">\(\hat{\beta}_1 = -3\)</span> and <span class="math inline">\(\hat{\beta}_2 = 3\)</span></li>
</ul></li>
<li>There is a <strong><em>OBV</em></strong> (Model 1 is flatter than Model 2)</li>
<li>Possibly the result of two things:
<ul>
<li>a positive association between the two price changes (<span class="math inline">\(\delta_1\)</span>) and</li>
<li>a positive association between competitor price and our own sales (<span class="math inline">\(\beta_2\)</span>).</li>
</ul></li>
</ul>
</section>
<section id="mr-some-language" class="level2">
<h2 class="anchored" data-anchor-id="mr-some-language">MR: Some language</h2>
<ul>
<li><p><strong>Setup:</strong> Multiple regression with two explanatory variables (<span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>),</p></li>
<li><p><strong>Technicallity:</strong>: We measure differences in expected <span class="math inline">\(y\)</span> across observations that differ in <span class="math inline">\(x_1\)</span> but are similar in terms of <span class="math inline">\(x_2\)</span>.</p></li>
<li><p><strong>Interpretation:</strong> Difference in <span class="math inline">\(y\)</span> by <span class="math inline">\(x_1\)</span>, conditional on <span class="math inline">\(x_2\)</span>. OR controlling for <span class="math inline">\(x_2\)</span>.</p>
<ul>
<li>We condition on <span class="math inline">\(x_2\)</span>, or control for <span class="math inline">\(x_2\)</span>, when we include <span class="math inline">\(x_2\)</span> in a multiple regression that focuses on average differences in <span class="math inline">\(y\)</span> by <span class="math inline">\(x_1\)</span>.</li>
</ul></li>
<li><p>What we care is <span class="math inline">\(x_1\)</span>’s effect on <span class="math inline">\(y\)</span>, but we control for <span class="math inline">\(x_2\)</span> to get a better estimate of this effect.</p></li>
<li><p><strong>Confounding:</strong> <span class="math inline">\(x_2\)</span> is a confounder if <span class="math inline">\(x_2\)</span> is correlated with <span class="math inline">\(x_1\)</span> and <span class="math inline">\(y\)</span>.</p>
<ul>
<li>Thus, we have a problem if we omit <span class="math inline">\(x_2\)</span> from the regression.</li>
</ul></li>
</ul>
</section>
<section id="stata-multiple-regression" class="level2">
<h2 class="anchored" data-anchor-id="stata-multiple-regression">Stata: Multiple regression</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">regress</span> <span class="fu">y</span> x1 [<span class="kw">x2</span> x3 ... ], <span class="kw">robust</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">estimates</span> <span class="kw">store</span> m1</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>esttab m1, <span class="kw">star</span>(* 0.10 ** 0.05 *** 0.01) <span class="kw">label</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="estimation" class="level1">
<h1>Estimation</h1>
<section id="mr-standard-errors" class="level2">
<h2 class="anchored" data-anchor-id="mr-standard-errors">MR: Standard Errors</h2>
<p><span class="math display">\[\text{SE}(\hat{\beta}_1) = \frac{\text{Std}[e]}{\sqrt{n}\text{Std}(x_1)\color{blue}{\sqrt{1 - R^2_1}}}\]</span></p>
<ul>
<li><strong>Same</strong>:
<ul>
<li>the <strong>SE</strong> is small if better the fit, large samples, or large the Std of <span class="math inline">\(x_1\)</span>.</li>
</ul></li>
<li><strong>New</strong>: <span class="math inline">\(\sqrt{1 - R^2_1}\)</span> term in the denominator.
<ul>
<li>the R-squared of the regression of <span class="math inline">\(x_1\)</span> on <span class="math inline">\(x_2\)</span></li>
</ul></li>
<li>The higher is <span class="math inline">\(R^2_1\)</span>, the larger the SE of <span class="math inline">\(\hat{\beta}_1\)</span>.</li>
<li>Note: in practice, use <strong>robust SE</strong></li>
</ul>
</section>
<section id="mr-collinearity" class="level2">
<h2 class="anchored" data-anchor-id="mr-collinearity">MR: Collinearity</h2>
<ul>
<li><strong>Perfectly</strong> collinearity is when <span class="math inline">\(x_i\)</span> is a linear function of <span class="math inline">\(x_{-i}\)</span>.
<ul>
<li>Consequence: cannot calculate coefficients.</li>
<li>One will be dropped by software (but you should know which one).</li>
</ul></li>
<li><strong>Strong</strong> but imperfect correlation between explanatory is sometimes called multicollinearity.
<ul>
<li>Consequence: We can get the slope coefficients and their standard errors,</li>
<li>But, the standard errors may be large.</li>
</ul></li>
</ul>
</section>
<section id="mr-collinearity-and-se" class="level2">
<h2 class="anchored" data-anchor-id="mr-collinearity-and-se">MR: Collinearity and SE</h2>
<ul>
<li>Strong multicollinearity is a problem because it increases the standard errors of the coefficients.
<ul>
<li>It is typically a problem when the sample size is small.</li>
</ul></li>
<li>Numerically, it could make the coefficient estimates unstable. (rare)</li>
<li>More often, you may need to either drop one of the variables, or</li>
<li>Combine them into a single variable. (index)</li>
</ul>
<p>How to know how strong is the multicollinearity problem ??</p>
<ul>
<li>Estimate <span class="math inline">\(R^2\)</span> of the regression of <span class="math inline">\(x_i\)</span> on all other <span class="math inline">\(x\)</span> variables. For all cases!
<ul>
<li>or use the <code>estat vif</code> command in Stata. (only with OLS)</li>
</ul></li>
</ul>
</section>
<section id="mr-collinearity-1" class="level2">
<h2 class="anchored" data-anchor-id="mr-collinearity-1">MR: Collinearity</h2>
<div id="5cccba22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span>:frause oaxaca, <span class="kw">clear</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span>:<span class="kw">regress</span> lnwage female educ exper tenure c.age c.age#c.age, <span class="kw">robust</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">estat</span> <span class="kw">vif</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>div.jp-Notebook .datagrid-container {min-height: 448px; }</style>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Variable |       VIF       1/VIF  
-------------+----------------------
      female |      1.11    0.900413
        educ |      1.15    0.873284
       exper |      2.48    0.403924
      tenure |      1.82    0.549891
         age |     54.62    0.018310
 c.age#c.age |     53.08    0.018839
-------------+----------------------
    Mean VIF |     19.04</code></pre>
</div>
</div>
</section>
<section id="mr-testing-single-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="mr-testing-single-hypotheses">MR: Testing Single hypotheses</h2>
<ul>
<li>Same as before, but now we have more than one <span class="math inline">\(x\)</span> variable to test.
<ul>
<li><span class="math inline">\(H_0: \beta_1 = 0\)</span></li>
</ul></li>
<li>You may want to be careful with multiple testing.
<ul>
<li>testing each coefficient separately with the same <span class="math inline">\(\alpha\)</span> level</li>
</ul></li>
<li>There is also testing single hypotheses on combinations of coefficients.
<ul>
<li>$H_0: _1-2*_2=0 $</li>
</ul></li>
<li>As before, you just need to know the point estimate and the standard error to calculate the t-statistic.</li>
</ul>
</section>
<section id="mr-testing-joint-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="mr-testing-joint-hypotheses">MR: Testing Joint hypotheses</h2>
<ul>
<li>Testing joint hypotheses: null hypotheses that contain statements about more than one regression coefficient: <span class="math inline">\(H_0: \beta_1 = \beta_2 = 0\)</span> vs <span class="math inline">\(H_1: H_0\)</span> is false</li>
<li>This kind of test is used to evaluate a subset of the coefficients (such as all geographical variables) are all zero.</li>
<li>But for doing this you need a new test statistic: the <strong>F-test</strong>.</li>
</ul>
<p>Difference with the t-test:</p>
<ul>
<li>In contrast with the t-test, the F-test follows an F-distribution.</li>
<li>This distribution is not symmetric! And you need to know the degrees of freedom.
<ul>
<li>How many restrictions are you imposing? and how many coefficients did you estimate?</li>
</ul></li>
<li>Also, all test are on-sided</li>
</ul>
</section>
<section id="mr-testing-joint-hypotheses-1" class="level2">
<h2 class="anchored" data-anchor-id="mr-testing-joint-hypotheses-1">MR: Testing Joint hypotheses</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/F-test_plot.svg/1280px-F-test_plot.svg.png" class="img-fluid figure-img"></p>
<figcaption>F-test</figcaption>
</figure>
</div>
</section>
<section id="mr-testing-hypotheses-in-stata" class="level2">
<h2 class="anchored" data-anchor-id="mr-testing-hypotheses-in-stata">MR: Testing hypotheses in Stata</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Regression</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Joint test</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Single test Combined</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div id="634c6358" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">qui</span>:<span class="kw">webuse</span> dui, <span class="kw">clear</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">regress</span>  citations  fines i.taxes i.csize i.college, <span class="kw">robust</span> nohead</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>** <span class="kw">regress</span>, coefleg to know <span class="st">"names"</span> <span class="kw">of</span> variables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>------------------------------------------------------------------------------
             |               Robust
   citations | Coefficient  std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       fines |  -7.690437   .3843873   -20.01   0.000    -8.445672   -6.935201
             |
       taxes |
        Tax  |  -4.493918   .5819239    -7.72   0.000    -5.637269   -3.350566
             |
       csize |
     Medium  |   5.492308    .531599    10.33   0.000     4.447834    6.536782
      Large  |   11.23563   .5709191    19.68   0.000      10.1139    12.35736
             |
     college |
    College  |   5.828441    .588277     9.91   0.000     4.672607    6.984274
       _cons |   94.21955   3.948926    23.86   0.000     86.46079    101.9783
------------------------------------------------------------------------------</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div id="0f8f6e06" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">test</span> 1.taxes 1.college <span class="co">// &lt;- automatically test the joint hypothesis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ( 1)  1.taxes = 0
 ( 2)  1.college = 0

       F(  2,   494) =   66.74
            Prob &gt; F =    0.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div id="29c11dfa" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>** <span class="st">"H0: 2*B_Taxes = B_fines"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">lincom</span> 2*1.taxes-fines</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ( 1)  - fines + 2*1.taxes = 0

------------------------------------------------------------------------------
   citations | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         (1) |  -1.297398   1.098122    -1.18   0.238    -3.454964    .8601678
------------------------------------------------------------------------------</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="mr-non-linear-patterns" class="level2">
<h2 class="anchored" data-anchor-id="mr-non-linear-patterns">MR: Non-linear patterns</h2>
<ul>
<li>Surprise! you can use the same tools as with single regression
<ul>
<li>Uses splines, polynomials, other non-linear functions of <span class="math inline">\(x\)</span> variables.</li>
</ul></li>
<li>Non-linear function of various <span class="math inline">\(x_i\)</span> variables may be combined.</li>
<li>As show before, using non-linear functions will increase multicollinearity, but worry not about that type of collinearity.</li>
<li>Be more careful with the interpretation of the coefficients.</li>
</ul>
</section>
<section id="cs-understanding-the-gender-difference-in-earnings" class="level2">
<h2 class="anchored" data-anchor-id="cs-understanding-the-gender-difference-in-earnings">CS: Understanding the gender difference in earnings</h2>
<ul>
<li>In the USA (2014), women tend to earn about 20% less than men</li>
<li>Aim 1: Find patterns to better understand the gender gap. Our focus is the interaction with age.</li>
<li>Aim 2: Think about if there is a causal link from being female to getting paid less.</li>
</ul>
</section>
<section id="cs-the-data" class="level2">
<h2 class="anchored" data-anchor-id="cs-the-data">CS: The data</h2>
<ul>
<li>2014 census data</li>
<li>Age between 15 to 65</li>
<li>Exclude self-employed <em>(earnings is difficult to measure)</em></li>
<li>Include those who reported 20 hours more as their usual weekly time worked</li>
<li>Employees with a graduate degree (higher than 4-year college)</li>
<li>Use log hourly earnings (<span class="math inline">\(\ln w\)</span>) as dependent variable</li>
<li>Use gender and add age as explanatory variables</li>
</ul>
</section>
<section id="cs-the-model" class="level2">
<h2 class="anchored" data-anchor-id="cs-the-model">CS: The model</h2>
<p>We are quite familiar with the relation between earnings and gender: <span class="math display">\[\ln w_E = \alpha + \beta\text{female}, \beta &lt; 0\]</span> Let’s include age as well: <span class="math display">\[\ln w_E = \beta_0 + \beta_1\text{female} + \beta_2\text{age}\]</span></p>
<p>What happens if we do not include age?</p>
</section>
<section id="cs-the-regression" class="level2">
<h2 class="anchored" data-anchor-id="cs-the-regression">CS: The Regression</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Variables</strong></th>
<th>ln wage</th>
<th>ln wage</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>female</strong></td>
<td>-0.195**</td>
<td>-0.185**</td>
<td>-1.484**</td>
</tr>
<tr class="even">
<td></td>
<td>(0.008)</td>
<td>(0.008)</td>
<td>(0.159)</td>
</tr>
<tr class="odd">
<td><strong>age</strong></td>
<td></td>
<td>0.007**</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>(0.000)</td>
<td></td>
</tr>
<tr class="odd">
<td>Constant</td>
<td>3.514**</td>
<td>3.198**</td>
<td>44.630**</td>
</tr>
<tr class="even">
<td></td>
<td>(0.006)</td>
<td>(0.018)</td>
<td>(0.116)</td>
</tr>
<tr class="odd">
<td>Observations</td>
<td>18,241</td>
<td>18,241</td>
<td>18,241</td>
</tr>
<tr class="even">
<td>R-squared</td>
<td>0.028</td>
<td>0.046</td>
<td>0.005</td>
</tr>
</tbody>
</table>
<div class="small-text" style="text-align: center">
<p>Note: Robust standard errors in parentheses<br>
*** p&lt;0.01, ** p&lt;0.05, * p&lt;0.1<br>
Source: cps-earnings dataset. 2014 CPS Morg.</p>
</div>
<p>What if Age is not linear? (has a non-linear effect on earnings)</p>
</section>
<section id="cs-adjustment-and-robustness" class="level2">
<h2 class="anchored" data-anchor-id="cs-adjustment-and-robustness">CS: Adjustment and Robustness</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Variable</strong></th>
<th>Model 1</th>
<th>Model 2</th>
<th>Model 3</th>
<th>Model 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>female</strong></td>
<td>-0.195**</td>
<td>-0.185**</td>
<td>-0.183**</td>
<td>-0.183**</td>
</tr>
<tr class="even">
<td></td>
<td>(0.008)</td>
<td>(0.008)</td>
<td>(0.008)</td>
<td>(0.008)</td>
</tr>
<tr class="odd">
<td><strong>age</strong></td>
<td></td>
<td>0.007**</td>
<td>0.063**</td>
<td>0.572**</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>(0.000)</td>
<td>(0.003)</td>
<td>(0.116)</td>
</tr>
<tr class="odd">
<td><strong>age2</strong></td>
<td></td>
<td></td>
<td>-0.001**</td>
<td>-0.017**</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td>(0.000)</td>
<td>(0.004)</td>
</tr>
<tr class="odd">
<td><strong>age3</strong></td>
<td></td>
<td></td>
<td></td>
<td>0.000**</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td>(0.000)</td>
</tr>
<tr class="odd">
<td><strong>Observations</strong></td>
<td>18,241</td>
<td>18,241</td>
<td>18,241</td>
<td>18,241</td>
</tr>
<tr class="even">
<td><strong>R-squared</strong></td>
<td>0.028</td>
<td>0.046</td>
<td>0.060</td>
<td>0.062</td>
</tr>
</tbody>
</table>
<div class="small-text" style="text-align: center">
<p>Note: Robust standard errors in parentheses, *** p&lt;0.01, ** p&lt;0.05, * p&lt;0.1<br>
Source: cps-earnings dataset. 2014 CPS Morg.</p>
</div>
</section>
</section>
<section id="qualitative-variables-and-interactions" class="level1">
<h1>Qualitative variables <br> and interactions</h1>
<p>Traditional way to make things more interesting</p>
<section id="mr-qualitative-variables" class="level2">
<h2 class="anchored" data-anchor-id="mr-qualitative-variables">MR: Qualitative variables</h2>
<ul>
<li>MR can also handle using qualitative variables as explanatory variables.</li>
<li>Two ways to include qualitative variables:
<ul>
<li>Create a dummy for each category.</li>
<li>Let the software create the binary variables for you.</li>
</ul></li>
<li>You can only include <span class="math inline">\(k-1\)</span> dummies (dummy variable trap)
<ul>
<li>Left out category is the reference category (Base).</li>
</ul></li>
<li><code>Stata Corner</code>
<ul>
<li><code>i.</code> in front of a variable tells Stata to treat it as a categorical variable. (makes dummies on the background): <code>reg lnwage i.educ</code></li>
<li>But, the categorical variable cannot be negative.</li>
</ul></li>
</ul>
</section>
<section id="mr-qualitative-variables-1" class="level2">
<h2 class="anchored" data-anchor-id="mr-qualitative-variables-1">MR: Qualitative variables</h2>
<p>Say <span class="math inline">\(X\)</span> is a qualitative variable with <span class="math inline">\(3\)</span> categories: low, medium, and high. <span class="math display">\[y^E = \beta_0 + \beta_1 D^{med} + \beta_2 D^{high}\]</span></p>
<ul>
<li><strong>low</strong> is the reference category. Other values compared to this.</li>
<li><span class="math inline">\(\beta_0\)</span> shows average <span class="math inline">\(y\)</span> in the reference category. (medium and high <span class="math inline">\(=0\)</span>)</li>
<li><span class="math inline">\(\beta_1\)</span>: Average difference between <span class="math inline">\(D_{medium}\)</span> and <span class="math inline">\(D_low\)</span></li>
<li><span class="math inline">\(\beta_2\)</span>: Average difference between <span class="math inline">\(D_{high}\)</span> and <span class="math inline">\(D_low\)</span></li>
</ul>
</section>
<section id="mr-how-to-pick-a-reference-category" class="level2">
<h2 class="anchored" data-anchor-id="mr-how-to-pick-a-reference-category">MR: How to pick a reference category?</h2>
<ul>
<li>Choose the category to which we want to compare the rest.
<ul>
<li>Home country, the capital city, the lowest or highest value group.</li>
</ul></li>
<li>Or, chose a category with a large number of observations.
<ul>
<li>Important when inference is important, and SE are needed.</li>
</ul></li>
<li>For prediction, it does not matter.</li>
</ul>
</section>
<section id="cs-gender-difference-in-earnings-and-education" class="level2">
<h2 class="anchored" data-anchor-id="cs-gender-difference-in-earnings-and-education">CS: Gender difference in earnings and education</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 40%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Variables</th>
<th style="text-align: center;">ln wage</th>
<th style="text-align: center;">ln wage</th>
<th style="text-align: center;">ln wage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>female</td>
<td style="text-align: center;">-0.195**</td>
<td style="text-align: center;">-0.182**</td>
<td style="text-align: center;">-0.182**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;">(0.008)</td>
<td style="text-align: center;">(0.009)</td>
<td style="text-align: center;">(0.009)</td>
</tr>
<tr class="odd">
<td>ed_Profess</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0.134**</td>
<td style="text-align: center;">-0.002</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">(0.015)</td>
<td style="text-align: center;">(0.018)</td>
</tr>
<tr class="odd">
<td>ed_PhD</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0.136**</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">(0.013)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>ed_MA</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-0.136**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">(0.013)</td>
</tr>
<tr class="odd">
<td>Constant</td>
<td style="text-align: center;">3.514**</td>
<td style="text-align: center;">3.473**</td>
<td style="text-align: center;">3.609**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;">(0.006)</td>
<td style="text-align: center;">(0.007)</td>
<td style="text-align: center;">(0.013)</td>
</tr>
<tr class="odd">
<td>Observations</td>
<td style="text-align: center;">18,241</td>
<td style="text-align: center;">18,241</td>
<td style="text-align: center;">18,241</td>
</tr>
<tr class="even">
<td>R-squared</td>
<td style="text-align: center;">0.028</td>
<td style="text-align: center;">0.038</td>
<td style="text-align: center;">0.038</td>
</tr>
</tbody>
</table>
</section>
<section id="mr-interactions" class="level2">
<h2 class="anchored" data-anchor-id="mr-interactions">MR: Interactions</h2>
<ul>
<li>Often data is made up of important groups: male and female workers or countries in different continents.</li>
<li>and, <strong>Some</strong> of the patterns we are after may vary across these groups.</li>
<li>The strength of a relation may also be altered by a special variable.
<ul>
<li>In medicine, a moderator variable can reduce or amplify the effect of a drug on people.</li>
<li>In business, financial strength can affect how firms may weather a recession.</li>
</ul></li>
<li><strong>Message:</strong> different patterns for subsets of observations.</li>
</ul>
</section>
<section id="mr-interactions-and-parallel-lines" class="level2">
<h2 class="anchored" data-anchor-id="mr-interactions-and-parallel-lines">MR: Interactions and parallel lines</h2>
<ul>
<li><strong>Option 1</strong>: Simply the Dummy to the model
<ul>
<li><span class="math inline">\(y^E = \beta_0 + \beta_1 x_1 + \beta_2 D\)</span></li>
</ul></li>
<li>This assumes <span class="math inline">\(\beta_1\)</span> is the same for both groups, only the intercepts are different.</li>
<li><strong>Option 2</strong>: Different slopes
<ul>
<li><span class="math inline">\(y^E = \beta_0 + \beta_1 x_1 + \beta_2 D + \beta_3 x_1 \times D\)</span><br>
</li>
</ul></li>
<li>This now assumes slopes are different for both groups.</li>
<li><strong>Option 3</strong>: Separate regressions
<ul>
<li>But Option 2 is better for testing if slopes are different.</li>
</ul></li>
</ul>
</section>
<section id="mr-interaction-with-two-continuous-variable" class="level2">
<h2 class="anchored" data-anchor-id="mr-interaction-with-two-continuous-variable">MR: Interaction with two continuous variable</h2>
<ul>
<li><p>Interactions can also be used with continuous variables, <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>: <span class="math display">\[y_E = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_1 x_2\]</span></p></li>
<li><p>Example:</p>
<ul>
<li><span class="math inline">\(y\)</span> is change in revenue <span class="math inline">\(x_1\)</span> is change in global demand, <span class="math inline">\(x_2\)</span> is firm’s financial health</li>
<li>The interaction can capture that drop in demand can cause financial problems in firms, but less so for firms with better balance sheet.</li>
</ul></li>
<li><p>Perhaps biggest challenge is to interpret a model with interactions.</p></li>
</ul>
</section>
<section id="mr-interaction-with-two-continuous-variable-1" class="level2">
<h2 class="anchored" data-anchor-id="mr-interaction-with-two-continuous-variable-1">MR: Interaction with two continuous variable</h2>
<ul>
<li>The interaction term <span class="math inline">\(x_1 x_2\)</span> captures how this two variables affect each others effect on <span class="math inline">\(y\)</span>.
<ul>
<li>Typically we assume this is zero.</li>
</ul></li>
<li>The coefficient <span class="math inline">\(\beta_3\)</span> captures the magnitude of the interaction effect.</li>
<li>However, if you are interested in the relationship betwee <span class="math inline">\(x_1\)</span> or <span class="math inline">\(x_2\)</span> with <span class="math inline">\(y\)</span>, you need extra care.
<ul>
<li><span class="math inline">\(x_1\)</span> on <span class="math inline">\(y\)</span> is <span class="math inline">\(\frac{dy}{dx_1}=\beta_1 + \beta_3 x_2\)</span>.</li>
<li><span class="math inline">\(x_2\)</span> on <span class="math inline">\(y\)</span> is <span class="math inline">\(\frac{dy}{dx_2}=\beta_2 + \beta_3 x_1\)</span>.<br>
</li>
<li>So you need to “fix” <span class="math inline">\(x_2\)</span> to see the effect of <span class="math inline">\(x_1\)</span> on <span class="math inline">\(y\)</span>. (typically at the mean)</li>
</ul></li>
</ul>
</section>
<section id="cs-interaction-between-gender-and-age" class="level2">
<h2 class="anchored" data-anchor-id="cs-interaction-between-gender-and-age">CS: Interaction between gender and age</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Separate, Earning for men rises faster with age</li>
<li>With interaction, Same result!.</li>
<li>Female dummy is close to zero. Does this mean no gender gap?
<ul>
<li>No, Cumulative effect: <span class="math inline">\(-0.036-0.003*age\)</span></li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Variables</th>
<th style="text-align: center;">ln wage (Women)</th>
<th style="text-align: center;">ln wage (Men)</th>
<th style="text-align: center;">ln wage (All)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>female</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-0.036</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">(0.035)</td>
</tr>
<tr class="odd">
<td><strong>age</strong></td>
<td style="text-align: center;">0.006**</td>
<td style="text-align: center;">0.009**</td>
<td style="text-align: center;">0.009**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;">(0.001)</td>
<td style="text-align: center;">(0.001)</td>
<td style="text-align: center;">(0.001)</td>
</tr>
<tr class="odd">
<td><strong>female × age</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-0.003**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">(0.001)</td>
</tr>
<tr class="odd">
<td><strong>Constant</strong></td>
<td style="text-align: center;">3.081**</td>
<td style="text-align: center;">3.117**</td>
<td style="text-align: center;">3.117**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;">(0.023)</td>
<td style="text-align: center;">(0.026)</td>
<td style="text-align: center;">(0.026)</td>
</tr>
<tr class="odd">
<td><strong>Observations</strong></td>
<td style="text-align: center;">9,685</td>
<td style="text-align: center;">8,556</td>
<td style="text-align: center;">18,241</td>
</tr>
<tr class="even">
<td><strong>R-squared</strong></td>
<td style="text-align: center;">0.011</td>
<td style="text-align: center;">0.028</td>
<td style="text-align: center;">0.047</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="mr-stata-corner" class="level2">
<h2 class="anchored" data-anchor-id="mr-stata-corner">MR: Stata corner</h2>
<ul>
<li>In <code>Stata</code> you can use <code>i.</code> to create dummies for all categories of a variable.</li>
<li>You can also use <code>#</code> to create interactions between variables.
<ul>
<li>Unless specified, Stata assume variables are categorical. You can use <code>c.</code> for continuous variables.</li>
</ul></li>
<li>You can also use <code>##</code> to create interactions plus the main effects.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">regress</span> <span class="fu">y</span> i.x1##c.<span class="kw">x2</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>is equivalent to</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">regress</span> <span class="fu">y</span> i.x1 c.<span class="kw">x2</span> i.x1#c.<span class="kw">x2</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>where i.x1 will create <span class="ot">all</span> dummies <span class="kw">for</span> x1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>If dummies and interactions are created this way you can use <code>margins</code> to calculate effects of main variables.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>margins, <span class="kw">dydx</span>(x1 <span class="kw">x2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="conditioning-and-causality" class="level1">
<h1>Conditioning and causality</h1>
<section id="mr-causal-analysis" class="level2">
<h2 class="anchored" data-anchor-id="mr-causal-analysis">MR: Causal analysis</h2>
<ul>
<li>One main reason to estimate multiple regressions is to get closer to a causal interpretation.</li>
<li>By conditioning on other observable variables, we can get closer to comparing similar objects – “apples to apples” – even in observational data.</li>
<li><strong>But</strong> getting closer is not the same as getting there.</li>
<li>In principle, one could try conditioning on every potential confounder: variables that would affect <span class="math inline">\(y\)</span> and the causal variable <span class="math inline">\(x_1\)</span> at the same time.</li>
<li>Ceteris paribus = conditioning on every such relevant variable. (everything else constant).</li>
</ul>
</section>
<section id="mr-causal-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="mr-causal-analysis-1">MR: Causal analysis</h2>
<ul>
<li>In randomized experiments, we can use causal language: treated and untreated units similar - by random grouping.</li>
<li>In observational data, comparisons don’t uncover causal relations.
<ul>
<li>Cautious with language. Avoid use of “effect”, “increase”. But could use “associated with”, “linked to”.</li>
<li>Regression, even with multiple <span class="math inline">\(x\)</span> is just comparison. Conditional mean.</li>
</ul></li>
</ul>
</section>
<section id="mr-causal-analysis-dont-overdo-it" class="level2">
<h2 class="anchored" data-anchor-id="mr-causal-analysis-dont-overdo-it">MR: Causal analysis Don’t overdo it</h2>
<ul>
<li>Not all variables should be included as control variables even if correlated both with the causal variable and the dependent variable.</li>
<li><strong>Bad conditioning</strong> variables are variables that are correlated both with the causal variable and the dependent variable but are actually part of the causal mechanism.
<ul>
<li>This is the reason to exclude them.</li>
</ul></li>
<li>Example, should you control for visit to the doctor when estimating the effect of health spending on health?
<ul>
<li>No, because visiting the doctor is part of the causal mechanism.</li>
</ul></li>
</ul>
</section>
<section id="mr-causal-analysis-2" class="level2">
<h2 class="anchored" data-anchor-id="mr-causal-analysis-2">MR: Causal analysis</h2>
<ul>
<li>A multiple regression on observational data is rarely capable of uncovering a causal relationship.
<ul>
<li>Cannot capture all potential confounder. (Not ceteris paribus)</li>
<li>Potential Bad conditioning variables (bad controls)</li>
<li>We can never really know.</li>
</ul></li>
<li>Multiple regression can get us <strong>closer</strong> to uncovering a causal relationship
<ul>
<li>Compare units that are the same in many respects - controls</li>
</ul></li>
</ul>
</section>
<section id="cs-understanding-the-gender-difference-in-earnings-1" class="level2">
<h2 class="anchored" data-anchor-id="cs-understanding-the-gender-difference-in-earnings-1">CS: Understanding the gender difference in earnings</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Variables</th>
<th style="text-align: center;">ln wage (Model 1)</th>
<th style="text-align: center;">ln wage (Model 2)</th>
<th style="text-align: center;">ln wage (Model 3)</th>
<th style="text-align: center;">ln wage (Model 4)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>female</strong></td>
<td style="text-align: center;">-0.224**</td>
<td style="text-align: center;">-0.212**</td>
<td style="text-align: center;">-0.151**</td>
<td style="text-align: center;">-0.141**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;">(0.012)</td>
<td style="text-align: center;">(0.012)</td>
<td style="text-align: center;">(0.012)</td>
<td style="text-align: center;">(0.012)</td>
</tr>
<tr class="odd">
<td><strong>Age and education</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="even">
<td><strong>Family circumstances</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="odd">
<td><strong>Demographic background</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="even">
<td><strong>Job characteristics</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="odd">
<td><strong>Union member</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="even">
<td><strong>Age in polynomial</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="odd">
<td><strong>Hours in polynomial</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="even">
<td><strong>Observations</strong></td>
<td style="text-align: center;">9,816</td>
<td style="text-align: center;">9,816</td>
<td style="text-align: center;">9,816</td>
<td style="text-align: center;">9,816</td>
</tr>
<tr class="odd">
<td><strong>R-squared</strong></td>
<td style="text-align: center;">0.036</td>
<td style="text-align: center;">0.043</td>
<td style="text-align: center;">0.182</td>
<td style="text-align: center;">0.195</td>
</tr>
</tbody>
</table>
<p>More and more confounders added</p>
</section>
<section id="regression-table-detour" class="level2">
<h2 class="anchored" data-anchor-id="regression-table-detour">Regression table detour</h2>
<ul>
<li>Regression table with many <span class="math inline">\(x\)</span> vars is hard to present</li>
<li>In presentation, <strong>suppress</strong> unimportant coefficients</li>
<li>In paper, you may present more, but mostly if you want to discuss them or for <em>sanity check</em></li>
<li><strong>Sanity check</strong>: do control variable coefficient make sense by and large?</li>
<li>Check <span class="math inline">\(N\)</span> of observations: if the same sample, should be exactly the same.</li>
<li><span class="math inline">\(R^2\)</span> is enough, no need for other stuff (unless other methods are used)</li>
</ul>
</section>
</section>
<section id="prediction" class="level1">
<h1>Prediction</h1>
<section id="mr-prediction-and-benchmarking" class="level2">
<h2 class="anchored" data-anchor-id="mr-prediction-and-benchmarking">MR: Prediction and benchmarking</h2>
<ul>
<li>Second reason to estimate a multiple regression is to make a prediction
<ul>
<li>find the best guess for the dependent variable <span class="math inline">\(y_j\)</span> for a particular observation <span class="math inline">\(j\)</span> <span class="math display">\[\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x_1 + \hat{\beta}_2 x_2 + \cdots\]</span></li>
</ul></li>
<li>A <span class="math inline">\(\hat{y} \ vs \ y\)</span> Scatter plot is a good way to visualize the fit of a prediction.
<ul>
<li>As well as identifying over or underpredictions.</li>
</ul></li>
<li>We want the regression to produce as <em>good</em> a fit as possible.
<ul>
<li><strong>A common danger</strong>: Overfitting the data: finding patterns in the data that are not true in the population</li>
</ul></li>
<li>We will discuss more about prediction in the next chapters.</li>
</ul>
</section>
<section id="mr-variable-selection" class="level2">
<h2 class="anchored" data-anchor-id="mr-variable-selection">MR: Variable selection</h2>
<ul>
<li>How should one decide which variables to include? and how?</li>
<li>Depends on the purpose: prediction or causality.</li>
</ul>
<p>General Advice:</p>
<ul>
<li>Lot of judgment calls: theory, data, and context.</li>
<li>Non-linear fit, use a non-parametric first and if non-linear, pick a model that is close - quadratic, piecewise spline.</li>
<li>If two or many variables strongly correlated, pick one of them.</li>
<li>Keep it as simple as possible: Parsimony is a virtue.</li>
</ul>
</section>
<section id="mr-variable-selection-for-causal-questions" class="level2">
<h2 class="anchored" data-anchor-id="mr-variable-selection-for-causal-questions">MR: Variable selection for causal questions</h2>
<ul>
<li>Causal question: <span class="math inline">\(x\)</span> impact on <span class="math inline">\(y\)</span>. Having <span class="math inline">\(z\)</span> variables to condition on, to get closer to causality.</li>
<li>Our aim is to focus on the coefficient on one variable. What matters are the estimated value of the coefficient and its confidence interval. Not prediction.</li>
<li>Keep <span class="math inline">\(z\)</span> – keep variables that help comparing units</li>
<li>Drop <span class="math inline">\(z\)</span> if they not matter, or if they are part of the causal mechanism. (affected by <span class="math inline">\(x\)</span>)
<ul>
<li>Functional form for <span class="math inline">\(z\)</span> matters only for crucial confounders. (linear is fine)</li>
</ul></li>
<li>Present the model you judge is best, and then report a few other solutions – robustness.</li>
</ul>
</section>
<section id="mr-variable-selection-process" class="level2">
<h2 class="anchored" data-anchor-id="mr-variable-selection-process">MR: Variable selection – process</h2>
<ul>
<li>Select control variables you want to include</li>
<li>Select functional form one by one</li>
<li>Focus on <strong>key</strong> variables by domain knowledge (theory), add the rest linearly</li>
<li>Key issue is sample size
<ul>
<li>For 20-40 obs, about 1-2 variables.</li>
<li>For 50-100 obs, about 2-4 variables</li>
<li>Few hundred obs, 5-10 variables could work</li>
<li>Few thousand obs, few dozen variables, including industry/country/profession etc dummmmies, interactions.</li>
<li>10-100K obs - many variables, polynomials, interactions</li>
</ul></li>
</ul>
</section>
<section id="mr-variable-selection-for-prediction" class="level2">
<h2 class="anchored" data-anchor-id="mr-variable-selection-for-prediction">MR: Variable selection for prediction</h2>
<ul>
<li>If Prediction is the goal, keep whatever works</li>
<li>Balance is needed to ensure it works beyond the data at hand</li>
<li><strong>Overfitting</strong>: building a model that captures some patterns that may fit the data in hand, but does not generalize well.</li>
<li>Focus on functional form, interactions</li>
<li>Value simplicity. Easier to explain, more robust.</li>
<li>Formal way:
<ul>
<li>BIC and AIC. Similar to R-squared but takes into account number of variables. The smaller, the better</li>
</ul></li>
<li>You may use Adj R2, (although not perfect) to compare models.</li>
</ul>
</section>
<section id="summary-take-away" class="level2">
<h2 class="anchored" data-anchor-id="summary-take-away">Summary take-away</h2>
<ul>
<li>Multiple regression are linear models with several <span class="math inline">\(x\)</span> variables.</li>
<li>May include binary variables and interactions</li>
<li>Multiple regression can take us closer to a causal interpretation and help make better predictions.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>