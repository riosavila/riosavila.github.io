<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-07ba0ad10f5680c660e360ac31d2f3b6.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.33">

  <meta name="author" content="Fernando Rios-Avila">
  <meta name="dcterms.date" content="2024-08-26">
  <title>Econometrics MSC Levy – Multiple regression analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-97edfe54b73ff960639f8ac44205bcc0.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

  

  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Multiple regression analysis</h1>
  <p class="subtitle">When one <span class="math inline">\(x\)</span> variable is not enough</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Fernando Rios-Avila 
</div>
        <p class="quarto-title-affiliation">
            Levy Economics Institute
          </p>
    </div>
</div>

  <p class="date">August 26, 2024</p>
</section>
<section id="motivation" class="slide level2">
<h2>Motivation</h2>
<ul>
<li>We are interested in finding evidence for or against labor market discrimination of women. Compare wages for men and women who share similarities in wage relevant factors such as experience and education.</li>
<li>Find a good deal on a hotel to spend a night in a European city- analyzed the pattern of hotel price and distance and many other features to find hotels that are underpriced not only for their location but also those other features.</li>
</ul>
</section>
<section id="topics-to-cover" class="slide level2">
<h2>Topics to cover</h2>
<ul>
<li>Multiple regression mechanics</li>
<li>Estimation and interpreting coefficients</li>
<li>Non-linear terms, interactions</li>
<li>Variable selection, small sample problems</li>
<li>Multiple regression and causality</li>
<li>Multiple regression and prediction</li>
</ul>
</section>
<section>
<section id="how-multivariate-ols-works" class="title-slide slide level1 center">
<h1>How multivariate OLS works</h1>

</section>
<section id="multivariate-regression" class="slide level2">
<h2>Multivariate Regression</h2>
<ul>
<li>Whenever you start modeling an outcome <span class="math inline">\(y\)</span>, there will always be two factors that will determine that outcome:
<ul>
<li>Factors that you can control (e.g., education, experience, etc.)</li>
<li>Factors that you cannot control (e.g., errors)<br>
</li>
</ul></li>
<li>Multiple regression analysis uncovers average <span class="math inline">\(y\)</span> as a function of more than one <span class="math inline">\(x\)</span> variable: <span class="math inline">\(y^E = f(x_1, x_2, ...)\)</span>.</li>
<li>It can lead to better predictions <span class="math inline">\(\hat{y}\)</span> by considering more explanatory variables.</li>
<li>It <strong>may</strong> improve the interpretation of slope coefficients by comparing observations that are similar in terms of other <span class="math inline">\(x's\)</span> variables.</li>
</ul>
</section>
<section id="multivariate-regression-1" class="slide level2">
<h2>Multivariate Regression</h2>
<ul>
<li><p>Multiple linear regression specifies a linear function of the explanatory variables for the average <span class="math inline">\(y\)</span>: <span class="math display">\[y^E = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_k x_k\]</span></p></li>
<li><p>But, now that we now we can have more than one <span class="math inline">\(x\)</span> variable, what happens if we don’t?</p></li>
</ul>
</section>
<section id="mr-ommited-variable-bias" class="slide level2">
<h2>MR: Ommited Variable Bias</h2>
<p>Lets say we have to models: <span class="math display">\[\begin{aligned}
y &amp;= \alpha_0 + \alpha_1 x_1 + \varepsilon_1  \\
y &amp;= \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \varepsilon_2
\end{aligned}
\]</span></p>
<ul>
<li>How do <span class="math inline">\(\alpha_1\)</span> and <span class="math inline">\(\beta_1\)</span> compare?</li>
<li>Lets Start by regressing <span class="math inline">\(x_2\)</span> on <span class="math inline">\(x_1\)</span>: <span class="math inline">\(x_2 = \delta_0 + \delta_1 x_1 + u\)</span></li>
<li>And plug this back into the second equation:</li>
</ul>
<p><span class="math display">\[\begin{aligned}
y &amp;= \beta_0 + \beta_1 x_1 + \beta_2 (\delta_0 + \delta_1 x_1 + u) + \varepsilon_2 \\
y &amp;= (\beta_0 + \beta_2\delta_0) + (\beta_1 + \beta_2 \delta_1) x  + (\beta_2 u + \varepsilon_2)
\end{aligned}
\]</span></p>
</section>
<section id="mr-ommited-variable-bias-1" class="slide level2">
<h2>MR: Ommited Variable Bias</h2>
<ul>
<li>So it turns out that:</li>
</ul>
<p><span class="math display">\[\alpha_1 = \beta_1 + \beta_2 \delta_1 \rightarrow \beta_1-\alpha_1 = -\beta_2 \delta_1
\]</span></p>
<ul>
<li>By “ignoring” <span class="math inline">\(x_2\)</span> in the first regression, we are actually estimating a <strong>biased</strong> coefficient for <span class="math inline">\(x_1\)</span>.
<ul>
<li>Assuming the second model is the “true” model</li>
</ul></li>
<li>This is what is known as the <strong>Omitted variable bias</strong> OBV
<ul>
<li>Note: You could also have a bias because you are including a variable that <strong>should not</strong> be there. This is known as <strong>bad control</strong>.</li>
</ul></li>
</ul>
</section>
<section id="mr-ommited-variable-bias-2" class="slide level2">
<h2>MR: Ommited Variable Bias</h2>
<ul>
<li><strong>OBV</strong> is a common problem in empirical research because we can never include all the variables that determine <span class="math inline">\(y\)</span>.</li>
<li>However, mechanically, there are two cases where OBV is not a problem:
<ul>
<li>When <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are uncorrelated (<span class="math inline">\(\delta_1 = 0\)</span>)</li>
<li>When <span class="math inline">\(y\)</span> and <span class="math inline">\(x_2\)</span> are uncorrelated (<span class="math inline">\(\beta_2 = 0\)</span>)</li>
</ul></li>
</ul>
</section>
<section id="simple-example" class="slide level2">
<h2>Simple example</h2>
<ul>
<li>TS regression: Regress month-to-month change in log quantity sold of Beer (<span class="math inline">\(y\)</span>) on month-to-month change in log price (<span class="math inline">\(x_1\)</span>).
<ul>
<li><span class="math inline">\(\beta = -0.5\)</span>: sales tend to decrease by 0.5% when our price increases by 1%.</li>
</ul></li>
<li>Robustness: <span class="math inline">\(x_2\)</span>: change in ln average price charged by our competitors
<ul>
<li>New Results: <span class="math inline">\(\hat{\beta}_1 = -3\)</span> and <span class="math inline">\(\hat{\beta}_2 = 3\)</span></li>
</ul></li>
<li>There is a <strong><em>OBV</em></strong> (Model 1 is flatter than Model 2)</li>
<li>Possibly the result of two things:
<ul>
<li>a positive association between the two price changes (<span class="math inline">\(\delta_1\)</span>) and</li>
<li>a positive association between competitor price and our own sales (<span class="math inline">\(\beta_2\)</span>).</li>
</ul></li>
</ul>
</section>
<section id="mr-some-language" class="slide level2">
<h2>MR: Some language</h2>
<ul>
<li><p><strong>Setup:</strong> Multiple regression with two explanatory variables (<span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>),</p></li>
<li><p><strong>Technicallity:</strong>: We measure differences in expected <span class="math inline">\(y\)</span> across observations that differ in <span class="math inline">\(x_1\)</span> but are similar in terms of <span class="math inline">\(x_2\)</span>.</p></li>
<li><p><strong>Interpretation:</strong> Difference in <span class="math inline">\(y\)</span> by <span class="math inline">\(x_1\)</span>, conditional on <span class="math inline">\(x_2\)</span>. OR controlling for <span class="math inline">\(x_2\)</span>.</p>
<ul>
<li>We condition on <span class="math inline">\(x_2\)</span>, or control for <span class="math inline">\(x_2\)</span>, when we include <span class="math inline">\(x_2\)</span> in a multiple regression that focuses on average differences in <span class="math inline">\(y\)</span> by <span class="math inline">\(x_1\)</span>.</li>
</ul></li>
<li><p>What we care is <span class="math inline">\(x_1\)</span>’s effect on <span class="math inline">\(y\)</span>, but we control for <span class="math inline">\(x_2\)</span> to get a better estimate of this effect.</p></li>
<li><p><strong>Confounding:</strong> <span class="math inline">\(x_2\)</span> is a confounder if <span class="math inline">\(x_2\)</span> is correlated with <span class="math inline">\(x_1\)</span> and <span class="math inline">\(y\)</span>.</p>
<ul>
<li>Thus, we have a problem if we omit <span class="math inline">\(x_2\)</span> from the regression.</li>
</ul></li>
</ul>
</section>
<section id="stata-multiple-regression" class="slide level2">
<h2>Stata: Multiple regression</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb1-1"><a></a><span class="kw">regress</span> <span class="fu">y</span> x1 [<span class="kw">x2</span> x3 ... ], <span class="kw">robust</span></span>
<span id="cb1-2"><a></a><span class="kw">estimates</span> <span class="kw">store</span> m1</span>
<span id="cb1-3"><a></a>esttab m1, <span class="kw">star</span>(* 0.10 ** 0.05 *** 0.01) <span class="kw">label</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section>
<section>
<section id="estimation" class="title-slide slide level1 center">
<h1>Estimation</h1>

</section>
<section id="mr-standard-errors" class="slide level2">
<h2>MR: Standard Errors</h2>
<p><span class="math display">\[\text{SE}(\hat{\beta}_1) = \frac{\text{Std}[e]}{\sqrt{n}\text{Std}(x_1)\color{blue}{\sqrt{1 - R^2_1}}}\]</span></p>
<ul>
<li><strong>Same</strong>:
<ul>
<li>the <strong>SE</strong> is small if better the fit, large samples, or large the Std of <span class="math inline">\(x_1\)</span>.</li>
</ul></li>
<li><strong>New</strong>: <span class="math inline">\(\sqrt{1 - R^2_1}\)</span> term in the denominator.
<ul>
<li>the R-squared of the regression of <span class="math inline">\(x_1\)</span> on <span class="math inline">\(x_2\)</span></li>
</ul></li>
<li>The higher is <span class="math inline">\(R^2_1\)</span>, the larger the SE of <span class="math inline">\(\hat{\beta}_1\)</span>.</li>
<li>Note: in practice, use <strong>robust SE</strong></li>
</ul>
</section>
<section id="mr-collinearity" class="slide level2">
<h2>MR: Collinearity</h2>
<ul>
<li><strong>Perfectly</strong> collinearity is when <span class="math inline">\(x_i\)</span> is a linear function of <span class="math inline">\(x_{-i}\)</span>.
<ul>
<li>Consequence: cannot calculate coefficients.</li>
<li>One will be dropped by software (but you should know which one).</li>
</ul></li>
<li><strong>Strong</strong> but imperfect correlation between explanatory is sometimes called multicollinearity.
<ul>
<li>Consequence: We can get the slope coefficients and their standard errors,</li>
<li>But, the standard errors may be large.</li>
</ul></li>
</ul>
</section>
<section id="mr-collinearity-and-se" class="slide level2">
<h2>MR: Collinearity and SE</h2>
<ul>
<li>Strong multicollinearity is a problem because it increases the standard errors of the coefficients.
<ul>
<li>It is typically a problem when the sample size is small.</li>
</ul></li>
<li>Numerically, it could make the coefficient estimates unstable. (rare)</li>
<li>More often, you may need to either drop one of the variables, or</li>
<li>Combine them into a single variable. (index)</li>
</ul>
<p>How to know how strong is the multicollinearity problem ??</p>
<ul>
<li>Estimate <span class="math inline">\(R^2\)</span> of the regression of <span class="math inline">\(x_i\)</span> on all other <span class="math inline">\(x\)</span> variables. For all cases!
<ul>
<li>or use the <code>estat vif</code> command in Stata. (only with OLS)</li>
</ul></li>
</ul>
</section>
<section id="mr-collinearity-1" class="slide level2">
<h2>MR: Collinearity</h2>
<div id="5cccba22" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb2-1"><a></a><span class="kw">qui</span>:frause oaxaca, <span class="kw">clear</span></span>
<span id="cb2-2"><a></a><span class="kw">qui</span>:<span class="kw">regress</span> lnwage female educ exper tenure c.age c.age#c.age, <span class="kw">robust</span></span>
<span id="cb2-3"><a></a><span class="kw">estat</span> <span class="kw">vif</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>div.jp-Notebook .datagrid-container {min-height: 448px; }</style>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Variable |       VIF       1/VIF  
-------------+----------------------
      female |      1.11    0.900413
        educ |      1.15    0.873284
       exper |      2.48    0.403924
      tenure |      1.82    0.549891
         age |     54.62    0.018310
 c.age#c.age |     53.08    0.018839
-------------+----------------------
    Mean VIF |     19.04</code></pre>
</div>
</div>
</section>
<section id="mr-testing-single-hypotheses" class="slide level2">
<h2>MR: Testing Single hypotheses</h2>
<ul>
<li>Same as before, but now we have more than one <span class="math inline">\(x\)</span> variable to test.
<ul>
<li><span class="math inline">\(H_0: \beta_1 = 0\)</span></li>
</ul></li>
<li>You may want to be careful with multiple testing.
<ul>
<li>testing each coefficient separately with the same <span class="math inline">\(\alpha\)</span> level</li>
</ul></li>
<li>There is also testing single hypotheses on combinations of coefficients.
<ul>
<li>$H_0: _1-2*_2=0 $</li>
</ul></li>
<li>As before, you just need to know the point estimate and the standard error to calculate the t-statistic.</li>
</ul>
</section>
<section id="mr-testing-joint-hypotheses" class="slide level2">
<h2>MR: Testing Joint hypotheses</h2>
<ul>
<li>Testing joint hypotheses: null hypotheses that contain statements about more than one regression coefficient: <span class="math inline">\(H_0: \beta_1 = \beta_2 = 0\)</span> vs <span class="math inline">\(H_1: H_0\)</span> is false</li>
<li>This kind of test is used to evaluate a subset of the coefficients (such as all geographical variables) are all zero.</li>
<li>But for doing this you need a new test statistic: the <strong>F-test</strong>.</li>
</ul>
<p>Difference with the t-test:</p>
<ul>
<li>In contrast with the t-test, the F-test follows an F-distribution.</li>
<li>This distribution is not symmetric! And you need to know the degrees of freedom.
<ul>
<li>How many restrictions are you imposing? and how many coefficients did you estimate?</li>
</ul></li>
<li>Also, all test are on-sided</li>
</ul>
</section>
<section id="mr-testing-joint-hypotheses-1" class="slide level2">
<h2>MR: Testing Joint hypotheses</h2>

<img data-src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/F-test_plot.svg/1280px-F-test_plot.svg.png" class="r-stretch quarto-figure-center"><p class="caption">F-test</p></section>
<section id="mr-testing-hypotheses-in-stata" class="slide level2">
<h2>MR: Testing hypotheses in Stata</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Regression</a></li><li><a href="#tabset-1-2">Joint test</a></li><li><a href="#tabset-1-3">Single test Combined</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div id="634c6358" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb4-1"><a></a><span class="kw">qui</span>:<span class="kw">webuse</span> dui, <span class="kw">clear</span></span>
<span id="cb4-2"><a></a><span class="kw">regress</span>  citations  fines i.taxes i.csize i.college, <span class="kw">robust</span> nohead</span>
<span id="cb4-3"><a></a>** <span class="kw">regress</span>, coefleg to know <span class="st">"names"</span> <span class="kw">of</span> variables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>------------------------------------------------------------------------------
             |               Robust
   citations | Coefficient  std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       fines |  -7.690437   .3843873   -20.01   0.000    -8.445672   -6.935201
             |
       taxes |
        Tax  |  -4.493918   .5819239    -7.72   0.000    -5.637269   -3.350566
             |
       csize |
     Medium  |   5.492308    .531599    10.33   0.000     4.447834    6.536782
      Large  |   11.23563   .5709191    19.68   0.000      10.1139    12.35736
             |
     college |
    College  |   5.828441    .588277     9.91   0.000     4.672607    6.984274
       _cons |   94.21955   3.948926    23.86   0.000     86.46079    101.9783
------------------------------------------------------------------------------</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2">
<div id="0f8f6e06" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb6-1"><a></a><span class="kw">test</span> 1.taxes 1.college <span class="co">// &lt;- automatically test the joint hypothesis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ( 1)  1.taxes = 0
 ( 2)  1.college = 0

       F(  2,   494) =   66.74
            Prob &gt; F =    0.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3">
<div id="29c11dfa" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb8-1"><a></a>** <span class="st">"H0: 2*B_Taxes = B_fines"</span></span>
<span id="cb8-2"><a></a><span class="kw">lincom</span> 2*1.taxes-fines</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ( 1)  - fines + 2*1.taxes = 0

------------------------------------------------------------------------------
   citations | Coefficient  Std. err.      t    P&gt;|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
         (1) |  -1.297398   1.098122    -1.18   0.238    -3.454964    .8601678
------------------------------------------------------------------------------</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="mr-non-linear-patterns" class="slide level2">
<h2>MR: Non-linear patterns</h2>
<ul>
<li>Surprise! you can use the same tools as with single regression
<ul>
<li>Uses splines, polynomials, other non-linear functions of <span class="math inline">\(x\)</span> variables.</li>
</ul></li>
<li>Non-linear function of various <span class="math inline">\(x_i\)</span> variables may be combined.</li>
<li>As show before, using non-linear functions will increase multicollinearity, but worry not about that type of collinearity.</li>
<li>Be more careful with the interpretation of the coefficients.</li>
</ul>
</section>
<section id="cs-understanding-the-gender-difference-in-earnings" class="slide level2">
<h2>CS: Understanding the gender difference in earnings</h2>
<ul>
<li>In the USA (2014), women tend to earn about 20% less than men</li>
<li>Aim 1: Find patterns to better understand the gender gap. Our focus is the interaction with age.</li>
<li>Aim 2: Think about if there is a causal link from being female to getting paid less.</li>
</ul>
</section>
<section id="cs-the-data" class="slide level2">
<h2>CS: The data</h2>
<ul>
<li>2014 census data</li>
<li>Age between 15 to 65</li>
<li>Exclude self-employed <em>(earnings is difficult to measure)</em></li>
<li>Include those who reported 20 hours more as their usual weekly time worked</li>
<li>Employees with a graduate degree (higher than 4-year college)</li>
<li>Use log hourly earnings (<span class="math inline">\(\ln w\)</span>) as dependent variable</li>
<li>Use gender and add age as explanatory variables</li>
</ul>
</section>
<section id="cs-the-model" class="slide level2">
<h2>CS: The model</h2>
<p>We are quite familiar with the relation between earnings and gender: <span class="math display">\[\ln w_E = \alpha + \beta\text{female}, \beta &lt; 0\]</span> Let’s include age as well: <span class="math display">\[\ln w_E = \beta_0 + \beta_1\text{female} + \beta_2\text{age}\]</span></p>
<p>What happens if we do not include age?</p>
</section>
<section id="cs-the-regression" class="slide level2">
<h2>CS: The Regression</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th><strong>Variables</strong></th>
<th>ln wage</th>
<th>ln wage</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>female</strong></td>
<td>-0.195**</td>
<td>-0.185**</td>
<td>-1.484**</td>
</tr>
<tr class="even">
<td></td>
<td>(0.008)</td>
<td>(0.008)</td>
<td>(0.159)</td>
</tr>
<tr class="odd">
<td><strong>age</strong></td>
<td></td>
<td>0.007**</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>(0.000)</td>
<td></td>
</tr>
<tr class="odd">
<td>Constant</td>
<td>3.514**</td>
<td>3.198**</td>
<td>44.630**</td>
</tr>
<tr class="even">
<td></td>
<td>(0.006)</td>
<td>(0.018)</td>
<td>(0.116)</td>
</tr>
<tr class="odd">
<td>Observations</td>
<td>18,241</td>
<td>18,241</td>
<td>18,241</td>
</tr>
<tr class="even">
<td>R-squared</td>
<td>0.028</td>
<td>0.046</td>
<td>0.005</td>
</tr>
</tbody>
</table>
<div class="small-text" style="text-align: center">
<p>Note: Robust standard errors in parentheses<br>
*** p&lt;0.01, ** p&lt;0.05, * p&lt;0.1<br>
Source: cps-earnings dataset. 2014 CPS Morg.</p>
</div>
<p>What if Age is not linear? (has a non-linear effect on earnings)</p>
</section>
<section id="cs-adjustment-and-robustness" class="slide level2">
<h2>CS: Adjustment and Robustness</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th><strong>Variable</strong></th>
<th>Model 1</th>
<th>Model 2</th>
<th>Model 3</th>
<th>Model 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>female</strong></td>
<td>-0.195**</td>
<td>-0.185**</td>
<td>-0.183**</td>
<td>-0.183**</td>
</tr>
<tr class="even">
<td></td>
<td>(0.008)</td>
<td>(0.008)</td>
<td>(0.008)</td>
<td>(0.008)</td>
</tr>
<tr class="odd">
<td><strong>age</strong></td>
<td></td>
<td>0.007**</td>
<td>0.063**</td>
<td>0.572**</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>(0.000)</td>
<td>(0.003)</td>
<td>(0.116)</td>
</tr>
<tr class="odd">
<td><strong>age2</strong></td>
<td></td>
<td></td>
<td>-0.001**</td>
<td>-0.017**</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td>(0.000)</td>
<td>(0.004)</td>
</tr>
<tr class="odd">
<td><strong>age3</strong></td>
<td></td>
<td></td>
<td></td>
<td>0.000**</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td>(0.000)</td>
</tr>
<tr class="odd">
<td><strong>Observations</strong></td>
<td>18,241</td>
<td>18,241</td>
<td>18,241</td>
<td>18,241</td>
</tr>
<tr class="even">
<td><strong>R-squared</strong></td>
<td>0.028</td>
<td>0.046</td>
<td>0.060</td>
<td>0.062</td>
</tr>
</tbody>
</table>
<div class="small-text" style="text-align: center">
<p>Note: Robust standard errors in parentheses, *** p&lt;0.01, ** p&lt;0.05, * p&lt;0.1<br>
Source: cps-earnings dataset. 2014 CPS Morg.</p>
</div>
</section></section>
<section>
<section id="qualitative-variables-and-interactions" class="title-slide slide level1 center">
<h1>Qualitative variables <br> and interactions</h1>
<p>Traditional way to make things more interesting</p>
</section>
<section id="mr-qualitative-variables" class="slide level2">
<h2>MR: Qualitative variables</h2>
<ul>
<li>MR can also handle using qualitative variables as explanatory variables.</li>
<li>Two ways to include qualitative variables:
<ul>
<li>Create a dummy for each category.</li>
<li>Let the software create the binary variables for you.</li>
</ul></li>
<li>You can only include <span class="math inline">\(k-1\)</span> dummies (dummy variable trap)
<ul>
<li>Left out category is the reference category (Base).</li>
</ul></li>
<li><code>Stata Corner</code>
<ul>
<li><code>i.</code> in front of a variable tells Stata to treat it as a categorical variable. (makes dummies on the background): <code>reg lnwage i.educ</code></li>
<li>But, the categorical variable cannot be negative.</li>
</ul></li>
</ul>
</section>
<section id="mr-qualitative-variables-1" class="slide level2">
<h2>MR: Qualitative variables</h2>
<p>Say <span class="math inline">\(X\)</span> is a qualitative variable with <span class="math inline">\(3\)</span> categories: low, medium, and high. <span class="math display">\[y^E = \beta_0 + \beta_1 D^{med} + \beta_2 D^{high}\]</span></p>
<ul>
<li><strong>low</strong> is the reference category. Other values compared to this.</li>
<li><span class="math inline">\(\beta_0\)</span> shows average <span class="math inline">\(y\)</span> in the reference category. (medium and high <span class="math inline">\(=0\)</span>)</li>
<li><span class="math inline">\(\beta_1\)</span>: Average difference between <span class="math inline">\(D_{medium}\)</span> and <span class="math inline">\(D_low\)</span></li>
<li><span class="math inline">\(\beta_2\)</span>: Average difference between <span class="math inline">\(D_{high}\)</span> and <span class="math inline">\(D_low\)</span></li>
</ul>
</section>
<section id="mr-how-to-pick-a-reference-category" class="slide level2">
<h2>MR: How to pick a reference category?</h2>
<ul>
<li>Choose the category to which we want to compare the rest.
<ul>
<li>Home country, the capital city, the lowest or highest value group.</li>
</ul></li>
<li>Or, chose a category with a large number of observations.
<ul>
<li>Important when inference is important, and SE are needed.</li>
</ul></li>
<li>For prediction, it does not matter.</li>
</ul>
</section>
<section id="cs-gender-difference-in-earnings-and-education" class="slide level2">
<h2>CS: Gender difference in earnings and education</h2>
<table class="caption-top">
<colgroup>
<col style="width: 40%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Variables</th>
<th style="text-align: center;">ln wage</th>
<th style="text-align: center;">ln wage</th>
<th style="text-align: center;">ln wage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>female</td>
<td style="text-align: center;">-0.195**</td>
<td style="text-align: center;">-0.182**</td>
<td style="text-align: center;">-0.182**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;">(0.008)</td>
<td style="text-align: center;">(0.009)</td>
<td style="text-align: center;">(0.009)</td>
</tr>
<tr class="odd">
<td>ed_Profess</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0.134**</td>
<td style="text-align: center;">-0.002</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">(0.015)</td>
<td style="text-align: center;">(0.018)</td>
</tr>
<tr class="odd">
<td>ed_PhD</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0.136**</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">(0.013)</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>ed_MA</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-0.136**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">(0.013)</td>
</tr>
<tr class="odd">
<td>Constant</td>
<td style="text-align: center;">3.514**</td>
<td style="text-align: center;">3.473**</td>
<td style="text-align: center;">3.609**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;">(0.006)</td>
<td style="text-align: center;">(0.007)</td>
<td style="text-align: center;">(0.013)</td>
</tr>
<tr class="odd">
<td>Observations</td>
<td style="text-align: center;">18,241</td>
<td style="text-align: center;">18,241</td>
<td style="text-align: center;">18,241</td>
</tr>
<tr class="even">
<td>R-squared</td>
<td style="text-align: center;">0.028</td>
<td style="text-align: center;">0.038</td>
<td style="text-align: center;">0.038</td>
</tr>
</tbody>
</table>
</section>
<section id="mr-interactions" class="slide level2">
<h2>MR: Interactions</h2>
<ul>
<li>Often data is made up of important groups: male and female workers or countries in different continents.</li>
<li>and, <strong>Some</strong> of the patterns we are after may vary across these groups.</li>
<li>The strength of a relation may also be altered by a special variable.
<ul>
<li>In medicine, a moderator variable can reduce or amplify the effect of a drug on people.</li>
<li>In business, financial strength can affect how firms may weather a recession.</li>
</ul></li>
<li><strong>Message:</strong> different patterns for subsets of observations.</li>
</ul>
</section>
<section id="mr-interactions-and-parallel-lines" class="slide level2">
<h2>MR: Interactions and parallel lines</h2>
<ul>
<li><strong>Option 1</strong>: Simply the Dummy to the model
<ul>
<li><span class="math inline">\(y^E = \beta_0 + \beta_1 x_1 + \beta_2 D\)</span></li>
</ul></li>
<li>This assumes <span class="math inline">\(\beta_1\)</span> is the same for both groups, only the intercepts are different.</li>
<li><strong>Option 2</strong>: Different slopes
<ul>
<li><span class="math inline">\(y^E = \beta_0 + \beta_1 x_1 + \beta_2 D + \beta_3 x_1 \times D\)</span><br>
</li>
</ul></li>
<li>This now assumes slopes are different for both groups.</li>
<li><strong>Option 3</strong>: Separate regressions
<ul>
<li>But Option 2 is better for testing if slopes are different.</li>
</ul></li>
</ul>
</section>
<section id="mr-interaction-with-two-continuous-variable" class="slide level2">
<h2>MR: Interaction with two continuous variable</h2>
<ul>
<li><p>Interactions can also be used with continuous variables, <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>: <span class="math display">\[y_E = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_1 x_2\]</span></p></li>
<li><p>Example:</p>
<ul>
<li><span class="math inline">\(y\)</span> is change in revenue <span class="math inline">\(x_1\)</span> is change in global demand, <span class="math inline">\(x_2\)</span> is firm’s financial health</li>
<li>The interaction can capture that drop in demand can cause financial problems in firms, but less so for firms with better balance sheet.</li>
</ul></li>
<li><p>Perhaps biggest challenge is to interpret a model with interactions.</p></li>
</ul>
</section>
<section id="mr-interaction-with-two-continuous-variable-1" class="slide level2">
<h2>MR: Interaction with two continuous variable</h2>
<ul>
<li>The interaction term <span class="math inline">\(x_1 x_2\)</span> captures how this two variables affect each others effect on <span class="math inline">\(y\)</span>.
<ul>
<li>Typically we assume this is zero.</li>
</ul></li>
<li>The coefficient <span class="math inline">\(\beta_3\)</span> captures the magnitude of the interaction effect.</li>
<li>However, if you are interested in the relationship betwee <span class="math inline">\(x_1\)</span> or <span class="math inline">\(x_2\)</span> with <span class="math inline">\(y\)</span>, you need extra care.
<ul>
<li><span class="math inline">\(x_1\)</span> on <span class="math inline">\(y\)</span> is <span class="math inline">\(\frac{dy}{dx_1}=\beta_1 + \beta_3 x_2\)</span>.</li>
<li><span class="math inline">\(x_2\)</span> on <span class="math inline">\(y\)</span> is <span class="math inline">\(\frac{dy}{dx_2}=\beta_2 + \beta_3 x_1\)</span>.<br>
</li>
<li>So you need to “fix” <span class="math inline">\(x_2\)</span> to see the effect of <span class="math inline">\(x_1\)</span> on <span class="math inline">\(y\)</span>. (typically at the mean)</li>
</ul></li>
</ul>
</section>
<section id="cs-interaction-between-gender-and-age" class="slide level2">
<h2>CS: Interaction between gender and age</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>Separate, Earning for men rises faster with age</li>
<li>With interaction, Same result!.</li>
<li>Female dummy is close to zero. Does this mean no gender gap?
<ul>
<li>No, Cumulative effect: <span class="math inline">\(-0.036-0.003*age\)</span></li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<table class="caption-top">
<thead>
<tr class="header">
<th>Variables</th>
<th style="text-align: center;">ln wage (Women)</th>
<th style="text-align: center;">ln wage (Men)</th>
<th style="text-align: center;">ln wage (All)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>female</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-0.036</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">(0.035)</td>
</tr>
<tr class="odd">
<td><strong>age</strong></td>
<td style="text-align: center;">0.006**</td>
<td style="text-align: center;">0.009**</td>
<td style="text-align: center;">0.009**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;">(0.001)</td>
<td style="text-align: center;">(0.001)</td>
<td style="text-align: center;">(0.001)</td>
</tr>
<tr class="odd">
<td><strong>female × age</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-0.003**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">(0.001)</td>
</tr>
<tr class="odd">
<td><strong>Constant</strong></td>
<td style="text-align: center;">3.081**</td>
<td style="text-align: center;">3.117**</td>
<td style="text-align: center;">3.117**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;">(0.023)</td>
<td style="text-align: center;">(0.026)</td>
<td style="text-align: center;">(0.026)</td>
</tr>
<tr class="odd">
<td><strong>Observations</strong></td>
<td style="text-align: center;">9,685</td>
<td style="text-align: center;">8,556</td>
<td style="text-align: center;">18,241</td>
</tr>
<tr class="even">
<td><strong>R-squared</strong></td>
<td style="text-align: center;">0.011</td>
<td style="text-align: center;">0.028</td>
<td style="text-align: center;">0.047</td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="mr-stata-corner" class="slide level2">
<h2>MR: Stata corner</h2>
<ul>
<li>In <code>Stata</code> you can use <code>i.</code> to create dummies for all categories of a variable.</li>
<li>You can also use <code>#</code> to create interactions between variables.
<ul>
<li>Unless specified, Stata assume variables are categorical. You can use <code>c.</code> for continuous variables.</li>
</ul></li>
<li>You can also use <code>##</code> to create interactions plus the main effects.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb10-1"><a></a><span class="kw">regress</span> <span class="fu">y</span> i.x1##c.<span class="kw">x2</span></span>
<span id="cb10-2"><a></a>is equivalent to</span>
<span id="cb10-3"><a></a><span class="kw">regress</span> <span class="fu">y</span> i.x1 c.<span class="kw">x2</span> i.x1#c.<span class="kw">x2</span></span>
<span id="cb10-4"><a></a>where i.x1 will create <span class="ot">all</span> dummies <span class="kw">for</span> x1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>If dummies and interactions are created this way you can use <code>margins</code> to calculate effects of main variables.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb11-1"><a></a>margins, <span class="kw">dydx</span>(x1 <span class="kw">x2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section></section>
<section>
<section id="conditioning-and-causality" class="title-slide slide level1 center">
<h1>Conditioning and causality</h1>

</section>
<section id="mr-causal-analysis" class="slide level2">
<h2>MR: Causal analysis</h2>
<ul>
<li>One main reason to estimate multiple regressions is to get closer to a causal interpretation.</li>
<li>By conditioning on other observable variables, we can get closer to comparing similar objects – “apples to apples” – even in observational data.</li>
<li><strong>But</strong> getting closer is not the same as getting there.</li>
<li>In principle, one could try conditioning on every potential confounder: variables that would affect <span class="math inline">\(y\)</span> and the causal variable <span class="math inline">\(x_1\)</span> at the same time.</li>
<li>Ceteris paribus = conditioning on every such relevant variable. (everything else constant).</li>
</ul>
</section>
<section id="mr-causal-analysis-1" class="slide level2">
<h2>MR: Causal analysis</h2>
<ul>
<li>In randomized experiments, we can use causal language: treated and untreated units similar - by random grouping.</li>
<li>In observational data, comparisons don’t uncover causal relations.
<ul>
<li>Cautious with language. Avoid use of “effect”, “increase”. But could use “associated with”, “linked to”.</li>
<li>Regression, even with multiple <span class="math inline">\(x\)</span> is just comparison. Conditional mean.</li>
</ul></li>
</ul>
</section>
<section id="mr-causal-analysis-dont-overdo-it" class="slide level2">
<h2>MR: Causal analysis Don’t overdo it</h2>
<ul>
<li>Not all variables should be included as control variables even if correlated both with the causal variable and the dependent variable.</li>
<li><strong>Bad conditioning</strong> variables are variables that are correlated both with the causal variable and the dependent variable but are actually part of the causal mechanism.
<ul>
<li>This is the reason to exclude them.</li>
</ul></li>
<li>Example, should you control for visit to the doctor when estimating the effect of health spending on health?
<ul>
<li>No, because visiting the doctor is part of the causal mechanism.</li>
</ul></li>
</ul>
</section>
<section id="mr-causal-analysis-2" class="slide level2">
<h2>MR: Causal analysis</h2>
<ul>
<li>A multiple regression on observational data is rarely capable of uncovering a causal relationship.
<ul>
<li>Cannot capture all potential confounder. (Not ceteris paribus)</li>
<li>Potential Bad conditioning variables (bad controls)</li>
<li>We can never really know.</li>
</ul></li>
<li>Multiple regression can get us <strong>closer</strong> to uncovering a causal relationship
<ul>
<li>Compare units that are the same in many respects - controls</li>
</ul></li>
</ul>
</section>
<section id="cs-understanding-the-gender-difference-in-earnings-1" class="slide level2">
<h2>CS: Understanding the gender difference in earnings</h2>
<table class="caption-top">
<colgroup>
<col style="width: 24%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Variables</th>
<th style="text-align: center;">ln wage (Model 1)</th>
<th style="text-align: center;">ln wage (Model 2)</th>
<th style="text-align: center;">ln wage (Model 3)</th>
<th style="text-align: center;">ln wage (Model 4)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>female</strong></td>
<td style="text-align: center;">-0.224**</td>
<td style="text-align: center;">-0.212**</td>
<td style="text-align: center;">-0.151**</td>
<td style="text-align: center;">-0.141**</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: center;">(0.012)</td>
<td style="text-align: center;">(0.012)</td>
<td style="text-align: center;">(0.012)</td>
<td style="text-align: center;">(0.012)</td>
</tr>
<tr class="odd">
<td><strong>Age and education</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="even">
<td><strong>Family circumstances</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="odd">
<td><strong>Demographic background</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="even">
<td><strong>Job characteristics</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="odd">
<td><strong>Union member</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="even">
<td><strong>Age in polynomial</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="odd">
<td><strong>Hours in polynomial</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">YES</td>
</tr>
<tr class="even">
<td><strong>Observations</strong></td>
<td style="text-align: center;">9,816</td>
<td style="text-align: center;">9,816</td>
<td style="text-align: center;">9,816</td>
<td style="text-align: center;">9,816</td>
</tr>
<tr class="odd">
<td><strong>R-squared</strong></td>
<td style="text-align: center;">0.036</td>
<td style="text-align: center;">0.043</td>
<td style="text-align: center;">0.182</td>
<td style="text-align: center;">0.195</td>
</tr>
</tbody>
</table>
<p>More and more confounders added</p>
</section>
<section id="regression-table-detour" class="slide level2">
<h2>Regression table detour</h2>
<ul>
<li>Regression table with many <span class="math inline">\(x\)</span> vars is hard to present</li>
<li>In presentation, <strong>suppress</strong> unimportant coefficients</li>
<li>In paper, you may present more, but mostly if you want to discuss them or for <em>sanity check</em></li>
<li><strong>Sanity check</strong>: do control variable coefficient make sense by and large?</li>
<li>Check <span class="math inline">\(N\)</span> of observations: if the same sample, should be exactly the same.</li>
<li><span class="math inline">\(R^2\)</span> is enough, no need for other stuff (unless other methods are used)</li>
</ul>
</section></section>
<section>
<section id="prediction" class="title-slide slide level1 center">
<h1>Prediction</h1>

</section>
<section id="mr-prediction-and-benchmarking" class="slide level2">
<h2>MR: Prediction and benchmarking</h2>
<ul>
<li>Second reason to estimate a multiple regression is to make a prediction
<ul>
<li>find the best guess for the dependent variable <span class="math inline">\(y_j\)</span> for a particular observation <span class="math inline">\(j\)</span> <span class="math display">\[\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x_1 + \hat{\beta}_2 x_2 + \cdots\]</span></li>
</ul></li>
<li>A <span class="math inline">\(\hat{y} \ vs \ y\)</span> Scatter plot is a good way to visualize the fit of a prediction.
<ul>
<li>As well as identifying over or underpredictions.</li>
</ul></li>
<li>We want the regression to produce as <em>good</em> a fit as possible.
<ul>
<li><strong>A common danger</strong>: Overfitting the data: finding patterns in the data that are not true in the population</li>
</ul></li>
<li>We will discuss more about prediction in the next chapters.</li>
</ul>
</section>
<section id="mr-variable-selection" class="slide level2">
<h2>MR: Variable selection</h2>
<ul>
<li>How should one decide which variables to include? and how?</li>
<li>Depends on the purpose: prediction or causality.</li>
</ul>
<p>General Advice:</p>
<ul>
<li>Lot of judgment calls: theory, data, and context.</li>
<li>Non-linear fit, use a non-parametric first and if non-linear, pick a model that is close - quadratic, piecewise spline.</li>
<li>If two or many variables strongly correlated, pick one of them.</li>
<li>Keep it as simple as possible: Parsimony is a virtue.</li>
</ul>
</section>
<section id="mr-variable-selection-for-causal-questions" class="slide level2">
<h2>MR: Variable selection for causal questions</h2>
<ul>
<li>Causal question: <span class="math inline">\(x\)</span> impact on <span class="math inline">\(y\)</span>. Having <span class="math inline">\(z\)</span> variables to condition on, to get closer to causality.</li>
<li>Our aim is to focus on the coefficient on one variable. What matters are the estimated value of the coefficient and its confidence interval. Not prediction.</li>
<li>Keep <span class="math inline">\(z\)</span> – keep variables that help comparing units</li>
<li>Drop <span class="math inline">\(z\)</span> if they not matter, or if they are part of the causal mechanism. (affected by <span class="math inline">\(x\)</span>)
<ul>
<li>Functional form for <span class="math inline">\(z\)</span> matters only for crucial confounders. (linear is fine)</li>
</ul></li>
<li>Present the model you judge is best, and then report a few other solutions – robustness.</li>
</ul>
</section>
<section id="mr-variable-selection-process" class="slide level2">
<h2>MR: Variable selection – process</h2>
<ul>
<li>Select control variables you want to include</li>
<li>Select functional form one by one</li>
<li>Focus on <strong>key</strong> variables by domain knowledge (theory), add the rest linearly</li>
<li>Key issue is sample size
<ul>
<li>For 20-40 obs, about 1-2 variables.</li>
<li>For 50-100 obs, about 2-4 variables</li>
<li>Few hundred obs, 5-10 variables could work</li>
<li>Few thousand obs, few dozen variables, including industry/country/profession etc dummmmies, interactions.</li>
<li>10-100K obs - many variables, polynomials, interactions</li>
</ul></li>
</ul>
</section>
<section id="mr-variable-selection-for-prediction" class="slide level2">
<h2>MR: Variable selection for prediction</h2>
<ul>
<li>If Prediction is the goal, keep whatever works</li>
<li>Balance is needed to ensure it works beyond the data at hand</li>
<li><strong>Overfitting</strong>: building a model that captures some patterns that may fit the data in hand, but does not generalize well.</li>
<li>Focus on functional form, interactions</li>
<li>Value simplicity. Easier to explain, more robust.</li>
<li>Formal way:
<ul>
<li>BIC and AIC. Similar to R-squared but takes into account number of variables. The smaller, the better</li>
</ul></li>
<li>You may use Adj R2, (although not perfect) to compare models.</li>
</ul>
</section>
<section id="summary-take-away" class="slide level2">
<h2>Summary take-away</h2>
<ul>
<li>Multiple regression are linear models with several <span class="math inline">\(x\)</span> variables.</li>
<li>May include binary variables and interactions</li>
<li>Multiple regression can take us closer to a causal interpretation and help make better predictions.</li>
</ul>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p><em>Rios-Avila and Cia</em></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1300,

        height: 675,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>